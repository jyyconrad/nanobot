{
  "project": "nanobot",
  "current_version": "0.4.0",
  "target_version": "0.4.0",
  "upgrade_session": {
    "start_time": "2026-02-12T23:30:00+08:00",
    "completedDate": "2026-02-14T07:10:00+08:00",
    "status": "completed"
  },
  "stages": {
    "0": {
      "name": "准备阶段",
      "status": "completed",
      "checkpoints": {
        "0.1": {
          "name": "环境准备",
          "status": "completed"
        },
        "0.2": {
          "name": "项目结构创建",
          "status": "completed"
        },
        "0.3": {
          "name": "基础代码初始化",
          "status": "completed"
        }
      },
      "progress": 100,
      "errors": []
    },
    "1": {
      "name": "多渠道集成",
      "status": "completed",
      "completedDate": "2026-02-13T09:30:00+08:00",
      "checkpoints": {
        "1.1": {
          "name": "渠道管理器实现",
          "status": "completed",
          "tasks": [
            {
              "name": "验证 ChannelManager 功能完整性",
              "status": "completed"
            },
            {
              "name": "测试渠道注册和管理",
              "status": "completed"
            },
            {
              "name": "验证消息路由功能",
              "status": "completed"
            }
          ]
        },
        "1.2": {
          "name": "消息路由策略实现",
          "status": "completed",
          "tasks": [
            {
              "name": "完善 RouteStrategy 基类",
              "status": "completed"
            },
            {
              "name": "实现 FeishuRouteStrategy 测试",
              "status": "completed"
            },
            {
              "name": "实现 WebChatRouteStrategy 测试",
              "status": "completed"
            },
            {
              "name": "添加 TUIRouteStrategy",
              "status": "completed"
            }
          ]
        },
        "1.3": {
          "name": "飞书渠道集成",
          "status": "completed",
          "tasks": [
            {
              "name": "验证 WebSocket 长连接功能",
              "status": "completed"
            },
            {
              "name": "测试消息接收和处理",
              "status": "completed"
            },
            {
              "name": "测试消息发送功能",
              "status": "completed"
            },
            {
              "name": "验证去重机制",
              "status": "completed"
            }
          ]
        },
        "1.4": {
          "name": "WebChat 渠道实现",
          "status": "completed",
          "tasks": [
            {
              "name": "完善 WebSocket 连接管理",
              "status": "completed"
            },
            {
              "name": "实现消息格式转换",
              "status": "completed"
            },
            {
              "name": "添加用户认证机制",
              "status": "completed"
            },
            {
              "name": "编写单元测试",
              "status": "completed"
            }
          ]
        },
        "1.5": {
          "name": "TUI 渠道实现",
          "status": "completed",
          "tasks": [
            {
              "name": "完善 rich 终端显示",
              "status": "completed"
            },
            {
              "name": "实现交互式命令输入",
              "status": "completed"
            },
            {
              "name": "添加命令处理",
              "status": "completed"
            },
            {
              "name": "编写单元测试",
              "status": "completed"
            }
          ]
        }
      },
      "progress": 100,
      "errors": []
    },
    "2": {
      "name": "架构优化",
      "status": "completed",
      "completedDate": "2026-02-13T12:00:00+08:00",
      "checkpoints": {
        "2.1": {
          "name": "子代理管理机制",
          "status": "completed",
          "tasks": [
            {
              "name": "验证 SubagentManager 类完整性",
              "status": "completed"
            },
            {
              "name": "测试并发控制（Semaphore）",
              "status": "completed"
            },
            {
              "name": "验证任务队列管理",
              "status": "completed"
            },
            {
              "name": "实现资源限制和回收",
              "status": "completed"
            },
            {
              "name": "添加子代理生命周期管理",
              "status": "completed"
            },
            {
              "name": "编写单元测试",
              "status": "completed"
            }
          ]
        },
        "2.2": {
          "name": "并发处理优化",
          "status": "completed",
          "tasks": [
            {
              "name": "实现异步任务调度器",
              "status": "completed"
            },
            {
              "name": "创建资源池管理",
              "status": "completed"
            },
            {
              "name": "实现负载均衡算法",
              "status": "completed"
            },
            {
              "name": "添加性能监控指标",
              "status": "completed"
            },
            {
              "name": "优化任务优先级管理",
              "status": "completed"
            },
            {
              "name": "编写单元测试",
              "status": "completed"
            }
          ]
        },
        "2.3": {
          "name": "错误恢复机制",
          "status": "completed",
          "tasks": [
            {
              "name": "实现超时错误处理器",
              "status": "completed"
            },
            {
              "name": "添加资源耗尽处理",
              "status": "completed"
            },
            {
              "name": "实现 API 错误重试",
              "status": "completed"
            },
            {
              "name": "添加断路器模式",
              "status": "completed"
            },
            {
              "name": "实现错误日志聚合",
              "status": "completed"
            },
            {
              "name": "编写单元测试",
              "status": "completed"
            }
          ]
        },
        "2.4": {
          "name": "服务间通信优化",
          "status": "completed",
          "tasks": [
            {
              "name": "优化消息总线性能",
              "status": "completed"
            },
            {
              "name": "实现事件驱动机制",
              "status": "completed"
            },
            {
              "name": "优化服务间调用",
              "status": "completed"
            },
            {
              "name": "添加通信监控",
              "status": "completed"
            },
            {
              "name": "实现消息压缩",
              "status": "completed"
            },
            {
              "name": "编写单元测试",
              "status": "completed"
            }
          ]
        }
      },
      "progress": 100,
      "errors": []
    },
    "3": {
      "name": "用户体验改进",
      "status": "completed",
      "startedDate": "2026-02-13T12:05:00+08:00",
      "completedDate": "2026-02-14T03:30:00+08:00",
      "checkpoints": {
        "3.1": {
          "name": "交互流程优化",
          "status": "completed",
          "tasks": [
            {
              "name": "优化命令解析和路由",
              "status": "completed"
            },
            {
              "name": "改进上下文提示",
              "status": "completed"
            },
            {
              "name": "添加命令自动补全",
              "status": "completed"
            },
            {
              "name": "优化多轮对话流程",
              "status": "completed"
            }
          ]
        },
        "3.2": {
          "name": "反馈机制改进",
          "status": "completed",
          "tasks": [
            {
              "name": "实现进度条显示",
              "status": "completed"
            },
            {
              "name": "添加实时状态更新",
              "status": "completed"
            },
            {
              "name": "优化错误提示信息",
              "status": "completed"
            },
            {
              "name": "添加操作确认机制",
              "status": "completed"
            }
          ]
        },
        "3.3": {
          "name": "可视化效果增强",
          "status": "completed",
          "tasks": [
            {
              "name": "改进终端 UI 显示",
              "status": "completed"
            },
            {
              "name": "添加彩色输出",
              "status": "completed"
            },
            {
              "name": "实现表格和图表显示",
              "status": "completed"
            },
            {
              "name": "优化日志输出格式",
              "status": "completed"
            }
          ]
        }
      },
      "progress": 100,
      "errors": []
    },
    "4": {
      "name": "系统稳定性",
      "status": "completed",
      "completedDate": "2026-02-14T04:00:00+08:00",
      "checkpoints": {
        "4.1": {
          "name": "监控和日志记录",
          "status": "completed",
          "tasks": [
            {
              "name": "实现结构化日志",
              "status": "completed"
            },
            {
              "name": "添加性能监控",
              "status": "completed"
            },
            {
              "name": "实现健康检查",
              "status": "completed"
            },
            {
              "name": "添加告警机制",
              "status": "completed"
            }
          ]
        },
        "4.2": {
          "name": "性能优化",
          "status": "completed",
          "tasks": [
            {
              "name": "优化内存使用",
              "status": "completed"
            },
            {
              "name": "减少 I/O 阻塞",
              "status": "completed"
            },
            {
              "name": "实现缓存策略",
              "status": "completed"
            },
            {
              "name": "优化数据库查询",
              "status": "completed"
            }
          ]
        },
        "4.3": {
          "name": "系统可运维性",
          "status": "completed",
          "tasks": [
            {
              "name": "添加配置热重载",
              "status": "completed"
            },
            {
              "name": "实现优雅关闭",
              "status": "completed"
            },
            {
              "name": "添加诊断工具",
              "status": "completed"
            },
            {
              "name": "优化错误恢复",
              "status": "completed"
            }
          ]
        }
      },
      "progress": 100,
      "errors": []
    },
    "6": {
      "name": "收尾工作",
      "status": "completed",
      "completedDate": "2026-02-14T07:10:00+08:00",
      "checkpoints": {
        "6.1": {
          "name": "问题修复",
          "status": "completed",
          "tasks": [
            {
              "name": "修复 Pydantic V2 deprecation warnings",
              "status": "completed"
            },
            {
              "name": "修复代码审查问题",
              "status": "completed"
            },
            {
              "name": "优化性能瓶颈",
              "status": "completed"
            }
          ]
        },
        "6.2": {
          "name": "版本发布准备",
          "status": "completed",
          "tasks": [
            {
              "name": "更新版本号 (0.2.1 → 0.4.0)",
              "status": "completed"
            },
            {
              "name": "编写发布说明 (CHANGELOG.md)",
              "status": "completed"
            },
            {
              "name": "生成变更日志",
              "status": "completed"
            },
            {
              "name": "创建发布标签",
              "status": "completed"
            }
          ]
        }
      },
      "progress": 100,
      "errors": []
    },
    "5": {
      "name": "集成测试",
      "status": "completed",
      "checkpoints": {
        "5.1": {
          "name": "功能测试",
          "status": "completed",
          "tasks": [
            {
              "name": "测试多渠道消息路由",
              "status": "completed"
            },
            {
              "name": "测试子代理管理",
              "status": "completed"
            },
            {
              "name": "测试并发处理",
              "status": "completed"
            },
            {
              "name": "测试错误恢复",
              "status": "completed"
            }
          ]
        },
        "5.2": {
          "name": "性能测试",
          "status": "completed",
          "tasks": [
            {
              "name": "测试高并发消息处理",
              "status": "completed"
            },
            {
              "name": "测试大量子代理并发",
              "status": "completed"
            },
            {
              "name": "测试资源限制",
              "status": "completed"
            },
            {
              "name": "测试长时间运行稳定性",
              "status": "completed"
            }
          ]
        },
        "5.3": {
          "name": "稳定性测试",
          "status": "completed",
          "tasks": [
            {
              "name": "测试异常恢复",
              "status": "completed"
            },
            {
              "name": "测试网络中断恢复",
              "status": "completed"
            },
            {
              "name": "测试内存泄漏",
              "status": "completed"
            },
            {
              "name": "测试死锁检测",
              "status": "completed"
            }
          ]
        },
        "5.4": {
          "name": "代码质量检查",
          "status": "completed",
          "tasks": [
            {
              "name": "运行代码格式检查",
              "status": "completed"
            },
            {
              "name": "运行静态类型检查",
              "status": "completed"
            },
            {
              "name": "运行代码复杂度分析",
              "status": "completed"
            },
            {
              "name": "生成代码质量报告",
              "status": "completed"
            }
          ]
        }
      },
      "progress": 100,
      "errors": [
        {
          "task": "稳定性测试",
          "stdout": "============================= test session starts ==============================\nplatform darwin -- Python 3.13.5, pytest-9.0.2, pluggy-1.6.0 -- /Users/jiangyayun/develop/code/work_code/nanobot/.venv/bin/python3.13\ncachedir: .pytest_cache\nrootdir: /Users/jiangyayun/develop/code/work_code/nanobot\nconfigfile: pyproject.toml\nplugins: anyio-4.12.1, asyncio-1.3.0, cov-7.0.0\nasyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function\ncollecting ... collected 788 items / 788 deselected / 0 selected\n\n=============================== warnings summary ===============================\nnanobot/agent/memory/models.py:13\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/memory/models.py:13: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class Memory(BaseModel):\n\n.venv/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:319\n  /Users/jiangyayun/develop/code/work_code/nanobot/.venv/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:319: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.12/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    warnings.warn(\n\nnanobot/agent/planner/cancellation_detector.py:15\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/cancellation_detector.py:15: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class CancellationDetector(BaseModel):\n\nnanobot/agent/planner/complexity_analyzer.py:15\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/complexity_analyzer.py:15: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class ComplexityAnalyzer(BaseModel):\n\nnanobot/agent/planner/correction_detector.py:15\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/correction_detector.py:15: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class CorrectionDetector(BaseModel):\n\nnanobot/agent/planner/task_detector.py:15\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/task_detector.py:15: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class TaskDetector(BaseModel):\n\nnanobot/agent/planner/task_planner.py:22\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/task_planner.py:22: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class TaskPlanner(BaseModel):\n\nnanobot/agent/subagent/agno_subagent.py:42\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/subagent/agno_subagent.py:42: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class AgnoSubagent(BaseModel):\n\nnanobot/config/schema.py:205\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/config/schema.py:205: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class Config(BaseSettings):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n===================== 788 deselected, 9 warnings in 1.33s ======================\n",
          "stderr": ""
        },
        {
          "task": "代码质量检查",
          "stdout": "=== 代码格式检查 ===\ninvalid-syntax: missing closing quote in string literal\n --> nanobot/agent/_handle_tool_calls_template.py:7:15\n  |\n6 | print(\"async def _handle_tool_calls(self, response: Any, messages: List[Dict[str, Any]]) -> str:\")\n7 | print('    \"\"\"')\n  |               ^^\n8 | print('        处理工具调用的完整循环')\n9 | print('')\n  |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:8:1\n   |\n 6 | print(\"async def _handle_tool_calls(self, response: Any, messages: List[Dict[str, Any]]) -> str:\")\n 7 | print('    \"\"\"')\n 8 | print('        处理工具调用的完整循环')\n   | ^^^^^\n 9 | print('')\n10 | print('        Args:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:9:1\n   |\n 7 | print('    \"\"\"')\n 8 | print('        处理工具调用的完整循环')\n 9 | print('')\n   | ^^^^^\n10 | print('        Args:')\n11 | print('            response: LLM 响应对象')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:10:1\n   |\n 8 | print('        处理工具调用的完整循环')\n 9 | print('')\n10 | print('        Args:')\n   | ^^^^^\n11 | print('            response: LLM 响应对象')\n12 | print('            messages: 当前消息列表')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:11:1\n   |\n 9 | print('')\n10 | print('        Args:')\n11 | print('            response: LLM 响应对象')\n   | ^^^^^\n12 | print('            messages: 当前消息列表')\n13 | print('')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:12:1\n   |\n10 | print('        Args:')\n11 | print('            response: LLM 响应对象')\n12 | print('            messages: 当前消息列表')\n   | ^^^^^\n13 | print('')\n14 | print('        Returns:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:13:1\n   |\n11 | print('            response: LLM 响应对象')\n12 | print('            messages: 当前消息列表')\n13 | print('')\n   | ^^^^^\n14 | print('        Returns:')\n15 | print('            最终响应给用户的文本')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:14:1\n   |\n12 | print('            messages: 当前消息列表')\n13 | print('')\n14 | print('        Returns:')\n   | ^^^^^\n15 | print('            最终响应给用户的文本')\n16 | print('        \"\"\"')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:15:1\n   |\n13 | print('')\n14 | print('        Returns:')\n15 | print('            最终响应给用户的文本')\n   | ^^^^^\n16 | print('        \"\"\"')\n17 | print('        logger.info(f\"MainAgent[{self.session_id}] 处理工具调用：{len(response.tool_calls)} 个\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:16:1\n   |\n14 | print('        Returns:')\n15 | print('            最终响应给用户的文本')\n16 | print('        \"\"\"')\n   | ^^^^^\n17 | print('        logger.info(f\"MainAgent[{self.session_id}] 处理工具调用：{len(response.tool_calls)} 个\")')\n18 | print()\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:17:1\n   |\n15 | print('            最终响应给用户的文本')\n16 | print('        \"\"\"')\n17 | print('        logger.info(f\"MainAgent[{self.session_id}] 处理工具调用：{len(response.tool_calls)} 个\")')\n   | ^^^^^\n18 | print()\n19 | print('        # 执行工具调用循环')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:18:1\n   |\n16 | print('        \"\"\"')\n17 | print('        logger.info(f\"MainAgent[{self.session_id}] 处理工具调用：{len(response.tool_calls)} 个\")')\n18 | print()\n   | ^^^^^\n19 | print('        # 执行工具调用循环')\n20 | print('        max_iterations = 10  # 防止无限循环')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:19:1\n   |\n17 | print('        logger.info(f\"MainAgent[{self.session_id}] 处理工具调用：{len(response.tool_calls)} 个\")')\n18 | print()\n19 | print('        # 执行工具调用循环')\n   | ^^^^^\n20 | print('        max_iterations = 10  # 防止无限循环')\n21 | print('        current_messages = messages.copy()')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:20:1\n   |\n18 | print()\n19 | print('        # 执行工具调用循环')\n20 | print('        max_iterations = 10  # 防止无限循环')\n   | ^^^^^\n21 | print('        current_messages = messages.copy()')\n22 | print('        assistant_message = \"\"')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:21:1\n   |\n19 | print('        # 执行工具调用循环')\n20 | print('        max_iterations = 10  # 防止无限循环')\n21 | print('        current_messages = messages.copy()')\n   | ^^^^^\n22 | print('        assistant_message = \"\"')\n23 | print()\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:22:1\n   |\n20 | print('        max_iterations = 10  # 防止无限循环')\n21 | print('        current_messages = messages.copy()')\n22 | print('        assistant_message = \"\"')\n   | ^^^^^\n23 | print()\n24 | print('        for iteration in range(max_iterations):')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:23:1\n   |\n21 | print('        current_messages = messages.copy()')\n22 | print('        assistant_message = \"\"')\n23 | print()\n   | ^^^^^\n24 | print('        for iteration in range(max_iterations):')\n25 | print('            if not response.has_tool_calls:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:24:1\n   |\n22 | print('        assistant_message = \"\"')\n23 | print()\n24 | print('        for iteration in range(max_iterations):')\n   | ^^^^^\n25 | print('            if not response.has_tool_calls:')\n26 | print('                # 没有工具调用，返回最终响应')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:25:1\n   |\n23 | print()\n24 | print('        for iteration in range(max_iterations):')\n25 | print('            if not response.has_tool_calls:')\n   | ^^^^^\n26 | print('                # 没有工具调用，返回最终响应')\n27 | print('                logger.debug(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：无工具调用\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:26:1\n   |\n24 | print('        for iteration in range(max_iterations):')\n25 | print('            if not response.has_tool_calls:')\n26 | print('                # 没有工具调用，返回最终响应')\n   | ^^^^^\n27 | print('                logger.debug(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：无工具调用\")')\n28 | print('                break')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:27:1\n   |\n25 | print('            if not response.has_tool_calls:')\n26 | print('                # 没有工具调用，返回最终响应')\n27 | print('                logger.debug(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：无工具调用\")')\n   | ^^^^^\n28 | print('                break')\n29 | print('            ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:28:1\n   |\n26 | print('                # 没有工具调用，返回最终响应')\n27 | print('                logger.debug(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：无工具调用\")')\n28 | print('                break')\n   | ^^^^^\n29 | print('            ')\n30 | print('            logger.info(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：执行工具\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:29:1\n   |\n27 | print('                logger.debug(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：无工具调用\")')\n28 | print('                break')\n29 | print('            ')\n   | ^^^^^\n30 | print('            logger.info(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：执行工具\")')\n31 | print('            ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:30:1\n   |\n28 | print('                break')\n29 | print('            ')\n30 | print('            logger.info(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：执行工具\")')\n   | ^^^^^\n31 | print('            ')\n32 | print('            # 处理每个工具调用')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:31:1\n   |\n29 | print('            ')\n30 | print('            logger.info(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：执行工具\")')\n31 | print('            ')\n   | ^^^^^\n32 | print('            # 处理每个工具调用')\n33 | print('            tool_results = []')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:32:1\n   |\n30 | print('            logger.info(f\"MainAgent[{self.session_id}] 第 {iteration+1} 轮迭代：执行工具\")')\n31 | print('            ')\n32 | print('            # 处理每个工具调用')\n   | ^^^^^\n33 | print('            tool_results = []')\n34 | print('            for tool_call in response.tool_calls:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:33:1\n   |\n31 | print('            ')\n32 | print('            # 处理每个工具调用')\n33 | print('            tool_results = []')\n   | ^^^^^\n34 | print('            for tool_call in response.tool_calls:')\n35 | print('                logger.debug(f\"MainAgent[{self.session_id}]   调用工具：{tool_call.name}\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:34:1\n   |\n32 | print('            # 处理每个工具调用')\n33 | print('            tool_results = []')\n34 | print('            for tool_call in response.tool_calls:')\n   | ^^^^^\n35 | print('                logger.debug(f\"MainAgent[{self.session_id}]   调用工具：{tool_call.name}\")')\n36 | print('                ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:35:1\n   |\n33 | print('            tool_results = []')\n34 | print('            for tool_call in response.tool_calls:')\n35 | print('                logger.debug(f\"MainAgent[{self.session_id}]   调用工具：{tool_call.name}\")')\n   | ^^^^^\n36 | print('                ')\n37 | print('                try:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:36:1\n   |\n34 | print('            for tool_call in response.tool_calls:')\n35 | print('                logger.debug(f\"MainAgent[{self.session_id}]   调用工具：{tool_call.name}\")')\n36 | print('                ')\n   | ^^^^^\n37 | print('                try:')\n38 | print('                    # 获取工具实例')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:37:1\n   |\n35 | print('                logger.debug(f\"MainAgent[{self.session_id}]   调用工具：{tool_call.name}\")')\n36 | print('                ')\n37 | print('                try:')\n   | ^^^^^\n38 | print('                    # 获取工具实例')\n39 | print('                    if self.agent_loop and hasattr(self.agent_loop, \"tools\"):')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:38:1\n   |\n36 | print('                ')\n37 | print('                try:')\n38 | print('                    # 获取工具实例')\n   | ^^^^^\n39 | print('                    if self.agent_loop and hasattr(self.agent_loop, \"tools\"):')\n40 | print('                        tool = self.agent_loop.tools.get(tool_call.name)')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:39:1\n   |\n37 | print('                try:')\n38 | print('                    # 获取工具实例')\n39 | print('                    if self.agent_loop and hasattr(self.agent_loop, \"tools\"):')\n   | ^^^^^\n40 | print('                        tool = self.agent_loop.tools.get(tool_call.name)')\n41 | print('                        if tool:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:40:1\n   |\n38 | print('                    # 获取工具实例')\n39 | print('                    if self.agent_loop and hasattr(self.agent_loop, \"tools\"):')\n40 | print('                        tool = self.agent_loop.tools.get(tool_call.name)')\n   | ^^^^^\n41 | print('                        if tool:')\n42 | print('                            logger.info(f\"MainAgent[{self.session_id}]   执行工具：{tool_call.name}\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:41:1\n   |\n39 | print('                    if self.agent_loop and hasattr(self.agent_loop, \"tools\"):')\n40 | print('                        tool = self.agent_loop.tools.get(tool_call.name)')\n41 | print('                        if tool:')\n   | ^^^^^\n42 | print('                            logger.info(f\"MainAgent[{self.session_id}]   执行工具：{tool_call.name}\")')\n43 | print('                            ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:42:1\n   |\n40 | print('                        tool = self.agent_loop.tools.get(tool_call.name)')\n41 | print('                        if tool:')\n42 | print('                            logger.info(f\"MainAgent[{self.session_id}]   执行工具：{tool_call.name}\")')\n   | ^^^^^\n43 | print('                            ')\n44 | print('                            # 解析工具参数')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:43:1\n   |\n41 | print('                        if tool:')\n42 | print('                            logger.info(f\"MainAgent[{self.session_id}]   执行工具：{tool_call.name}\")')\n43 | print('                            ')\n   | ^^^^^\n44 | print('                            # 解析工具参数')\n45 | print('                            args = tool_call.arguments')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:44:1\n   |\n42 | print('                            logger.info(f\"MainAgent[{self.session_id}]   执行工具：{tool_call.name}\")')\n43 | print('                            ')\n44 | print('                            # 解析工具参数')\n   | ^^^^^\n45 | print('                            args = tool_call.arguments')\n46 | print('                            logger.debug(f\"MainAgent[{self.session_id}]     - 参数类型: {type(args).__name__}\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:45:1\n   |\n43 | print('                            ')\n44 | print('                            # 解析工具参数')\n45 | print('                            args = tool_call.arguments')\n   | ^^^^^\n46 | print('                            logger.debug(f\"MainAgent[{self.session_id}]     - 参数类型: {type(args).__name__}\")')\n47 | print('                            ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:46:1\n   |\n44 | print('                            # 解析工具参数')\n45 | print('                            args = tool_call.arguments')\n46 | print('                            logger.debug(f\"MainAgent[{self.session_id}]     - 参数类型: {type(args).__name__}\")')\n   | ^^^^^\n47 | print('                            ')\n48 | print('                            # 执行工具')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:47:1\n   |\n45 | print('                            args = tool_call.arguments')\n46 | print('                            logger.debug(f\"MainAgent[{self.session_id}]     - 参数类型: {type(args).__name__}\")')\n47 | print('                            ')\n   | ^^^^^\n48 | print('                            # 执行工具')\n49 | print('                            if hasattr(tool, \"execute\") and asyncio.iscoroutine(tool.execute):')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:48:1\n   |\n46 | print('                            logger.debug(f\"MainAgent[{self.session_id}]     - 参数类型: {type(args).__name__}\")')\n47 | print('                            ')\n48 | print('                            # 执行工具')\n   | ^^^^^\n49 | print('                            if hasattr(tool, \"execute\") and asyncio.iscoroutine(tool.execute):')\n50 | print('                                tool_result = await tool.execute(args)')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:49:1\n   |\n47 | print('                            ')\n48 | print('                            # 执行工具')\n49 | print('                            if hasattr(tool, \"execute\") and asyncio.iscoroutine(tool.execute):')\n   | ^^^^^\n50 | print('                                tool_result = await tool.execute(args)')\n51 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:50:1\n   |\n48 | print('                            # 执行工具')\n49 | print('                            if hasattr(tool, \"execute\") and asyncio.iscoroutine(tool.execute):')\n50 | print('                                tool_result = await tool.execute(args)')\n   | ^^^^^\n51 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")\n52 | print('                            else:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:51:1\n   |\n49 | print('                            if hasattr(tool, \"execute\") and asyncio.iscoroutine(tool.execute):')\n50 | print('                                tool_result = await tool.execute(args)')\n51 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")\n   | ^^^^^\n52 | print('                            else:')\n53 | print('                                # 同步执行')\n   |\n\ninvalid-syntax: missing closing quote in string literal\n  --> nanobot/agent/_handle_tool_calls_template.py:51:7\n   |\n49 | print('                            if hasattr(tool, \"execute\") and asyncio.iscoroutine(tool.execute):')\n50 | print('                                tool_result = await tool.execute(args)')\n51 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")\n   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n52 | print('                            else:')\n53 | print('                                # 同步执行')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:52:1\n   |\n50 | print('                                tool_result = await tool.execute(args)')\n51 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")\n52 | print('                            else:')\n   | ^^^^^\n53 | print('                                # 同步执行')\n54 | print('                                tool_result = tool.execute(args)')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:53:1\n   |\n51 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")\n52 | print('                            else:')\n53 | print('                                # 同步执行')\n   | ^^^^^\n54 | print('                                tool_result = tool.execute(args)')\n55 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:54:1\n   |\n52 | print('                            else:')\n53 | print('                                # 同步执行')\n54 | print('                                tool_result = tool.execute(args)')\n   | ^^^^^\n55 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")')\n56 | print('                            ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:55:1\n   |\n53 | print('                                # 同步执行')\n54 | print('                                tool_result = tool.execute(args)')\n55 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")')\n   | ^^^^^\n56 | print('                            ')\n57 | print('                            # 记录结果')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:56:1\n   |\n54 | print('                                tool_result = tool.execute(args)')\n55 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")')\n56 | print('                            ')\n   | ^^^^^\n57 | print('                            # 记录结果')\n58 | print('                            tool_results.append({')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:57:1\n   |\n55 | print('                                logger.debug(f\"MainAgent[{self.session_id}]   - 工具结果：{str(tool_result)[:100]}\")')\n56 | print('                            ')\n57 | print('                            # 记录结果')\n   | ^^^^^\n58 | print('                            tool_results.append({')\n59 | print('                                \"tool\": tool_call.name,')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:58:1\n   |\n56 | print('                            ')\n57 | print('                            # 记录结果')\n58 | print('                            tool_results.append({')\n   | ^^^^^\n59 | print('                                \"tool\": tool_call.name,')\n60 | print('                                \"result\": tool_result')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:59:1\n   |\n57 | print('                            # 记录结果')\n58 | print('                            tool_results.append({')\n59 | print('                                \"tool\": tool_call.name,')\n   | ^^^^^\n60 | print('                                \"result\": tool_result')\n61 | print('                            })')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:60:1\n   |\n58 | print('                            tool_results.append({')\n59 | print('                                \"tool\": tool_call.name,')\n60 | print('                                \"result\": tool_result')\n   | ^^^^^\n61 | print('                            })')\n62 | print('                        else:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:61:1\n   |\n59 | print('                                \"tool\": tool_call.name,')\n60 | print('                                \"result\": tool_result')\n61 | print('                            })')\n   | ^^^^^\n62 | print('                        else:')\n63 | print('                            logger.warning(f\"MainAgent[{self.session_id}]   工具未找到：{tool_call.name}\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:62:1\n   |\n60 | print('                                \"result\": tool_result')\n61 | print('                            })')\n62 | print('                        else:')\n   | ^^^^^\n63 | print('                            logger.warning(f\"MainAgent[{self.session_id}]   工具未找到：{tool_call.name}\")')\n64 | print('                            tool_results.append({')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:63:1\n   |\n61 | print('                            })')\n62 | print('                        else:')\n63 | print('                            logger.warning(f\"MainAgent[{self.session_id}]   工具未找到：{tool_call.name}\")')\n   | ^^^^^\n64 | print('                            tool_results.append({')\n65 | print('                                \"tool\": tool_call.name,')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:64:1\n   |\n62 | print('                        else:')\n63 | print('                            logger.warning(f\"MainAgent[{self.session_id}]   工具未找到：{tool_call.name}\")')\n64 | print('                            tool_results.append({')\n   | ^^^^^\n65 | print('                                \"tool\": tool_call.name,')\n66 | print('                                \"result\": f\"工具未找到：{tool_call.name}\"')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:65:1\n   |\n63 | print('                            logger.warning(f\"MainAgent[{self.session_id}]   工具未找到：{tool_call.name}\")')\n64 | print('                            tool_results.append({')\n65 | print('                                \"tool\": tool_call.name,')\n   | ^^^^^\n66 | print('                                \"result\": f\"工具未找到：{tool_call.name}\"')\n67 | print('                            })')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:66:1\n   |\n64 | print('                            tool_results.append({')\n65 | print('                                \"tool\": tool_call.name,')\n66 | print('                                \"result\": f\"工具未找到：{tool_call.name}\"')\n   | ^^^^^\n67 | print('                            })')\n68 | print('                    else:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:67:1\n   |\n65 | print('                                \"tool\": tool_call.name,')\n66 | print('                                \"result\": f\"工具未找到：{tool_call.name}\"')\n67 | print('                            })')\n   | ^^^^^\n68 | print('                    else:')\n69 | print('                        logger.warning(f\"MainAgent[{self.session_id}]   没有工具注册表\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:68:1\n   |\n66 | print('                                \"result\": f\"工具未找到：{tool_call.name}\"')\n67 | print('                            })')\n68 | print('                    else:')\n   | ^^^^^\n69 | print('                        logger.warning(f\"MainAgent[{self.session_id}]   没有工具注册表\")')\n70 | print('                        tool_results.append({')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:69:1\n   |\n67 | print('                            })')\n68 | print('                    else:')\n69 | print('                        logger.warning(f\"MainAgent[{self.session_id}]   没有工具注册表\")')\n   | ^^^^^\n70 | print('                        tool_results.append({')\n71 | print('                            \"tool\": tool_call.name,')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:70:1\n   |\n68 | print('                    else:')\n69 | print('                        logger.warning(f\"MainAgent[{self.session_id}]   没有工具注册表\")')\n70 | print('                        tool_results.append({')\n   | ^^^^^\n71 | print('                            \"tool\": tool_call.name,')\n72 | print('                            \"result\": \"工具系统不可用\"')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:71:1\n   |\n69 | print('                        logger.warning(f\"MainAgent[{self.session_id}]   没有工具注册表\")')\n70 | print('                        tool_results.append({')\n71 | print('                            \"tool\": tool_call.name,')\n   | ^^^^^\n72 | print('                            \"result\": \"工具系统不可用\"')\n73 | print('                            })')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:72:1\n   |\n70 | print('                        tool_results.append({')\n71 | print('                            \"tool\": tool_call.name,')\n72 | print('                            \"result\": \"工具系统不可用\"')\n   | ^^^^^\n73 | print('                            })')\n74 | print('                except Exception as e:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:73:1\n   |\n71 | print('                            \"tool\": tool_call.name,')\n72 | print('                            \"result\": \"工具系统不可用\"')\n73 | print('                            })')\n   | ^^^^^\n74 | print('                except Exception as e:')\n75 | print('                    logger.error(f\"MainAgent[{self.session_id}]   工具执行失败：{e}\", exc_info=True)')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:74:1\n   |\n72 | print('                            \"result\": \"工具系统不可用\"')\n73 | print('                            })')\n74 | print('                except Exception as e:')\n   | ^^^^^\n75 | print('                    logger.error(f\"MainAgent[{self.session_id}]   工具执行失败：{e}\", exc_info=True)')\n76 | print('                    tool_results.append({')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:75:1\n   |\n73 | print('                            })')\n74 | print('                except Exception as e:')\n75 | print('                    logger.error(f\"MainAgent[{self.session_id}]   工具执行失败：{e}\", exc_info=True)')\n   | ^^^^^\n76 | print('                    tool_results.append({')\n77 | print('                        \"tool\": tool_call.name,')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:76:1\n   |\n74 | print('                except Exception as e:')\n75 | print('                    logger.error(f\"MainAgent[{self.session_id}]   工具执行失败：{e}\", exc_info=True)')\n76 | print('                    tool_results.append({')\n   | ^^^^^\n77 | print('                        \"tool\": tool_call.name,')\n78 | print('                        \"result\": f\"执行失败：{str(e)}\")\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:77:1\n   |\n75 | print('                    logger.error(f\"MainAgent[{self.session_id}]   工具执行失败：{e}\", exc_info=True)')\n76 | print('                    tool_results.append({')\n77 | print('                        \"tool\": tool_call.name,')\n   | ^^^^^\n78 | print('                        \"result\": f\"执行失败：{str(e)}\")\n79 | print('                            })')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:78:1\n   |\n76 | print('                    tool_results.append({')\n77 | print('                        \"tool\": tool_call.name,')\n78 | print('                        \"result\": f\"执行失败：{str(e)}\")\n   | ^^^^^\n79 | print('                            })')\n80 | print('            ')\n   |\n\ninvalid-syntax: missing closing quote in string literal\n  --> nanobot/agent/_handle_tool_calls_template.py:78:7\n   |\n76 | print('                    tool_results.append({')\n77 | print('                        \"tool\": tool_call.name,')\n78 | print('                        \"result\": f\"执行失败：{str(e)}\")\n   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n79 | print('                            })')\n80 | print('            ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:79:1\n   |\n77 | print('                        \"tool\": tool_call.name,')\n78 | print('                        \"result\": f\"执行失败：{str(e)}\")\n79 | print('                            })')\n   | ^^^^^\n80 | print('            ')\n81 | print('            # 构建工具结果消息')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:80:1\n   |\n78 | print('                        \"result\": f\"执行失败：{str(e)}\")\n79 | print('                            })')\n80 | print('            ')\n   | ^^^^^\n81 | print('            # 构建工具结果消息')\n82 | print('            if tool_results:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:81:1\n   |\n79 | print('                            })')\n80 | print('            ')\n81 | print('            # 构建工具结果消息')\n   | ^^^^^\n82 | print('            if tool_results:')\n83 | print('                tool_result_messages = []')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:82:1\n   |\n80 | print('            ')\n81 | print('            # 构建工具结果消息')\n82 | print('            if tool_results:')\n   | ^^^^^\n83 | print('                tool_result_messages = []')\n84 | print('                for result in tool_results:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:83:1\n   |\n81 | print('            # 构建工具结果消息')\n82 | print('            if tool_results:')\n83 | print('                tool_result_messages = []')\n   | ^^^^^\n84 | print('                for result in tool_results:')\n85 | print('                    tool_result_messages.append(f\"工具 {result['tool']}: {result['result']}\")\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:84:1\n   |\n82 | print('            if tool_results:')\n83 | print('                tool_result_messages = []')\n84 | print('                for result in tool_results:')\n   | ^^^^^\n85 | print('                    tool_result_messages.append(f\"工具 {result['tool']}: {result['result']}\")\n86 | print('                assistant_message = \"\\\\n\".join(tool_result_messages)')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:85:1\n   |\n83 | print('                tool_result_messages = []')\n84 | print('                for result in tool_results:')\n85 | print('                    tool_result_messages.append(f\"工具 {result['tool']}: {result['result']}\")\n   | ^^^^^\n86 | print('                assistant_message = \"\\\\n\".join(tool_result_messages)')\n87 | print('                logger.info(f\"MainAgent[{self.session_id}]   工具执行结果：{assistant_message[:200]}\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:85:70\n   |\n83 | print('                tool_result_messages = []')\n84 | print('                for result in tool_results:')\n85 | print('                    tool_result_messages.append(f\"工具 {result['tool']}: {result['result']}\")\n   |                                                                        ^^^^\n86 | print('                assistant_message = \"\\\\n\".join(tool_result_messages)')\n87 | print('                logger.info(f\"MainAgent[{self.session_id}]   工具执行结果：{assistant_message[:200]}\")')\n   |\n\ninvalid-syntax: Expected `,`, found string\n  --> nanobot/agent/_handle_tool_calls_template.py:85:74\n   |\n83 | print('                tool_result_messages = []')\n84 | print('                for result in tool_results:')\n85 | print('                    tool_result_messages.append(f\"工具 {result['tool']}: {result['result']}\")\n   |                                                                            ^^^^^^^^^^^^^^\n86 | print('                assistant_message = \"\\\\n\".join(tool_result_messages)')\n87 | print('                logger.info(f\"MainAgent[{self.session_id}]   工具执行结果：{assistant_message[:200]}\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:85:88\n   |\n83 | print('                tool_result_messages = []')\n84 | print('                for result in tool_results:')\n85 | print('                    tool_result_messages.append(f\"工具 {result['tool']}: {result['result']}\")\n   |                                                                                          ^^^^^^\n86 | print('                assistant_message = \"\\\\n\".join(tool_result_messages)')\n87 | print('                logger.info(f\"MainAgent[{self.session_id}]   工具执行结果：{assistant_message[:200]}\")')\n   |\n\ninvalid-syntax: missing closing quote in string literal\n  --> nanobot/agent/_handle_tool_calls_template.py:85:94\n   |\n83 | print('                tool_result_messages = []')\n84 | print('                for result in tool_results:')\n85 | print('                    tool_result_messages.append(f\"工具 {result['tool']}: {result['result']}\")\n   |                                                                                                ^^^^^\n86 | print('                assistant_message = \"\\\\n\".join(tool_result_messages)')\n87 | print('                logger.info(f\"MainAgent[{self.session_id}]   工具执行结果：{assistant_message[:200]}\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:86:1\n   |\n84 | print('                for result in tool_results:')\n85 | print('                    tool_result_messages.append(f\"工具 {result['tool']}: {result['result']}\")\n86 | print('                assistant_message = \"\\\\n\".join(tool_result_messages)')\n   | ^^^^^\n87 | print('                logger.info(f\"MainAgent[{self.session_id}]   工具执行结果：{assistant_message[:200]}\")')\n88 | print('            ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:87:1\n   |\n85 | print('                    tool_result_messages.append(f\"工具 {result['tool']}: {result['result']}\")\n86 | print('                assistant_message = \"\\\\n\".join(tool_result_messages)')\n87 | print('                logger.info(f\"MainAgent[{self.session_id}]   工具执行结果：{assistant_message[:200]}\")')\n   | ^^^^^\n88 | print('            ')\n89 | print('            # 添加助手响应到消息历史')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:88:1\n   |\n86 | print('                assistant_message = \"\\\\n\".join(tool_result_messages)')\n87 | print('                logger.info(f\"MainAgent[{self.session_id}]   工具执行结果：{assistant_message[:200]}\")')\n88 | print('            ')\n   | ^^^^^\n89 | print('            # 添加助手响应到消息历史')\n90 | print('            current_messages.append({')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:89:1\n   |\n87 | print('                logger.info(f\"MainAgent[{self.session_id}]   工具执行结果：{assistant_message[:200]}\")')\n88 | print('            ')\n89 | print('            # 添加助手响应到消息历史')\n   | ^^^^^\n90 | print('            current_messages.append({')\n91 | print('                \"role\": \"assistant\",')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:90:1\n   |\n88 | print('            ')\n89 | print('            # 添加助手响应到消息历史')\n90 | print('            current_messages.append({')\n   | ^^^^^\n91 | print('                \"role\": \"assistant\",')\n92 | print('                \"content\": assistant_message')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:91:1\n   |\n89 | print('            # 添加助手响应到消息历史')\n90 | print('            current_messages.append({')\n91 | print('                \"role\": \"assistant\",')\n   | ^^^^^\n92 | print('                \"content\": assistant_message')\n93 | print('            })')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:92:1\n   |\n90 | print('            current_messages.append({')\n91 | print('                \"role\": \"assistant\",')\n92 | print('                \"content\": assistant_message')\n   | ^^^^^\n93 | print('            })')\n94 | print('            ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:93:1\n   |\n91 | print('                \"role\": \"assistant\",')\n92 | print('                \"content\": assistant_message')\n93 | print('            })')\n   | ^^^^^\n94 | print('            ')\n95 | print('            # 再次调用 LLM 处理工具结果')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:94:1\n   |\n92 | print('                \"content\": assistant_message')\n93 | print('            })')\n94 | print('            ')\n   | ^^^^^\n95 | print('            # 再次调用 LLM 处理工具结果')\n96 | print('            logger.info(f\"MainAgent[{self.session_id}]   调用 LLM 处理工具结果\")')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:95:1\n   |\n93 | print('            })')\n94 | print('            ')\n95 | print('            # 再次调用 LLM 处理工具结果')\n   | ^^^^^\n96 | print('            logger.info(f\"MainAgent[{self.session_id}]   调用 LLM 处理工具结果\")')\n97 | print('            ')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:96:1\n   |\n94 | print('            ')\n95 | print('            # 再次调用 LLM 处理工具结果')\n96 | print('            logger.info(f\"MainAgent[{self.session_id}]   调用 LLM 处理工具结果\")')\n   | ^^^^^\n97 | print('            ')\n98 | print('            try:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n  --> nanobot/agent/_handle_tool_calls_template.py:97:1\n   |\n95 | print('            # 再次调用 LLM 处理工具结果')\n96 | print('            logger.info(f\"MainAgent[{self.session_id}]   调用 LLM 处理工具结果\")')\n97 | print('            ')\n   | ^^^^^\n98 | print('            try:')\n99 | print('                if self.agent_loop:')\n   |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:98:1\n    |\n 96 | print('            logger.info(f\"MainAgent[{self.session_id}]   调用 LLM 处理工具结果\")')\n 97 | print('            ')\n 98 | print('            try:')\n    | ^^^^^\n 99 | print('                if self.agent_loop:')\n100 | print('                    provider = self.agent_loop.provider')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:99:1\n    |\n 97 | print('            ')\n 98 | print('            try:')\n 99 | print('                if self.agent_loop:')\n    | ^^^^^\n100 | print('                    provider = self.agent_loop.provider')\n101 | print('                    model = self.agent_loop.model')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:100:1\n    |\n 98 | print('            try:')\n 99 | print('                if self.agent_loop:')\n100 | print('                    provider = self.agent_loop.provider')\n    | ^^^^^\n101 | print('                    model = self.agent_loop.model')\n102 | print('                else:')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:101:1\n    |\n 99 | print('                if self.agent_loop:')\n100 | print('                    provider = self.agent_loop.provider')\n101 | print('                    model = self.agent_loop.model')\n    | ^^^^^\n102 | print('                else:')\n103 | print('                    # Fallback for testing')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:102:1\n    |\n100 | print('                    provider = self.agent_loop.provider')\n101 | print('                    model = self.agent_loop.model')\n102 | print('                else:')\n    | ^^^^^\n103 | print('                    # Fallback for testing')\n104 | print('                    from nanobot.providers.litellm_provider import LiteLLMProvider')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:103:1\n    |\n101 | print('                    model = self.agent_loop.model')\n102 | print('                else:')\n103 | print('                    # Fallback for testing')\n    | ^^^^^\n104 | print('                    from nanobot.providers.litellm_provider import LiteLLMProvider')\n105 | print('                    provider = LiteLLMProvider()\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:104:1\n    |\n102 | print('                else:')\n103 | print('                    # Fallback for testing')\n104 | print('                    from nanobot.providers.litellm_provider import LiteLLMProvider')\n    | ^^^^^\n105 | print('                    provider = LiteLLMProvider()\n106 | print('                    model = \"volcengine/glm-4.7\"')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:105:1\n    |\n103 | print('                    # Fallback for testing')\n104 | print('                    from nanobot.providers.litellm_provider import LiteLLMProvider')\n105 | print('                    provider = LiteLLMProvider()\n    | ^^^^^\n106 | print('                    model = \"volcengine/glm-4.7\"')\n107 | print('                ')\n    |\n\ninvalid-syntax: missing closing quote in string literal\n   --> nanobot/agent/_handle_tool_calls_template.py:105:7\n    |\n103 | print('                    # Fallback for testing')\n104 | print('                    from nanobot.providers.litellm_provider import LiteLLMProvider')\n105 | print('                    provider = LiteLLMProvider()\n    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n106 | print('                    model = \"volcengine/glm-4.7\"')\n107 | print('                ')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:106:1\n    |\n104 | print('                    from nanobot.providers.litellm_provider import LiteLLMProvider')\n105 | print('                    provider = LiteLLMProvider()\n106 | print('                    model = \"volcengine/glm-4.7\"')\n    | ^^^^^\n107 | print('                ')\n108 | print('                response = await provider.chat(')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:107:1\n    |\n105 | print('                    provider = LiteLLMProvider()\n106 | print('                    model = \"volcengine/glm-4.7\"')\n107 | print('                ')\n    | ^^^^^\n108 | print('                response = await provider.chat(')\n109 | print('                    messages=current_messages,')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:108:1\n    |\n106 | print('                    model = \"volcengine/glm-4.7\"')\n107 | print('                ')\n108 | print('                response = await provider.chat(')\n    | ^^^^^\n109 | print('                    messages=current_messages,')\n110 | print('                    model=model,')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:109:1\n    |\n107 | print('                ')\n108 | print('                response = await provider.chat(')\n109 | print('                    messages=current_messages,')\n    | ^^^^^\n110 | print('                    model=model,')\n111 | print('                    temperature=0.7')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:110:1\n    |\n108 | print('                response = await provider.chat(')\n109 | print('                    messages=current_messages,')\n110 | print('                    model=model,')\n    | ^^^^^\n111 | print('                    temperature=0.7')\n112 | print('                )')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:111:1\n    |\n109 | print('                    messages=current_messages,')\n110 | print('                    model=model,')\n111 | print('                    temperature=0.7')\n    | ^^^^^\n112 | print('                )')\n113 | print('            except Exception as e:')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:112:1\n    |\n110 | print('                    model=model,')\n111 | print('                    temperature=0.7')\n112 | print('                )')\n    | ^^^^^\n113 | print('            except Exception as e:')\n114 | print('                logger.error(f\"MainAgent[{self.session_id}]   LLM 调用失败：{e}\", exc_info=True)')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:113:1\n    |\n111 | print('                    temperature=0.7')\n112 | print('                )')\n113 | print('            except Exception as e:')\n    | ^^^^^\n114 | print('                logger.error(f\"MainAgent[{self.session_id}]   LLM 调用失败：{e}\", exc_info=True)')\n115 | print('                assistant_message += f\"\\\\n\\\\nLLM 调用出错：{str(e)}\"')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:114:1\n    |\n112 | print('                )')\n113 | print('            except Exception as e:')\n114 | print('                logger.error(f\"MainAgent[{self.session_id}]   LLM 调用失败：{e}\", exc_info=True)')\n    | ^^^^^\n115 | print('                assistant_message += f\"\\\\n\\\\nLLM 调用出错：{str(e)}\"')\n116 | print('                break')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:115:1\n    |\n113 | print('            except Exception as e:')\n114 | print('                logger.error(f\"MainAgent[{self.session_id}]   LLM 调用失败：{e}\", exc_info=True)')\n115 | print('                assistant_message += f\"\\\\n\\\\nLLM 调用出错：{str(e)}\"')\n    | ^^^^^\n116 | print('                break')\n117 | print('        ')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:116:1\n    |\n114 | print('                logger.error(f\"MainAgent[{self.session_id}]   LLM 调用失败：{e}\", exc_info=True)')\n115 | print('                assistant_message += f\"\\\\n\\\\nLLM 调用出错：{str(e)}\"')\n116 | print('                break')\n    | ^^^^^\n117 | print('        ')\n118 | print('        # 返回最终响应')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:117:1\n    |\n115 | print('                assistant_message += f\"\\\\n\\\\nLLM 调用出错：{str(e)}\"')\n116 | print('                break')\n117 | print('        ')\n    | ^^^^^\n118 | print('        # 返回最终响应')\n119 | print('        return assistant_message or \"工具调用完成\"')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:118:1\n    |\n116 | print('                break')\n117 | print('        ')\n118 | print('        # 返回最终响应')\n    | ^^^^^\n119 | print('        return assistant_message or \"工具调用完成\"')\n120 | print('')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:119:1\n    |\n117 | print('        ')\n118 | print('        # 返回最终响应')\n119 | print('        return assistant_message or \"工具调用完成\"')\n    | ^^^^^\n120 | print('')\n    |\n\ninvalid-syntax: Expected `,`, found name\n   --> nanobot/agent/_handle_tool_calls_template.py:120:1\n    |\n118 | print('        # 返回最终响应')\n119 | print('        return assistant_message or \"工具调用完成\"')\n120 | print('')\n    | ^^^^^\n    |\n\ninvalid-syntax: unexpected EOF while parsing\n   --> nanobot/agent/_handle_tool_calls_template.py:120:10\n    |\n118 | print('        # 返回最终响应')\n119 | print('        return assistant_message or \"工具调用完成\"')\n120 | print('')\n    |          ^\n    |\n\nW292 No newline at end of file\n   --> nanobot/agent/_handle_tool_calls_template.py:120:10\n    |\n118 | print('        # 返回最终响应')\n119 | print('        return assistant_message or \"工具调用完成\"')\n120 | print('')\n    |          ^\n    |\nhelp: Add trailing newline\n\nF401 [*] `typing.Optional` imported but unused\n  --> nanobot/agent/context_compressor.py:15:32\n   |\n13 | import logging\n14 | from dataclasses import dataclass\n15 | from typing import Dict, List, Optional, Tuple\n   |                                ^^^^^^^^\n16 |\n17 | try:\n   |\nhelp: Remove unused import: `typing.Optional`\n\nF841 Local variable `role` is assigned to but never used\n   --> nanobot/agent/context_compressor.py:227:13\n    |\n225 |         for msg in messages:\n226 |             content = msg.get(\"content\", \"\")\n227 |             role = msg.get(\"role\", \"user\")\n    |             ^^^^\n228 |\n229 |             for keyword in task_keywords:\n    |\nhelp: Remove assignment to unused variable `role`\n\nF401 [*] `dataclasses.field` imported but unused\n  --> nanobot/agent/context_monitor.py:15:36\n   |\n14 | import logging\n15 | from dataclasses import dataclass, field\n   |                                    ^^^^^\n16 | from enum import Enum\n17 | from typing import Any, Dict, List, Optional\n   |\nhelp: Remove unused import: `dataclasses.field`\n\nN805 First argument of a method should be named `self`\n  --> nanobot/agent/cron_system.py:95:22\n   |\n93 |         self._stop_event = threading.Event()\n94 |\n95 |     def _thread_safe(func):\n   |                      ^^^^\n96 |         \"\"\"\n97 |         线程安全装饰器\n   |\nhelp: Rename `func` to `self`\n\nF841 Local variable `start_time` is assigned to but never used\n   --> nanobot/agent/cron_system.py:376:9\n    |\n374 |         status.run_count += 1\n375 |\n376 |         start_time = time.time()\n    |         ^^^^^^^^^^\n377 |         self.logger.debug(f\"任务开始执行: {job_id}\")\n    |\nhelp: Remove assignment to unused variable `start_time`\n\nF841 Local variable `result` is assigned to but never used\n   --> nanobot/agent/cron_system.py:381:13\n    |\n379 |         try:\n380 |             config = self.jobs[job_id]\n381 |             result = config.function(*config.args, **config.kwargs)\n    |             ^^^^^^\n382 |             status.last_run = datetime.datetime.now()\n383 |             status.last_success = status.last_run\n    |\nhelp: Remove assignment to unused variable `result`\n\nF841 Local variable `job` is assigned to but never used\n   --> nanobot/agent/cron_system.py:411:17\n    |\n409 |             try:\n410 |                 # 简化实现，假设下次运行时间计算\n411 |                 job = self.schedule_jobs[job_id]\n    |                 ^^^\n412 |                 # schedule 库不直接提供 next_run 属性，这里使用简单估算\n413 |                 if self.jobs[job_id].job_type == JobType.INTERVAL:\n    |\nhelp: Remove assignment to unused variable `job`\n\nF401 [*] `uuid` imported but unused\n --> nanobot/agent/decision/new_message_handler.py:6:8\n  |\n5 | import logging\n6 | import uuid\n  |        ^^^^\n7 | from datetime import datetime\n8 | from typing import TYPE_CHECKING, Any, Dict\n  |\nhelp: Remove unused import: `uuid`\n\nF401 [*] `typing.Optional` imported but unused\n  --> nanobot/agent/decision/skill_decision_handler.py:12:52\n   |\n11 | import logging\n12 | from typing import TYPE_CHECKING, Any, Dict, List, Optional\n   |                                                    ^^^^^^^^\n13 |\n14 | if TYPE_CHECKING:\n   |\nhelp: Remove unused import: `typing.Optional`\n\nF401 [*] `typing.Union` imported but unused\n  --> nanobot/agent/flow/manager.py:12:62\n   |\n10 | import uuid\n11 | from datetime import datetime\n12 | from typing import Any, Callable, Dict, List, Optional, Set, Union\n   |                                                              ^^^^^\n13 |\n14 | from loguru import logger\n   |\nhelp: Remove unused import: `typing.Union`\n\nF401 [*] `.models.FlowProgress` imported but unused\n  --> nanobot/agent/flow/manager.py:16:34\n   |\n14 | from loguru import logger\n15 |\n16 | from .models import FlowContext, FlowProgress, FlowResult, FlowState, FlowStep\n   |                                  ^^^^^^^^^^^^\n   |\nhelp: Remove unused import\n\nF401 [*] `.models.FlowResult` imported but unused\n  --> nanobot/agent/flow/manager.py:16:48\n   |\n14 | from loguru import logger\n15 |\n16 | from .models import FlowContext, FlowProgress, FlowResult, FlowState, FlowStep\n   |                                                ^^^^^^^^^^\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Callable` imported but unused\n  --> nanobot/agent/flow/models.py:11:25\n   |\n 9 | from datetime import datetime\n10 | from enum import Enum\n11 | from typing import Any, Callable, Dict, Generic, List, Optional, TypeVar, Union\n   |                         ^^^^^^^^\n12 |\n13 | from pydantic import BaseModel, Field\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Generic` imported but unused\n  --> nanobot/agent/flow/models.py:11:41\n   |\n 9 | from datetime import datetime\n10 | from enum import Enum\n11 | from typing import Any, Callable, Dict, Generic, List, Optional, TypeVar, Union\n   |                                         ^^^^^^^\n12 |\n13 | from pydantic import BaseModel, Field\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Union` imported but unused\n  --> nanobot/agent/flow/models.py:11:75\n   |\n 9 | from datetime import datetime\n10 | from enum import Enum\n11 | from typing import Any, Callable, Dict, Generic, List, Optional, TypeVar, Union\n   |                                                                           ^^^^^\n12 |\n13 | from pydantic import BaseModel, Field\n   |\nhelp: Remove unused import\n\nF401 [*] `math` imported but unused\n  --> nanobot/agent/flow/progress.py:9:8\n   |\n 7 | from __future__ import annotations\n 8 |\n 9 | import math\n   |        ^^^^\n10 | from datetime import datetime\n11 | from typing import Any, Callable, Dict, List, Optional, Union\n   |\nhelp: Remove unused import: `math`\n\nF401 [*] `typing.Dict` imported but unused\n  --> nanobot/agent/flow/progress.py:11:35\n   |\n 9 | import math\n10 | from datetime import datetime\n11 | from typing import Any, Callable, Dict, List, Optional, Union\n   |                                   ^^^^\n12 |\n13 | from loguru import logger\n   |\nhelp: Remove unused import: `typing.Dict`\n\nF821 Undefined name `Wizard`\n   --> nanobot/agent/flow/progress.py:285:17\n    |\n283 |     def __init__(\n284 |         self,\n285 |         wizard: Wizard,\n    |                 ^^^^^^\n286 |         flow_id: str,\n287 |         context: FlowContext,\n    |\n\nF821 Undefined name `FlowContext`\n   --> nanobot/agent/flow/progress.py:287:18\n    |\n285 |         wizard: Wizard,\n286 |         flow_id: str,\n287 |         context: FlowContext,\n    |                  ^^^^^^^^^^^\n288 |     ):\n289 |         \"\"\"\n    |\n\nF821 Undefined name `FlowResult`\n   --> nanobot/agent/flow/progress.py:304:28\n    |\n302 |         self._cancelled = False\n303 |\n304 |     async def run(self) -> FlowResult:\n    |                            ^^^^^^^^^^\n305 |         \"\"\"\n306 |         运行向导\n    |\n\nF821 Undefined name `WizardStepError`\n   --> nanobot/agent/flow/progress.py:318:27\n    |\n316 |                 step = self.wizard.get_step(self._current_step_id)\n317 |                 if not step:\n318 |                     raise WizardStepError(f\"步骤不存在: {self._current_step_id}\")\n    |                           ^^^^^^^^^^^^^^^\n319 |\n320 |                 # 执行步骤\n    |\n\nF821 Undefined name `FlowResult`\n   --> nanobot/agent/flow/progress.py:334:24\n    |\n333 |             if self._cancelled:\n334 |                 return FlowResult(\n    |                        ^^^^^^^^^^\n335 |                     success=False,\n336 |                     state=FlowState.CANCELLED,\n    |\n\nF821 Undefined name `FlowResult`\n   --> nanobot/agent/flow/progress.py:344:20\n    |\n342 |                 )\n343 |\n344 |             return FlowResult(\n    |                    ^^^^^^^^^^\n345 |                 success=True,\n346 |                 state=FlowState.COMPLETED,\n    |\n\nF821 Undefined name `FlowResult`\n   --> nanobot/agent/flow/progress.py:357:20\n    |\n355 |             end_time = datetime.now()\n356 |\n357 |             return FlowResult(\n    |                    ^^^^^^^^^^\n358 |                 success=False,\n359 |                 state=FlowState.ERROR,\n    |\n\nF401 [*] `typing.List` imported but unused\n  --> nanobot/agent/flow/wizard.py:9:41\n   |\n 7 | from __future__ import annotations\n 8 |\n 9 | from typing import Any, Callable, Dict, List, Optional, Union\n   |                                         ^^^^\n10 |\n11 | from loguru import logger\n   |\nhelp: Remove unused import: `typing.List`\n\nF401 [*] `.models.FlowResult` imported but unused\n  --> nanobot/agent/flow/wizard.py:13:34\n   |\n11 | from loguru import logger\n12 |\n13 | from .models import FlowContext, FlowResult, FlowState, WizardConfig, WizardStep\n   |                                  ^^^^^^^^^^\n   |\nhelp: Remove unused import\n\nF401 [*] `.models.FlowState` imported but unused\n  --> nanobot/agent/flow/wizard.py:13:46\n   |\n11 | from loguru import logger\n12 |\n13 | from .models import FlowContext, FlowResult, FlowState, WizardConfig, WizardStep\n   |                                              ^^^^^^^^^\n   |\nhelp: Remove unused import\n\nF401 `sys` imported but unused\n --> nanobot/agent/hooks/__init__.py:6:8\n  |\n5 | # 直接从 hooks.py 文件导入类\n6 | import sys\n  |        ^^^\n7 | from pathlib import Path\n  |\nhelp: Remove unused import: `sys`\n\nF401 [*] `typing.Union` imported but unused\n  --> nanobot/agent/intent/code_based_recognizer.py:9:57\n   |\n 7 | import logging\n 8 | from dataclasses import dataclass, field\n 9 | from typing import Any, Callable, Dict, List, Optional, Union\n   |                                                         ^^^^^\n10 |\n11 | logger = logging.getLogger(__name__)\n   |\nhelp: Remove unused import: `typing.Union`\n\nI001 [*] Import block is un-sorted or un-formatted\n  --> nanobot/agent/intent/hybrid_recognizer.py:7:1\n   |\n 5 |   \"\"\"\n 6 |\n 7 | / import logging\n 8 | | from dataclasses import dataclass, field\n 9 | | from enum import Enum\n10 | | from typing import Any, Callable, Dict, List, Optional, Tuple, Union\n11 | |\n12 | | from nanobot.agent.intent.code_based_recognizer import CodeBasedRecognizer\n13 | | from nanobot.agent.intent.code_based_recognizer import (\n14 | |     CodeRecognitionResult as CodeResult,\n15 | | )\n16 | | from nanobot.agent.intent.llm_recognizer import LLMProvider\n17 | | from nanobot.agent.intent.llm_recognizer import LLMRecognitionResult as LLMResult\n18 | | from nanobot.agent.intent.llm_recognizer import LLMRecognizer\n19 | | from nanobot.agent.intent.rule_based_recognizer import RecognitionResult as RuleResult\n20 | | from nanobot.agent.intent.rule_based_recognizer import RuleBasedRecognizer\n   | |__________________________________________________________________________^\n21 |\n22 |   logger = logging.getLogger(__name__)\n   |\nhelp: Organize imports\n\nF401 [*] `typing.Callable` imported but unused\n  --> nanobot/agent/intent/llm_recognizer.py:12:25\n   |\n10 | from dataclasses import dataclass, field\n11 | from enum import Enum\n12 | from typing import Any, Callable, Dict, List, Optional, Union\n   |                         ^^^^^^^^\n13 |\n14 | logger = logging.getLogger(__name__)\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Union` imported but unused\n  --> nanobot/agent/intent/llm_recognizer.py:12:57\n   |\n10 | from dataclasses import dataclass, field\n11 | from enum import Enum\n12 | from typing import Any, Callable, Dict, List, Optional, Union\n   |                                                         ^^^^^\n13 |\n14 | logger = logging.getLogger(__name__)\n   |\nhelp: Remove unused import\n\nF401 [*] `asyncio` imported but unused\n --> nanobot/agent/main_agent.py:7:8\n  |\n5 | \"\"\"\n6 |\n7 | import asyncio\n  |        ^^^^^^^\n8 | import inspect\n9 | import logging\n  |\nhelp: Remove unused import: `asyncio`\n\nF401 [*] `inspect` imported but unused\n  --> nanobot/agent/main_agent.py:8:8\n   |\n 7 | import asyncio\n 8 | import inspect\n   |        ^^^^^^^\n 9 | import logging\n10 | from datetime import datetime\n   |\nhelp: Remove unused import: `inspect`\n\nF401 [*] `nanobot.agent.decision.models.DecisionRequest` imported but unused\n  --> nanobot/agent/main_agent.py:19:43\n   |\n17 | from nanobot.agent.context_manager import ContextManagerV2 as ContextManager\n18 | from nanobot.agent.decision.decision_maker import ExecutionDecisionMaker\n19 | from nanobot.agent.decision.models import DecisionRequest, DecisionResult\n   |                                           ^^^^^^^^^^^^^^^\n20 | from nanobot.agent.hooks import MainAgentHooks as MainAgentHooks\n21 | from nanobot.agent.planner.models import TaskPlan\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.decision.models.DecisionResult` imported but unused\n  --> nanobot/agent/main_agent.py:19:60\n   |\n17 | from nanobot.agent.context_manager import ContextManagerV2 as ContextManager\n18 | from nanobot.agent.decision.decision_maker import ExecutionDecisionMaker\n19 | from nanobot.agent.decision.models import DecisionRequest, DecisionResult\n   |                                                            ^^^^^^^^^^^^^^\n20 | from nanobot.agent.hooks import MainAgentHooks as MainAgentHooks\n21 | from nanobot.agent.planner.models import TaskPlan\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.planner.models.TaskPlan` imported but unused\n  --> nanobot/agent/main_agent.py:21:42\n   |\n19 | from nanobot.agent.decision.models import DecisionRequest, DecisionResult\n20 | from nanobot.agent.hooks import MainAgentHooks as MainAgentHooks\n21 | from nanobot.agent.planner.models import TaskPlan\n   |                                          ^^^^^^^^\n22 | from nanobot.agent.planner.task_planner import TaskPlanner\n23 | from nanobot.agent.subagent.manager import SubagentManager\n   |\nhelp: Remove unused import: `nanobot.agent.planner.models.TaskPlan`\n\nF821 Undefined name `AgentLoop`\n  --> nanobot/agent/main_agent.py:73:31\n   |\n71 |         prompt_system_v2: Optional[\"PromptSystemV2\"] = None,\n72 |         context_manager: Optional[\"ContextManager\"] = None,\n73 |         agent_loop: Optional[\"AgentLoop\"] = None,\n   |                               ^^^^^^^^^\n74 |     ):\n75 |         \"\"\"\n   |\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/main_agent.py:266:13\n    |\n264 |         # 构建响应\n265 |         response_parts = [\n266 |             f\"✅ 任务已创建\",\n    |             ^^^^^^^^^^^^^^^^\n267 |             f\"\",\n268 |             f\"任务ID: {task_id}\",\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/main_agent.py:267:13\n    |\n265 |         response_parts = [\n266 |             f\"✅ 任务已创建\",\n267 |             f\"\",\n    |             ^^^\n268 |             f\"任务ID: {task_id}\",\n269 |             f\"任务描述: {task_plan.summary}\",\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/main_agent.py:270:13\n    |\n268 |             f\"任务ID: {task_id}\",\n269 |             f\"任务描述: {task_plan.summary}\",\n270 |             f\"\",\n    |             ^^^\n271 |             f\"执行步骤:\",\n272 |         ]\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/main_agent.py:271:13\n    |\n269 |             f\"任务描述: {task_plan.summary}\",\n270 |             f\"\",\n271 |             f\"执行步骤:\",\n    |             ^^^^^^^^^^^^\n272 |         ]\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/main_agent.py:282:17\n    |\n280 |         response_parts.extend(\n281 |             [\n282 |                 f\"\",\n    |                 ^^^\n283 |                 f\"使用 '/status {task_id}' 查看任务状态\",\n284 |                 f\"使用 '/cancel {task_id}' 取消任务\",\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/main_agent.py:323:17\n    |\n321 |             response_parts = [\n322 |                 f\"📋 任务状态: {task_id}\",\n323 |                 f\"\",\n    |                 ^^^\n324 |                 f\"描述: {description}\",\n325 |                 f\"状态: {status}\",\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/main_agent.py:327:17\n    |\n325 |                 f\"状态: {status}\",\n326 |                 f\"创建时间: {created_at}\",\n327 |                 f\"\",\n    |                 ^^^\n328 |                 f\"进度: {completed}/{total} 子任务完成\",\n329 |             ]\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/main_agent.py:332:39\n    |\n331 |             if subtasks:\n332 |                 response_parts.append(f\"子任务列表:\")\n    |                                       ^^^^^^^^^^^^^^\n333 |                 for i, subtask in enumerate(subtasks[:10], 1):  # 最多显示10个\n334 |                     st_status = subtask.get(\"status\", \"unknown\")\n    |\nhelp: Remove extraneous `f` prefix\n\nF401 [*] `time` imported but unused\n  --> nanobot/agent/message_bus.py:10:8\n   |\n 8 | import json\n 9 | import logging\n10 | import time\n   |        ^^^^\n11 | import uuid\n12 | from abc import ABC, abstractmethod\n   |\nhelp: Remove unused import: `time`\n\nF401 [*] `datetime.datetime` imported but unused\n  --> nanobot/agent/message_bus.py:13:22\n   |\n11 | import uuid\n12 | from abc import ABC, abstractmethod\n13 | from datetime import datetime\n   |                      ^^^^^^^^\n14 | from typing import Any, Awaitable, Callable, Dict, List, Optional, Set\n   |\nhelp: Remove unused import: `datetime.datetime`\n\nF401 [*] `typing.Any` imported but unused\n  --> nanobot/agent/message_bus.py:14:20\n   |\n12 | from abc import ABC, abstractmethod\n13 | from datetime import datetime\n14 | from typing import Any, Awaitable, Callable, Dict, List, Optional, Set\n   |                    ^^^\n15 |\n16 | from nanobot.agent.message_schemas import (\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Set` imported but unused\n  --> nanobot/agent/message_bus.py:14:68\n   |\n12 | from abc import ABC, abstractmethod\n13 | from datetime import datetime\n14 | from typing import Any, Awaitable, Callable, Dict, List, Optional, Set\n   |                                                                    ^^^\n15 |\n16 | from nanobot.agent.message_schemas import (\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.message_schemas.ErrorMessage` imported but unused\n  --> nanobot/agent/message_bus.py:18:5\n   |\n16 | from nanobot.agent.message_schemas import (\n17 |     ControlMessage,\n18 |     ErrorMessage,\n   |     ^^^^^^^^^^^^\n19 |     HeartbeatMessage,\n20 |     LogMessage,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.message_schemas.HeartbeatMessage` imported but unused\n  --> nanobot/agent/message_bus.py:19:5\n   |\n17 |     ControlMessage,\n18 |     ErrorMessage,\n19 |     HeartbeatMessage,\n   |     ^^^^^^^^^^^^^^^^\n20 |     LogMessage,\n21 |     MessageType,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.message_schemas.LogMessage` imported but unused\n  --> nanobot/agent/message_bus.py:20:5\n   |\n18 |     ErrorMessage,\n19 |     HeartbeatMessage,\n20 |     LogMessage,\n   |     ^^^^^^^^^^\n21 |     MessageType,\n22 |     RequestMessage,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.message_schemas.MessageType` imported but unused\n  --> nanobot/agent/message_bus.py:21:5\n   |\n19 |     HeartbeatMessage,\n20 |     LogMessage,\n21 |     MessageType,\n   |     ^^^^^^^^^^^\n22 |     RequestMessage,\n23 |     ResponseMessage,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.message_schemas.RequestMessage` imported but unused\n  --> nanobot/agent/message_bus.py:22:5\n   |\n20 |     LogMessage,\n21 |     MessageType,\n22 |     RequestMessage,\n   |     ^^^^^^^^^^^^^^\n23 |     ResponseMessage,\n24 |     StatusUpdateMessage,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.message_schemas.ResponseMessage` imported but unused\n  --> nanobot/agent/message_bus.py:23:5\n   |\n21 |     MessageType,\n22 |     RequestMessage,\n23 |     ResponseMessage,\n   |     ^^^^^^^^^^^^^^^\n24 |     StatusUpdateMessage,\n25 |     TaskResultMessage,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.message_schemas.parse_message` imported but unused\n  --> nanobot/agent/message_bus.py:26:5\n   |\n24 |     StatusUpdateMessage,\n25 |     TaskResultMessage,\n26 |     parse_message,\n   |     ^^^^^^^^^^^^^\n27 | )\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Tuple` imported but unused\n  --> nanobot/agent/message_router.py:11:57\n   |\n 9 | from dataclasses import dataclass, field\n10 | from enum import Enum\n11 | from typing import Any, Callable, Dict, List, Optional, Tuple, Union\n   |                                                         ^^^^^\n12 |\n13 | from .message_analyzer import AnalysisResult, MessageAnalyzer\n   |\nhelp: Remove unused import: `typing.Tuple`\n\nF401 [*] `typing.Union` imported but unused\n  --> nanobot/agent/message_schemas.py:9:47\n   |\n 7 | from datetime import datetime\n 8 | from enum import Enum\n 9 | from typing import Any, Dict, List, Optional, Union\n   |                                               ^^^^^\n10 |\n11 | from pydantic import BaseModel, Field\n   |\nhelp: Remove unused import: `typing.Union`\n\nF401 [*] `subprocess` imported but unused\n --> nanobot/agent/monitoring/health_checker.py:5:8\n  |\n3 | \"\"\"\n4 |\n5 | import subprocess\n  |        ^^^^^^^^^^\n6 | import threading\n7 | import time\n  |\nhelp: Remove unused import: `subprocess`\n\nF401 [*] `.state_tracker.AgentState` imported but unused\n  --> nanobot/agent/monitoring/health_checker.py:13:28\n   |\n11 | from loguru import logger\n12 |\n13 | from .state_tracker import AgentState, StateTracker\n   |                            ^^^^^^^^^^\n   |\nhelp: Remove unused import: `.state_tracker.AgentState`\n\nF401 [*] `typing.Any` imported but unused\n  --> nanobot/agent/monitoring/logger.py:10:20\n   |\n 8 | from logging.handlers import RotatingFileHandler\n 9 | from pathlib import Path\n10 | from typing import Any, Dict, Optional\n   |                    ^^^\n11 |\n12 | from loguru import logger\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Dict` imported but unused\n  --> nanobot/agent/monitoring/logger.py:10:25\n   |\n 8 | from logging.handlers import RotatingFileHandler\n 9 | from pathlib import Path\n10 | from typing import Any, Dict, Optional\n   |                         ^^^^\n11 |\n12 | from loguru import logger\n   |\nhelp: Remove unused import\n\nF401 [*] `dataclasses.field` imported but unused\n --> nanobot/agent/monitoring/metrics_collector.py:7:36\n  |\n5 | import time\n6 | from collections import defaultdict\n7 | from dataclasses import dataclass, field\n  |                                    ^^^^^\n8 | from typing import Any, Dict, List, Optional\n  |\nhelp: Remove unused import: `dataclasses.field`\n\nF401 [*] `typing.List` imported but unused\n  --> nanobot/agent/monitoring/metrics_collector.py:8:31\n   |\n 6 | from collections import defaultdict\n 7 | from dataclasses import dataclass, field\n 8 | from typing import Any, Dict, List, Optional\n   |                               ^^^^\n 9 |\n10 | import psutil\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Optional` imported but unused\n  --> nanobot/agent/monitoring/metrics_collector.py:8:37\n   |\n 6 | from collections import defaultdict\n 7 | from dataclasses import dataclass, field\n 8 | from typing import Any, Dict, List, Optional\n   |                                     ^^^^^^^^\n 9 |\n10 | import psutil\n   |\nhelp: Remove unused import\n\nF401 [*] `time` imported but unused\n --> nanobot/agent/monitoring/opentelemetry.py:5:8\n  |\n3 | \"\"\"\n4 |\n5 | import time\n  |        ^^^^\n6 | import traceback\n7 | from contextvars import ContextVar\n  |\nhelp: Remove unused import: `time`\n\nF401 [*] `contextvars.ContextVar` imported but unused\n --> nanobot/agent/monitoring/opentelemetry.py:7:25\n  |\n5 | import time\n6 | import traceback\n7 | from contextvars import ContextVar\n  |                         ^^^^^^^^^^\n8 | from typing import Any, Dict, List, Optional\n  |\nhelp: Remove unused import: `contextvars.ContextVar`\n\nF401 [*] `typing.List` imported but unused\n  --> nanobot/agent/monitoring/opentelemetry.py:8:31\n   |\n 6 | import traceback\n 7 | from contextvars import ContextVar\n 8 | from typing import Any, Dict, List, Optional\n   |                               ^^^^\n 9 |\n10 | import opentelemetry.sdk.trace as trace_sdk\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Optional` imported but unused\n  --> nanobot/agent/monitoring/opentelemetry.py:8:37\n   |\n 6 | import traceback\n 7 | from contextvars import ContextVar\n 8 | from typing import Any, Dict, List, Optional\n   |                                     ^^^^^^^^\n 9 |\n10 | import opentelemetry.sdk.trace as trace_sdk\n   |\nhelp: Remove unused import\n\nF401 [*] `opentelemetry.semconv.trace.SpanAttributes` imported but unused\n  --> nanobot/agent/monitoring/opentelemetry.py:16:41\n   |\n14 | from opentelemetry.sdk.resources import Resource\n15 | from opentelemetry.sdk.trace.export import BatchSpanProcessor\n16 | from opentelemetry.semconv.trace import SpanAttributes\n   |                                         ^^^^^^^^^^^^^^\n17 | from opentelemetry.trace import Status, StatusCode\n   |\nhelp: Remove unused import: `opentelemetry.semconv.trace.SpanAttributes`\n\nF841 Local variable `dependent_steps` is assigned to but never used\n   --> nanobot/agent/planner/task_planner.py:781:9\n    |\n779 |         \"\"\"\n780 |         # 1. 首先处理有依赖关系的步骤\n781 |         dependent_steps = [step for step in steps if step.dependencies]\n    |         ^^^^^^^^^^^^^^^\n782 |         independent_steps = [step for step in steps if not step.dependencies]\n    |\nhelp: Remove assignment to unused variable `dependent_steps`\n\nF841 Local variable `independent_steps` is assigned to but never used\n   --> nanobot/agent/planner/task_planner.py:782:9\n    |\n780 |         # 1. 首先处理有依赖关系的步骤\n781 |         dependent_steps = [step for step in steps if step.dependencies]\n782 |         independent_steps = [step for step in steps if not step.dependencies]\n    |         ^^^^^^^^^^^^^^^^^\n783 |\n784 |         # 2. 按优先级排序\n    |\nhelp: Remove assignment to unused variable `independent_steps`\n\nF841 Local variable `priority_order` is assigned to but never used\n   --> nanobot/agent/planner/task_planner.py:785:9\n    |\n784 |         # 2. 按优先级排序\n785 |         priority_order = [\n    |         ^^^^^^^^^^^^^^\n786 |             TaskPriority.URGENT,\n787 |             TaskPriority.HIGH,\n    |\nhelp: Remove assignment to unused variable `priority_order`\n\nF401 [*] `os` imported but unused\n  --> nanobot/agent/prompt_builder.py:13:8\n   |\n11 | \"\"\"\n12 |\n13 | import os\n   |        ^^\n14 | from datetime import datetime\n15 | from pathlib import Path\n   |\nhelp: Remove unused import: `os`\n\nF401 [*] `datetime.datetime` imported but unused\n  --> nanobot/agent/prompt_builder.py:14:22\n   |\n13 | import os\n14 | from datetime import datetime\n   |                      ^^^^^^^^\n15 | from pathlib import Path\n16 | from typing import Any, Dict, List, Optional, Union\n   |\nhelp: Remove unused import: `datetime.datetime`\n\nF401 [*] `nanobot.config.loader.load_config` imported but unused\n  --> nanobot/agent/prompt_builder.py:21:35\n   |\n20 | from nanobot.agent.tools.registry import ToolRegistry\n21 | from nanobot.config.loader import load_config\n   |                                   ^^^^^^^^^^^\n22 | from nanobot.utils.helpers import get_project_context\n   |\nhelp: Remove unused import: `nanobot.config.loader.load_config`\n\nF401 [*] `dataclasses.dataclass` imported but unused\n  --> nanobot/agent/prompt_system.py:9:25\n   |\n 8 | import logging\n 9 | from dataclasses import dataclass\n   |                         ^^^^^^^^^\n10 | from pathlib import Path\n11 | from typing import Any, Dict, List, Optional\n   |\nhelp: Remove unused import: `dataclasses.dataclass`\n\nF841 Local variable `content` is assigned to but never used\n   --> nanobot/agent/prompt_system.py:265:9\n    |\n263 |         \"\"\"单个提示词层加载完成后的默认处理\"\"\"\n264 |         layer_name = kwargs.get(\"layer_name\")\n265 |         content = kwargs.get(\"content\", {})\n    |         ^^^^^^^\n266 |         logger.debug(f\"PromptSystemV2 layer loaded: {layer_name}\")\n    |\nhelp: Remove assignment to unused variable `content`\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/prompt_system.py:283:22\n    |\n281 |     def on_prompt_ready(self, **kwargs) -> None:\n282 |         \"\"\"通用提示词构建完成后的默认处理\"\"\"\n283 |         logger.debug(f\"PromptSystemV2 prompt ready\")\n    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n284 |\n285 |     def on_agent_initialized(self, **kwargs) -> None:\n    |\nhelp: Remove extraneous `f` prefix\n\nF841 Local variable `agent` is assigned to but never used\n   --> nanobot/agent/prompt_system.py:287:9\n    |\n285 |     def on_agent_initialized(self, **kwargs) -> None:\n286 |         \"\"\"Agent 初始化完成后的默认处理\"\"\"\n287 |         agent = kwargs.get(\"agent\")\n    |         ^^^^^\n288 |         session_key = kwargs.get(\"session_key\")\n289 |         logger.info(f\"PromptSystemV2 agent initialized: {session_key}\")\n    |\nhelp: Remove assignment to unused variable `agent`\n\nF401 [*] `nanobot.agent.task.Task` imported but unused\n  --> nanobot/agent/subagent/agno_subagent.py:12:32\n   |\n10 | from pydantic import BaseModel, Field\n11 |\n12 | from nanobot.agent.task import Task, TaskStatus\n   |                                ^^^^\n13 | from nanobot.agent.task_manager import TaskManager\n14 | from nanobot.agent.tools.filesystem import ListDirTool, ReadFileTool, WriteFileTool\n   |\nhelp: Remove unused import: `nanobot.agent.task.Task`\n\ninvalid-syntax: Expected `,`, found `{`\n   --> nanobot/agent/subagent/enhanced_agno_subagent.py:148:22\n    |\n146 |             self._run_subagent(\n147 |                 subagent_id,\n148 |                 task {\n    |                      ^\n149 |                     \"channel\": origin_channel,\n150 |                     \"chat_id\": origin_chat_id,\n    |\n\nF401 [*] `typing.Callable` imported but unused\n --> nanobot/agent/subagent/manager.py:7:25\n  |\n5 | import logging\n6 | from datetime import datetime, timedelta\n7 | from typing import Any, Callable, Dict, List, Optional\n  |                         ^^^^^^^^\n8 |\n9 | from nanobot.agent.subagent.agno_subagent import AgnoSubagent\n  |\nhelp: Remove unused import: `typing.Callable`\n\nF401 [*] `nanobot.agent.task.Task` imported but unused\n  --> nanobot/agent/subagent/manager.py:11:32\n   |\n 9 | from nanobot.agent.subagent.agno_subagent import AgnoSubagent\n10 | from nanobot.agent.subagent.models import SubagentResult, SubagentState, SubagentTask\n11 | from nanobot.agent.task import Task, TaskStatus\n   |                                ^^^^\n12 | from nanobot.agent.task_manager import TaskManager\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.task.TaskStatus` imported but unused\n  --> nanobot/agent/subagent/manager.py:11:38\n   |\n 9 | from nanobot.agent.subagent.agno_subagent import AgnoSubagent\n10 | from nanobot.agent.subagent.models import SubagentResult, SubagentState, SubagentTask\n11 | from nanobot.agent.task import Task, TaskStatus\n   |                                      ^^^^^^^^^^\n12 | from nanobot.agent.task_manager import TaskManager\n   |\nhelp: Remove unused import\n\nF401 [*] `uuid` imported but unused\n  --> nanobot/agent/subagent/manager.py:88:16\n   |\n86 |         # 集成 TaskManager\n87 |         # 我们需要确保 TaskManager 使用与我们相同的 task_id\n88 |         import uuid\n   |                ^^^^\n89 |\n90 |         from nanobot.agent.task_manager import Task\n   |\nhelp: Remove unused import: `uuid`\n\nF811 Redefinition of unused `Task` from line 11\n  --> nanobot/agent/subagent/manager.py:90:48\n   |\n88 |         import uuid\n89 |\n90 |         from nanobot.agent.task_manager import Task\n   |                                                ^^^^ `Task` redefined here\n91 |\n92 |         # 创建任务时使用我们自己的 task_id\n   |\n  ::: nanobot/agent/subagent/manager.py:11:32\n   |\n 9 | from nanobot.agent.subagent.agno_subagent import AgnoSubagent\n10 | from nanobot.agent.subagent.models import SubagentResult, SubagentState, SubagentTask\n11 | from nanobot.agent.task import Task, TaskStatus\n   |                                ---- previous definition of `Task` here\n12 | from nanobot.agent.task_manager import TaskManager\n   |\nhelp: Remove definition: `Task`\n\nF811 Redefinition of unused `Task` from line 11\n   --> nanobot/agent/subagent/manager.py:143:48\n    |\n142 |         # 集成 TaskManager\n143 |         from nanobot.agent.task_manager import Task\n    |                                                ^^^^ `Task` redefined here\n144 |\n145 |         task_obj = Task(\n    |\n   ::: nanobot/agent/subagent/manager.py:11:32\n    |\n  9 | from nanobot.agent.subagent.agno_subagent import AgnoSubagent\n 10 | from nanobot.agent.subagent.models import SubagentResult, SubagentState, SubagentTask\n 11 | from nanobot.agent.task import Task, TaskStatus\n    |                                ---- previous definition of `Task` here\n 12 | from nanobot.agent.task_manager import TaskManager\n    |\nhelp: Remove definition: `Task`\n\nF811 Redefinition of unused `cleanup_subagent` from line 507\n   --> nanobot/agent/subagent/manager.py:639:15\n    |\n637 |         logger.debug(\"SubagentManager 已同步任务状态到 TaskManager\")\n638 |\n639 |     async def cleanup_subagent(self, task_id: str):\n    |               ^^^^^^^^^^^^^^^^ `cleanup_subagent` redefined here\n640 |         \"\"\"\n641 |         清理 Subagent 资源\n    |\n   ::: nanobot/agent/subagent/manager.py:507:15\n    |\n505 |             del self._callback_map[task_id]\n506 |\n507 |     async def cleanup_subagent(self, task_id: str):\n    |               ---------------- previous definition of `cleanup_subagent` here\n508 |         \"\"\"\n509 |         清理 Subagent 资源\n    |\nhelp: Remove definition: `cleanup_subagent`\n\nF401 [*] `pathlib.Path` imported but unused\n --> nanobot/agent/tools/config_tools.py:5:21\n  |\n3 | \"\"\"\n4 |\n5 | from pathlib import Path\n  |                     ^^^^\n6 | from typing import Any, Dict, List\n  |\nhelp: Remove unused import: `pathlib.Path`\n\nF401 [*] `typing.Any` imported but unused\n --> nanobot/agent/tools/config_tools.py:6:20\n  |\n5 | from pathlib import Path\n6 | from typing import Any, Dict, List\n  |                    ^^^\n7 |\n8 | from nanobot.agent.tools.base import Tool\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.Dict` imported but unused\n --> nanobot/agent/tools/config_tools.py:6:25\n  |\n5 | from pathlib import Path\n6 | from typing import Any, Dict, List\n  |                         ^^^^\n7 |\n8 | from nanobot.agent.tools.base import Tool\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.List` imported but unused\n --> nanobot/agent/tools/config_tools.py:6:31\n  |\n5 | from pathlib import Path\n6 | from typing import Any, Dict, List\n  |                               ^^^^\n7 |\n8 | from nanobot.agent.tools.base import Tool\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.Any` imported but unused\n --> nanobot/agent/tools/database_tools.py:5:20\n  |\n3 | \"\"\"\n4 |\n5 | from typing import Any, Dict\n  |                    ^^^\n6 |\n7 | from nanobot.agent.tools.base import Tool\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.Dict` imported but unused\n --> nanobot/agent/tools/database_tools.py:5:25\n  |\n3 | \"\"\"\n4 |\n5 | from typing import Any, Dict\n  |                         ^^^^\n6 |\n7 | from nanobot.agent.tools.base import Tool\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.Any` imported but unused\n --> nanobot/agent/tools/docker_tools.py:5:20\n  |\n3 | \"\"\"\n4 |\n5 | from typing import Any, Dict\n  |                    ^^^\n6 |\n7 | from nanobot.agent.tools.base import Tool\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.Dict` imported but unused\n --> nanobot/agent/tools/docker_tools.py:5:25\n  |\n3 | \"\"\"\n4 |\n5 | from typing import Any, Dict\n  |                         ^^^^\n6 |\n7 | from nanobot.agent.tools.base import Tool\n  |\nhelp: Remove unused import\n\nF541 [*] f-string without any placeholders\n  --> nanobot/agent/tools/docker_tools.py:53:33\n   |\n51 |             if build_args:\n52 |                 for key, value in build_args.items():\n53 |                     cmd.extend([f\"--build-arg\", f\"{key}={value}\"])\n   |                                 ^^^^^^^^^^^^^^\n54 |\n55 |             cmd.extend([\"-t\", tag, context])\n   |\nhelp: Remove extraneous `f` prefix\n\nF401 [*] `typing.List` imported but unused\n --> nanobot/agent/tools/filesystem.py:4:25\n  |\n3 | from pathlib import Path\n4 | from typing import Any, List, Optional\n  |                         ^^^^\n5 |\n6 | from loguru import logger\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.Optional` imported but unused\n --> nanobot/agent/tools/filesystem.py:4:31\n  |\n3 | from pathlib import Path\n4 | from typing import Any, List, Optional\n  |                               ^^^^^^^^\n5 |\n6 | from loguru import logger\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.Any` imported but unused\n --> nanobot/agent/tools/git_tools.py:5:20\n  |\n3 | \"\"\"\n4 |\n5 | from typing import Any, Dict\n  |                    ^^^\n6 |\n7 | from nanobot.agent.tools.base import Tool\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.Dict` imported but unused\n --> nanobot/agent/tools/git_tools.py:5:25\n  |\n3 | \"\"\"\n4 |\n5 | from typing import Any, Dict\n  |                         ^^^^\n6 |\n7 | from nanobot.agent.tools.base import Tool\n  |\nhelp: Remove unused import\n\nF401 [*] `json` imported but unused\n --> nanobot/agent/tools/mcp.py:4:8\n  |\n3 | import asyncio\n4 | import json\n  |        ^^^^\n5 | import subprocess\n6 | from dataclasses import dataclass, field\n  |\nhelp: Remove unused import: `json`\n\nF811 [*] Redefinition of unused `json` from line 4\n   --> nanobot/agent/tools/mcp.py:168:16\n    |\n166 |     ) -> str:\n167 |         \"\"\"Call a tool via stdio transport.\"\"\"\n168 |         import json\n    |                ^^^^ `json` redefined here\n169 |\n170 |         if not conn.process or conn.process.poll() is not None:\n    |\n   ::: nanobot/agent/tools/mcp.py:4:8\n    |\n  3 | import asyncio\n  4 | import json\n    |        ---- previous definition of `json` here\n  5 | import subprocess\n  6 | from dataclasses import dataclass, field\n    |\nhelp: Remove definition: `json`\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/tools/mcp.py:369:24\n    |\n367 |                 return result\n368 |             elif conn.config.transport == \"sse\":\n369 |                 return f\"Error: SSE transport not yet implemented\"\n    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n370 |             else:\n371 |                 return f\"Error: Unknown transport: {conn.config.transport}\"\n    |\nhelp: Remove extraneous `f` prefix\n\nF811 [*] Redefinition of unused `json` from line 4\n   --> nanobot/agent/tools/mcp.py:502:16\n    |\n500 |     ) -> str:\n501 |         \"\"\"Call a tool via stdio transport.\"\"\"\n502 |         import json\n    |                ^^^^ `json` redefined here\n503 |         import select\n504 |         import time\n    |\n   ::: nanobot/agent/tools/mcp.py:4:8\n    |\n  3 | import asyncio\n  4 | import json\n    |        ---- previous definition of `json` here\n  5 | import subprocess\n  6 | from dataclasses import dataclass, field\n    |\nhelp: Remove definition: `json`\n\nF401 [*] `select` imported but unused\n   --> nanobot/agent/tools/mcp.py:503:16\n    |\n501 |         \"\"\"Call a tool via stdio transport.\"\"\"\n502 |         import json\n503 |         import select\n    |                ^^^^^^\n504 |         import time\n    |\nhelp: Remove unused import: `select`\n\nF401 [*] `time` imported but unused\n   --> nanobot/agent/tools/mcp.py:504:16\n    |\n502 |         import json\n503 |         import select\n504 |         import time\n    |                ^^^^\n505 |\n506 |         if not conn.process or conn.process.poll() is not None:\n    |\nhelp: Remove unused import: `time`\n\nF811 [*] Redefinition of unused `json` from line 4\n   --> nanobot/agent/tools/mcp.py:547:16\n    |\n545 |     async def _process_stdio_output(self, conn: MCPConnection):\n546 |         \"\"\"Process output from stdio transport.\"\"\"\n547 |         import json\n    |                ^^^^ `json` redefined here\n548 |\n549 |         if not conn.process or not conn.process.stdout:\n    |\n   ::: nanobot/agent/tools/mcp.py:4:8\n    |\n  3 | import asyncio\n  4 | import json\n    |        ---- previous definition of `json` here\n  5 | import subprocess\n  6 | from dataclasses import dataclass, field\n    |\nhelp: Remove definition: `json`\n\nF811 Redefinition of unused `parameters` from line 224\n   --> nanobot/agent/tools/mcp.py:617:9\n    |\n616 |     @property\n617 |     def parameters(self) -> dict[str, Any]:\n    |         ^^^^^^^^^^ `parameters` redefined here\n618 |         return {\n619 |             \"type\": \"object\",\n    |\n   ::: nanobot/agent/tools/mcp.py:224:9\n    |\n223 |     @property\n224 |     def parameters(self) -> dict[str, Any]:\n    |         ---------- previous definition of `parameters` here\n225 |         return {\n226 |             \"type\": \"object\",\n    |\nhelp: Remove definition: `parameters`\n\nF811 Redefinition of unused `execute` from line 245\n   --> nanobot/agent/tools/mcp.py:638:15\n    |\n636 |         }\n637 |\n638 |     async def execute(self, operation: str, **kwargs) -> str:\n    |               ^^^^^^^ `execute` redefined here\n639 |         \"\"\"Execute MCP tool operation.\n    |\n   ::: nanobot/agent/tools/mcp.py:245:15\n    |\n243 |         }\n244 |\n245 |     async def execute(self, operation: str, **kwargs) -> str:\n    |               ------- previous definition of `execute` here\n246 |         \"\"\"Execute MCP tool operation.\n    |\nhelp: Remove definition: `execute`\n\nF541 [*] f-string without any placeholders\n   --> nanobot/agent/tools/mcp.py:773:24\n    |\n771 |                 return result\n772 |             elif conn.config.transport == \"sse\":\n773 |                 return f\"Error: SSE transport not yet implemented\"\n    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n774 |             else:\n775 |                 return f\"Error: Unknown transport: {conn.config.transport}\"\n    |\nhelp: Remove extraneous `f` prefix\n\nF811 [*] Redefinition of unused `json` from line 4\n   --> nanobot/agent/tools/mcp.py:784:16\n    |\n782 |     ) -> str:\n783 |         \"\"\"Call a tool via stdio transport.\"\"\"\n784 |         import json\n    |                ^^^^ `json` redefined here\n785 |\n786 |         if not conn.process or conn.process.poll() is not None:\n    |\n   ::: nanobot/agent/tools/mcp.py:4:8\n    |\n  3 | import asyncio\n  4 | import json\n    |        ---- previous definition of `json` here\n  5 | import subprocess\n  6 | from dataclasses import dataclass, field\n    |\nhelp: Remove definition: `json`\n\nF811 Redefinition of unused `close` from line 596\n   --> nanobot/agent/tools/mcp.py:868:15\n    |\n866 |         raise TimeoutError(f\"MCP tool call timed out after {timeout} seconds\")\n867 |\n868 |     async def close(self):\n    |               ^^^^^ `close` redefined here\n869 |         \"\"\"Close all MCP connections.\"\"\"\n870 |         for server_name, conn in self.connections.items():\n    |\n   ::: nanobot/agent/tools/mcp.py:596:15\n    |\n594 |             logger.error(f\"Error processing MCP output: {e}\")\n595 |\n596 |     async def close(self):\n    |               ----- previous definition of `close` here\n597 |         \"\"\"Close all MCP connections.\"\"\"\n598 |         for server_name, conn in self.connections.items():\n    |\nhelp: Remove definition: `close`\n\nF821 Undefined name `time`\n   --> nanobot/agent/tools/mcp.py:888:38\n    |\n886 |                         import select\n887 |\n888 |                         start_time = time.time()\n    |                                      ^^^^\n889 |                         while time.time() - start_time < 5:\n890 |                             if select.select([conn.process.stdout], [], [], 0.1)[0]:\n    |\n\nF821 Undefined name `time`\n   --> nanobot/agent/tools/mcp.py:889:31\n    |\n888 |                         start_time = time.time()\n889 |                         while time.time() - start_time < 5:\n    |                               ^^^^\n890 |                             if select.select([conn.process.stdout], [], [], 0.1)[0]:\n891 |                                 conn.process.stdout.readline()\n    |\n\nF401 [*] `asyncio` imported but unused\n  --> nanobot/agents/agno_main_agent.py:13:8\n   |\n11 | \"\"\"\n12 |\n13 | import asyncio\n   |        ^^^^^^^\n14 | import logging\n15 | from pathlib import Path\n   |\nhelp: Remove unused import: `asyncio`\n\nF401 [*] `logging` imported but unused\n  --> nanobot/agents/agno_main_agent.py:14:8\n   |\n13 | import asyncio\n14 | import logging\n   |        ^^^^^^^\n15 | from pathlib import Path\n16 | from typing import Any, Dict, List, Optional\n   |\nhelp: Remove unused import: `logging`\n\nF401 [*] `logging` imported but unused\n  --> nanobot/agents/agno_subagent.py:14:8\n   |\n13 | import asyncio\n14 | import logging\n   |        ^^^^^^^\n15 | from pathlib import Path\n16 | from typing import Any, Awaitable, Dict, List, Optional\n   |\nhelp: Remove unused import: `logging`\n\nF401 [*] `typing.Awaitable` imported but unused\n  --> nanobot/agents/agno_subagent.py:16:25\n   |\n14 | import logging\n15 | from pathlib import Path\n16 | from typing import Any, Awaitable, Dict, List, Optional\n   |                         ^^^^^^^^^\n17 |\n18 | from loguru import logger\n   |\nhelp: Remove unused import: `typing.Awaitable`\n\nF841 [*] Local variable `e` is assigned to but never used\n  --> nanobot/agents/error_recovery.py:89:29\n   |\n87 |             return result\n88 |\n89 |         except Exception as e:\n   |                             ^\n90 |             # Record failure\n91 |             await self._record_failure()\n   |\nhelp: Remove assignment to unused variable `e`\n\nE731 Do not assign a `lambda` expression, use a `def`\n   --> nanobot/agents/error_recovery.py:440:13\n    |\n438 |         if circuit_breaker:\n439 |             cb = self.get_circuit_breaker(circuit_breaker)\n440 |             func = lambda *a, **k: cb.call(func, *a, **k)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n441 |\n442 |         # Wrap with timeout\n    |\nhelp: Rewrite `func` as a `def`\n\nE731 Do not assign a `lambda` expression, use a `def`\n   --> nanobot/agents/error_recovery.py:445:13\n    |\n443 |         if timeout_handler:\n444 |             th = self.get_timeout_handler(timeout_handler)\n445 |             func = lambda *a, **k: th.execute(func, *a, **k)\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n446 |\n447 |         # Wrap with retry\n    |\nhelp: Rewrite `func` as a `def`\n\nF401 [*] `typing.Set` imported but unused\n  --> nanobot/agents/event_bus.py:8:57\n   |\n 6 | from dataclasses import dataclass\n 7 | from enum import Enum\n 8 | from typing import Any, Callable, Dict, List, Optional, Set\n   |                                                         ^^^\n 9 |\n10 | from loguru import logger\n   |\nhelp: Remove unused import: `typing.Set`\n\nE741 Ambiguous variable name: `l`\n   --> nanobot/agents/event_bus.py:209:23\n    |\n208 |             self._listeners[event_type] = [\n209 |                 l for l in self._listeners[event_type] if l.listener_id != listener_id\n    |                       ^\n210 |             ]\n    |\n\nF401 [*] `traceback` imported but unused\n --> nanobot/agents/subagent_manager.py:6:8\n  |\n4 | import os\n5 | import time\n6 | import traceback\n  |        ^^^^^^^^^\n7 | from dataclasses import dataclass, field\n8 | from enum import Enum\n  |\nhelp: Remove unused import: `traceback`\n\nF401 [*] `typing.AsyncGenerator` imported but unused\n --> nanobot/channels/tui_channel.py:5:25\n  |\n3 | import asyncio\n4 | import sys\n5 | from typing import Any, AsyncGenerator, Dict\n  |                         ^^^^^^^^^^^^^^\n6 |\n7 | from loguru import logger\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.Dict` imported but unused\n --> nanobot/channels/tui_channel.py:5:41\n  |\n3 | import asyncio\n4 | import sys\n5 | from typing import Any, AsyncGenerator, Dict\n  |                                         ^^^^\n6 |\n7 | from loguru import logger\n  |\nhelp: Remove unused import\n\nF401 [*] `typing.AsyncGenerator` imported but unused\n --> nanobot/channels/webchat_channel.py:5:25\n  |\n3 | import asyncio\n4 | import json\n5 | from typing import Any, AsyncGenerator, Dict, Optional\n  |                         ^^^^^^^^^^^^^^\n6 |\n7 | from loguru import logger\n  |\nhelp: Remove unused import: `typing.AsyncGenerator`\n\nF401 [*] `datetime.timedelta` imported but unused\n  --> nanobot/monitor/alert_manager.py:16:32\n   |\n15 | import time\n16 | from datetime import datetime, timedelta\n   |                                ^^^^^^^^^\n17 | from typing import Any, Callable, Dict, List, Optional\n   |\nhelp: Remove unused import: `datetime.timedelta`\n\nF401 [*] `nanobot.monitor.health_checker.HealthCheck` imported but unused\n  --> nanobot/monitor/alert_manager.py:21:44\n   |\n19 | from loguru import logger\n20 |\n21 | from nanobot.monitor.health_checker import HealthCheck, get_health_checker\n   |                                            ^^^^^^^^^^^\n22 | from nanobot.monitor.performance_monitor import get_performance_monitor\n23 | from nanobot.monitor.structured_logger import get_structured_logger\n   |\nhelp: Remove unused import: `nanobot.monitor.health_checker.HealthCheck`\n\nF401 [*] `datetime.timedelta` imported but unused\n  --> nanobot/monitor/diagnostics.py:18:32\n   |\n16 | import platform\n17 | import sys\n18 | from datetime import datetime, timedelta\n   |                                ^^^^^^^^^\n19 | from typing import Any, Dict, List, Optional\n   |\nhelp: Remove unused import: `datetime.timedelta`\n\nF401 [*] `time` imported but unused\n  --> nanobot/monitor/health_checker.py:15:8\n   |\n13 | \"\"\"\n14 |\n15 | import time\n   |        ^^^^\n16 | from datetime import datetime\n17 | from typing import Any, Callable, Dict, List, Optional\n   |\nhelp: Remove unused import: `time`\n\nF821 Undefined name `sys`\n  --> nanobot/monitor/performance_monitor.py:52:16\n   |\n51 |             # 转换为 MB（macOS 以字节为单位，其他系统以 KB 为单位）\n52 |             if sys.platform == \"darwin\":\n   |                ^^^\n53 |                 return mem_usage / (1024 * 1024)\n54 |             return mem_usage / 1024\n   |\n\nF401 [*] `logging` imported but unused\n  --> nanobot/monitor/structured_logger.py:16:8\n   |\n15 | import json\n16 | import logging\n   |        ^^^^^^^\n17 | import sys\n18 | from datetime import datetime\n   |\nhelp: Remove unused import: `logging`\n\nF401 [*] `datetime.datetime` imported but unused\n  --> nanobot/monitor/structured_logger.py:18:22\n   |\n16 | import logging\n17 | import sys\n18 | from datetime import datetime\n   |                      ^^^^^^^^\n19 | from pathlib import Path\n20 | from typing import Any, Dict, Optional, Union\n   |\nhelp: Remove unused import: `datetime.datetime`\n\nF401 [*] `rich.panel.Panel` imported but unused\n  --> nanobot/ui/formatters.py:11:24\n   |\n 9 | from rich import box\n10 | from rich.console import Console\n11 | from rich.panel import Panel\n   |                        ^^^^^\n12 | from rich.style import Style\n13 | from rich.table import Table\n   |\nhelp: Remove unused import: `rich.panel.Panel`\n\nF401 [*] `rich.style.Style` imported but unused\n  --> nanobot/ui/formatters.py:12:24\n   |\n10 | from rich.console import Console\n11 | from rich.panel import Panel\n12 | from rich.style import Style\n   |                        ^^^^^\n13 | from rich.table import Table\n14 | from rich.text import Text\n   |\nhelp: Remove unused import: `rich.style.Style`\n\nF401 [*] `typing.Set` imported but unused\n --> nanobot/ui/progress_manager.py:7:47\n  |\n5 | import time\n6 | from dataclasses import dataclass, field\n7 | from typing import Any, Dict, List, Optional, Set\n  |                                               ^^^\n8 | from uuid import uuid4\n  |\nhelp: Remove unused import: `typing.Set`\n\nF401 [*] `typing.Tuple` imported but unused\n --> nanobot/ui/widgets.py:7:47\n  |\n5 | import time\n6 | from dataclasses import dataclass, field\n7 | from typing import Any, Dict, List, Optional, Tuple\n  |                                               ^^^^^\n8 |\n9 | import psutil\n  |\nhelp: Remove unused import: `typing.Tuple`\n\nF401 [*] `rich.box` imported but unused\n  --> nanobot/ui/widgets.py:10:18\n   |\n 9 | import psutil\n10 | from rich import box\n   |                  ^^^\n11 | from rich.console import Console, ConsoleOptions, RenderResult\n12 | from rich.layout import Layout\n   |\nhelp: Remove unused import: `rich.box`\n\nF401 [*] `rich.layout.Layout` imported but unused\n  --> nanobot/ui/widgets.py:12:25\n   |\n10 | from rich import box\n11 | from rich.console import Console, ConsoleOptions, RenderResult\n12 | from rich.layout import Layout\n   |                         ^^^^^^\n13 | from rich.panel import Panel\n14 | from rich.progress import (\n   |\nhelp: Remove unused import: `rich.layout.Layout`\n\nF401 [*] `rich.spinner.Spinner` imported but unused\n  --> nanobot/ui/widgets.py:24:26\n   |\n22 |     TimeRemainingColumn,\n23 | )\n24 | from rich.spinner import Spinner\n   |                          ^^^^^^^\n25 | from rich.table import Table\n26 | from rich.text import Text\n   |\nhelp: Remove unused import: `rich.spinner.Spinner`\n\nF401 [*] `rich.text.Text` imported but unused\n  --> nanobot/ui/widgets.py:26:23\n   |\n24 | from rich.spinner import Spinner\n25 | from rich.table import Table\n26 | from rich.text import Text\n   |                       ^^^^\n   |\nhelp: Remove unused import: `rich.text.Text`\n\nF401 [*] `typing.Callable` imported but unused\n  --> nanobot/utils/cache.py:18:25\n   |\n16 | import threading\n17 | import time\n18 | from typing import Any, Callable, Dict, Optional, Type\n   |                         ^^^^^^^^\n19 |\n20 | from loguru import logger\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Type` imported but unused\n  --> nanobot/utils/cache.py:18:51\n   |\n16 | import threading\n17 | import time\n18 | from typing import Any, Callable, Dict, Optional, Type\n   |                                                   ^^^^\n19 |\n20 | from loguru import logger\n   |\nhelp: Remove unused import\n\nF401 [*] `os` imported but unused\n  --> nanobot/utils/graceful_shutdown.py:15:8\n   |\n13 | \"\"\"\n14 |\n15 | import os\n   |        ^^\n16 | import signal\n17 | import sys\n   |\nhelp: Remove unused import: `os`\n\nF401 [*] `sys` imported but unused\n  --> nanobot/utils/graceful_shutdown.py:17:8\n   |\n15 | import os\n16 | import signal\n17 | import sys\n   |        ^^^\n18 | import threading\n19 | import time\n   |\nhelp: Remove unused import: `sys`\n\nF541 [*] f-string without any placeholders\n   --> nanobot/utils/workspace_resolver.py:175:19\n    |\n173 |         if \"软链接\" in \" \".join(validation[\"issues\"]):\n174 |             print(\"  1. 删除软链接，创建真实目录:\")\n175 |             print(f\"     rm ~/.nanobot/workspace\")\n    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n176 |             print(f\"     mkdir -p ~/.nanobot/workspace\")\n177 |             print(f\"     cp -r ~/.nanobot/workspace.backup/* ~/.nanobot/workspace/\")\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/utils/workspace_resolver.py:176:19\n    |\n174 |             print(\"  1. 删除软链接，创建真实目录:\")\n175 |             print(f\"     rm ~/.nanobot/workspace\")\n176 |             print(f\"     mkdir -p ~/.nanobot/workspace\")\n    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n177 |             print(f\"     cp -r ~/.nanobot/workspace.backup/* ~/.nanobot/workspace/\")\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/utils/workspace_resolver.py:177:19\n    |\n175 |             print(f\"     rm ~/.nanobot/workspace\")\n176 |             print(f\"     mkdir -p ~/.nanobot/workspace\")\n177 |             print(f\"     cp -r ~/.nanobot/workspace.backup/* ~/.nanobot/workspace/\")\n    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n178 |\n179 |         if \"在项目目录内\" in \" \".join(validation[\"warnings\"]):\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/utils/workspace_resolver.py:181:19\n    |\n179 |         if \"在项目目录内\" in \" \".join(validation[\"warnings\"]):\n180 |             print(\"  2. 使用独立的 workspace 目录:\")\n181 |             print(f\"     修改 config.json 中的 workspace 为:\")\n    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n182 |             print(f'     \"workspace\": \"/Users/jiangyayun/.nanobot/workspace\"')\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> nanobot/utils/workspace_resolver.py:182:19\n    |\n180 |             print(\"  2. 使用独立的 workspace 目录:\")\n181 |             print(f\"     修改 config.json 中的 workspace 为:\")\n182 |             print(f'     \"workspace\": \"/Users/jiangyayun/.nanobot/workspace\"')\n    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n183 |\n184 |     print()\n    |\nhelp: Remove extraneous `f` prefix\n\nF401 [*] `pytest` imported but unused\n --> tests/channels/test_route_strategy.py:3:8\n  |\n1 | \"\"\"Tests for message routing strategies.\"\"\"\n2 |\n3 | import pytest\n  |        ^^^^^^\n4 |\n5 | from nanobot.channels.route_strategy import (\n  |\nhelp: Remove unused import: `pytest`\n\nF401 [*] `nanobot.channels.route_strategy.RouteStrategy` imported but unused\n  --> tests/channels/test_route_strategy.py:8:5\n   |\n 6 |     FeishuRouteStrategy,\n 7 |     RoutePriority,\n 8 |     RouteStrategy,\n   |     ^^^^^^^^^^^^^\n 9 |     TUIRouteStrategy,\n10 |     WebChatRouteStrategy,\n   |\nhelp: Remove unused import: `nanobot.channels.route_strategy.RouteStrategy`\n\nF401 [*] `asyncio` imported but unused\n --> tests/channels/test_tui_channel.py:3:8\n  |\n1 | \"\"\"Tests for TUI channel.\"\"\"\n2 |\n3 | import asyncio\n  |        ^^^^^^^\n4 | from unittest.mock import AsyncMock, Mock, patch\n  |\nhelp: Remove unused import: `asyncio`\n\nF811 [*] Redefinition of unused `asyncio` from line 3\n   --> tests/channels/test_tui_channel.py:107:16\n    |\n105 |         \"\"\"Test async input with timeout.\"\"\"\n106 |         # Mock input to raise TimeoutError on first call, return input on second\n107 |         import asyncio\n    |                ^^^^^^^ `asyncio` redefined here\n108 |\n109 |         with patch(\"select.select\", return_value=([], [], [])):\n    |\n   ::: tests/channels/test_tui_channel.py:3:8\n    |\n  1 | \"\"\"Tests for TUI channel.\"\"\"\n  2 |\n  3 | import asyncio\n    |        ------- previous definition of `asyncio` here\n  4 | from unittest.mock import AsyncMock, Mock, patch\n    |\nhelp: Remove definition: `asyncio`\n\nF401 [*] `asyncio` imported but unused\n   --> tests/channels/test_tui_channel.py:107:16\n    |\n105 |         \"\"\"Test async input with timeout.\"\"\"\n106 |         # Mock input to raise TimeoutError on first call, return input on second\n107 |         import asyncio\n    |                ^^^^^^^\n108 |\n109 |         with patch(\"select.select\", return_value=([], [], [])):\n    |\nhelp: Remove unused import: `asyncio`\n\nF811 [*] Redefinition of unused `asyncio` from line 3\n   --> tests/channels/test_tui_channel.py:116:16\n    |\n114 |     async def test_get_input_async_success(self, tui_channel):\n115 |         \"\"\"Test successful async input.\"\"\"\n116 |         import asyncio\n    |                ^^^^^^^ `asyncio` redefined here\n117 |         import select\n    |\n   ::: tests/channels/test_tui_channel.py:3:8\n    |\n  1 | \"\"\"Tests for TUI channel.\"\"\"\n  2 |\n  3 | import asyncio\n    |        ------- previous definition of `asyncio` here\n  4 | from unittest.mock import AsyncMock, Mock, patch\n    |\nhelp: Remove definition: `asyncio`\n\nF401 [*] `asyncio` imported but unused\n   --> tests/channels/test_tui_channel.py:116:16\n    |\n114 |     async def test_get_input_async_success(self, tui_channel):\n115 |         \"\"\"Test successful async input.\"\"\"\n116 |         import asyncio\n    |                ^^^^^^^\n117 |         import select\n    |\nhelp: Remove unused import: `asyncio`\n\nF401 [*] `select` imported but unused\n   --> tests/channels/test_tui_channel.py:117:16\n    |\n115 |         \"\"\"Test successful async input.\"\"\"\n116 |         import asyncio\n117 |         import select\n    |                ^^^^^^\n118 |\n119 |         # Mock select to indicate data available\n    |\nhelp: Remove unused import: `select`\n\nF401 [*] `unittest.mock.MagicMock` imported but unused\n --> tests/channels/test_webchat_channel.py:5:38\n  |\n3 | import asyncio\n4 | import json\n5 | from unittest.mock import AsyncMock, MagicMock, Mock, patch\n  |                                      ^^^^^^^^^\n6 |\n7 | import pytest\n  |\nhelp: Remove unused import: `unittest.mock.MagicMock`\n\nF401 [*] `asyncio` imported but unused\n --> tests/integration/test_main_agent_integration.py:5:8\n  |\n3 | \"\"\"\n4 |\n5 | import asyncio\n  |        ^^^^^^^\n6 |\n7 | import pytest\n  |\nhelp: Remove unused import: `asyncio`\n\nF401 [*] `nanobot.agent.context_monitor.CompressionEvent` imported but unused\n  --> tests/test_agent_loop_with_monitor.py:19:43\n   |\n17 | import pytest\n18 |\n19 | from nanobot.agent.context_monitor import CompressionEvent, ContextMonitorConfig\n   |                                           ^^^^^^^^^^^^^^^^\n20 | from nanobot.agent.loop import AgentLoop\n21 | from nanobot.bus.events import InboundMessage, OutboundMessage\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.context_monitor.ContextMonitorConfig` imported but unused\n  --> tests/test_agent_loop_with_monitor.py:19:61\n   |\n17 | import pytest\n18 |\n19 | from nanobot.agent.context_monitor import CompressionEvent, ContextMonitorConfig\n   |                                                             ^^^^^^^^^^^^^^^^^^^^\n20 | from nanobot.agent.loop import AgentLoop\n21 | from nanobot.bus.events import InboundMessage, OutboundMessage\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.bus.events.InboundMessage` imported but unused\n  --> tests/test_agent_loop_with_monitor.py:21:32\n   |\n19 | from nanobot.agent.context_monitor import CompressionEvent, ContextMonitorConfig\n20 | from nanobot.agent.loop import AgentLoop\n21 | from nanobot.bus.events import InboundMessage, OutboundMessage\n   |                                ^^^^^^^^^^^^^^\n22 | from nanobot.bus.queue import MessageBus\n23 | from nanobot.providers.base import LLMProvider\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.bus.events.OutboundMessage` imported but unused\n  --> tests/test_agent_loop_with_monitor.py:21:48\n   |\n19 | from nanobot.agent.context_monitor import CompressionEvent, ContextMonitorConfig\n20 | from nanobot.agent.loop import AgentLoop\n21 | from nanobot.bus.events import InboundMessage, OutboundMessage\n   |                                                ^^^^^^^^^^^^^^^\n22 | from nanobot.bus.queue import MessageBus\n23 | from nanobot.providers.base import LLMProvider\n   |\nhelp: Remove unused import\n\nF811 [*] Redefinition of unused `InboundMessage` from line 21\n  --> tests/test_agent_loop_with_monitor.py:87:40\n   |\n85 |     def test_context_monitor_in_process_system_message(self):\n86 |         \"\"\"测试在 _process_system_message中使用 ContextMonitor\"\"\"\n87 |         from nanobot.bus.events import InboundMessage\n   |                                        ^^^^^^^^^^^^^^ `InboundMessage` redefined here\n88 |\n89 |         loop = AgentLoop(\n   |\n  ::: tests/test_agent_loop_with_monitor.py:21:32\n   |\n19 | from nanobot.agent.context_monitor import CompressionEvent, ContextMonitorConfig\n20 | from nanobot.agent.loop import AgentLoop\n21 | from nanobot.bus.events import InboundMessage, OutboundMessage\n   |                                -------------- previous definition of `InboundMessage` here\n22 | from nanobot.bus.queue import MessageBus\n23 | from nanobot.providers.base import LLMProvider\n   |\nhelp: Remove definition: `InboundMessage`\n\nF811 [*] Redefinition of unused `InboundMessage` from line 21\n   --> tests/test_agent_loop_with_monitor.py:133:40\n    |\n131 |     def test_context_monitor_in_process_message(self, mock_main_agent):\n132 |         \"\"\"测试在 _process_message 中使用 ContextMonitor\"\"\"\n133 |         from nanobot.bus.events import InboundMessage\n    |                                        ^^^^^^^^^^^^^^ `InboundMessage` redefined here\n134 |\n135 |         # 设置 MainAgent 模拟\n    |\n   ::: tests/test_agent_loop_with_monitor.py:21:32\n    |\n 19 | from nanobot.agent.context_monitor import CompressionEvent, ContextMonitorConfig\n 20 | from nanobot.agent.loop import AgentLoop\n 21 | from nanobot.bus.events import InboundMessage, OutboundMessage\n    |                                -------------- previous definition of `InboundMessage` here\n 22 | from nanobot.bus.queue import MessageBus\n 23 | from nanobot.providers.base import LLMProvider\n    |\nhelp: Remove definition: `InboundMessage`\n\nF811 [*] Redefinition of unused `InboundMessage` from line 21\n   --> tests/test_agent_loop_with_monitor.py:175:40\n    |\n173 |         import asyncio\n174 |\n175 |         from nanobot.bus.events import InboundMessage\n    |                                        ^^^^^^^^^^^^^^ `InboundMessage` redefined here\n176 |\n177 |         # 配置模拟\n    |\n   ::: tests/test_agent_loop_with_monitor.py:21:32\n    |\n 19 | from nanobot.agent.context_monitor import CompressionEvent, ContextMonitorConfig\n 20 | from nanobot.agent.loop import AgentLoop\n 21 | from nanobot.bus.events import InboundMessage, OutboundMessage\n    |                                -------------- previous definition of `InboundMessage` here\n 22 | from nanobot.bus.queue import MessageBus\n 23 | from nanobot.providers.base import LLMProvider\n    |\nhelp: Remove definition: `InboundMessage`\n\nF821 Undefined name `AsyncMock`\n   --> tests/test_agent_loop_with_monitor.py:190:43\n    |\n188 |         # Mock MainAgent\n189 |         mock_main_agent = MagicMock()\n190 |         mock_main_agent.process_message = AsyncMock(return_value=\"回复内容\")\n    |                                           ^^^^^^^^^\n191 |\n192 |         # 创建一个模拟 session\n    |\n\nF841 Local variable `result` is assigned to but never used\n   --> tests/test_agent_loop_with_monitor.py:201:13\n    |\n200 |         with patch.object(loop, \"get_main_agent\", return_value=mock_main_agent):\n201 |             result = asyncio.run(\n    |             ^^^^^^\n202 |                 loop._process_message(\n203 |                     InboundMessage(\n    |\nhelp: Remove assignment to unused variable `result`\n\nF811 [*] Redefinition of unused `InboundMessage` from line 21\n   --> tests/test_agent_loop_with_monitor.py:300:40\n    |\n298 |     def test_compression_event_recording(self, mock_monitor):\n299 |         \"\"\"测试压缩事件记录\"\"\"\n300 |         from nanobot.bus.events import InboundMessage\n    |                                        ^^^^^^^^^^^^^^ `InboundMessage` redefined here\n301 |\n302 |         mock_monitor.check_threshold.return_value = True\n    |\n   ::: tests/test_agent_loop_with_monitor.py:21:32\n    |\n 19 | from nanobot.agent.context_monitor import CompressionEvent, ContextMonitorConfig\n 20 | from nanobot.agent.loop import AgentLoop\n 21 | from nanobot.bus.events import InboundMessage, OutboundMessage\n    |                                -------------- previous definition of `InboundMessage` here\n 22 | from nanobot.bus.queue import MessageBus\n 23 | from nanobot.providers.base import LLMProvider\n    |\nhelp: Remove definition: `InboundMessage`\n\nF811 [*] Redefinition of unused `InboundMessage` from line 21\n   --> tests/test_agent_loop_with_monitor.py:367:40\n    |\n365 |     def test_stats_after_processing(self, mock_monitor):\n366 |         \"\"\"测试处理消息后的统计信息\"\"\"\n367 |         from nanobot.bus.events import InboundMessage\n    |                                        ^^^^^^^^^^^^^^ `InboundMessage` redefined here\n368 |\n369 |         mock_monitor.get_stats.return_value = {\n    |\n   ::: tests/test_agent_loop_with_monitor.py:21:32\n    |\n 19 | from nanobot.agent.context_monitor import CompressionEvent, ContextMonitorConfig\n 20 | from nanobot.agent.loop import AgentLoop\n 21 | from nanobot.bus.events import InboundMessage, OutboundMessage\n    |                                -------------- previous definition of `InboundMessage` here\n 22 | from nanobot.bus.queue import MessageBus\n 23 | from nanobot.providers.base import LLMProvider\n    |\nhelp: Remove definition: `InboundMessage`\n\nF841 Local variable `r2` is assigned to but never used\n   --> tests/test_concurrent_scheduler.py:211:9\n    |\n209 |         # Acquire all resources\n210 |         r1 = await pool.acquire()\n211 |         r2 = await pool.acquire()\n    |         ^^\n212 |\n213 |         # Try to acquire more (should timeout)\n    |\nhelp: Remove assignment to unused variable `r2`\n\nF401 [*] `nanobot.config.hot_reload.add_config_callback` imported but unused\n  --> tests/test_config_and_shutdown.py:18:5\n   |\n17 | from nanobot.config.hot_reload import (\n18 |     add_config_callback,\n   |     ^^^^^^^^^^^^^^^^^^^\n19 |     get_config_hot_reloader,\n20 |     is_config_watcher_running,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.config.hot_reload.is_config_watcher_running` imported but unused\n  --> tests/test_config_and_shutdown.py:20:5\n   |\n18 |     add_config_callback,\n19 |     get_config_hot_reloader,\n20 |     is_config_watcher_running,\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^\n21 |     reload_config,\n22 |     start_config_watcher,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.config.hot_reload.reload_config` imported but unused\n  --> tests/test_config_and_shutdown.py:21:5\n   |\n19 |     get_config_hot_reloader,\n20 |     is_config_watcher_running,\n21 |     reload_config,\n   |     ^^^^^^^^^^^^^\n22 |     start_config_watcher,\n23 |     stop_config_watcher,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.config.hot_reload.start_config_watcher` imported but unused\n  --> tests/test_config_and_shutdown.py:22:5\n   |\n20 |     is_config_watcher_running,\n21 |     reload_config,\n22 |     start_config_watcher,\n   |     ^^^^^^^^^^^^^^^^^^^^\n23 |     stop_config_watcher,\n24 | )\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.config.hot_reload.stop_config_watcher` imported but unused\n  --> tests/test_config_and_shutdown.py:23:5\n   |\n21 |     reload_config,\n22 |     start_config_watcher,\n23 |     stop_config_watcher,\n   |     ^^^^^^^^^^^^^^^^^^^\n24 | )\n25 | from nanobot.utils.cache import (\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.utils.graceful_shutdown.add_shutdown_hook` imported but unused\n  --> tests/test_config_and_shutdown.py:38:5\n   |\n36 | )\n37 | from nanobot.utils.graceful_shutdown import (\n38 |     add_shutdown_hook,\n   |     ^^^^^^^^^^^^^^^^^\n39 |     get_shutdown_manager,\n40 |     get_shutdown_status,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.utils.graceful_shutdown.get_shutdown_status` imported but unused\n  --> tests/test_config_and_shutdown.py:40:5\n   |\n38 |     add_shutdown_hook,\n39 |     get_shutdown_manager,\n40 |     get_shutdown_status,\n   |     ^^^^^^^^^^^^^^^^^^^\n41 |     is_shutdown_requested,\n42 |     request_shutdown,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.utils.graceful_shutdown.is_shutdown_requested` imported but unused\n  --> tests/test_config_and_shutdown.py:41:5\n   |\n39 |     get_shutdown_manager,\n40 |     get_shutdown_status,\n41 |     is_shutdown_requested,\n   |     ^^^^^^^^^^^^^^^^^^^^^\n42 |     request_shutdown,\n43 |     shutdown,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.utils.graceful_shutdown.request_shutdown` imported but unused\n  --> tests/test_config_and_shutdown.py:42:5\n   |\n40 |     get_shutdown_status,\n41 |     is_shutdown_requested,\n42 |     request_shutdown,\n   |     ^^^^^^^^^^^^^^^^\n43 |     shutdown,\n44 |     wait_for_shutdown,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.utils.graceful_shutdown.shutdown` imported but unused\n  --> tests/test_config_and_shutdown.py:43:5\n   |\n41 |     is_shutdown_requested,\n42 |     request_shutdown,\n43 |     shutdown,\n   |     ^^^^^^^^\n44 |     wait_for_shutdown,\n45 | )\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.utils.graceful_shutdown.wait_for_shutdown` imported but unused\n  --> tests/test_config_and_shutdown.py:44:5\n   |\n42 |     request_shutdown,\n43 |     shutdown,\n44 |     wait_for_shutdown,\n   |     ^^^^^^^^^^^^^^^^^\n45 | )\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Any` imported but unused\n  --> tests/test_context_monitor.py:14:20\n   |\n13 | import unittest\n14 | from typing import Any, Dict, List\n   |                    ^^^\n15 | from unittest.mock import MagicMock, patch\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Dict` imported but unused\n  --> tests/test_context_monitor.py:14:25\n   |\n13 | import unittest\n14 | from typing import Any, Dict, List\n   |                         ^^^^\n15 | from unittest.mock import MagicMock, patch\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.List` imported but unused\n  --> tests/test_context_monitor.py:14:31\n   |\n13 | import unittest\n14 | from typing import Any, Dict, List\n   |                               ^^^^\n15 | from unittest.mock import MagicMock, patch\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.context_monitor.CompressionEvent` imported but unused\n  --> tests/test_context_monitor.py:18:5\n   |\n17 | from nanobot.agent.context_monitor import (\n18 |     CompressionEvent,\n   |     ^^^^^^^^^^^^^^^^\n19 |     ContextMonitor,\n20 |     ContextMonitorConfig,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.context_monitor.TokenLimits` imported but unused\n  --> tests/test_context_monitor.py:22:5\n   |\n20 |     ContextMonitorConfig,\n21 |     ModelType,\n22 |     TokenLimits,\n   |     ^^^^^^^^^^^\n23 | )\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.cron_system.JobConfig` imported but unused\n  --> tests/test_cron_system.py:14:5\n   |\n12 | from nanobot.agent.cron_system import (\n13 |     CronSystem,\n14 |     JobConfig,\n   |     ^^^^^^^^^\n15 |     JobType,\n16 |     add_cron_job,\n   |\nhelp: Remove unused import: `nanobot.agent.cron_system.JobConfig`\n\nF841 Local variable `job1` is assigned to but never used\n   --> tests/test_cron_system.py:175:9\n    |\n174 |         # 添加 3 个任务\n175 |         job1 = add_interval_job(self.cron, \"job1\", test_task, 60)\n    |         ^^^^\n176 |         job2 = add_interval_job(self.cron, \"job2\", test_task, 60)\n177 |         job3 = add_interval_job(self.cron, \"job3\", test_task, 60)\n    |\nhelp: Remove assignment to unused variable `job1`\n\nF841 Local variable `job2` is assigned to but never used\n   --> tests/test_cron_system.py:176:9\n    |\n174 |         # 添加 3 个任务\n175 |         job1 = add_interval_job(self.cron, \"job1\", test_task, 60)\n176 |         job2 = add_interval_job(self.cron, \"job2\", test_task, 60)\n    |         ^^^^\n177 |         job3 = add_interval_job(self.cron, \"job3\", test_task, 60)\n    |\nhelp: Remove assignment to unused variable `job2`\n\nF541 [*] f-string without any placeholders\n   --> tests/test_enhanced_architecture.py:134:11\n    |\n132 |     print(f\"  决策消息: {result.message}\")\n133 |     print(f\"  Subagent 任务: {result.data.get('subagent_task')}\")\n134 |     print(f\"  Subagent 配置:\")\n    |           ^^^^^^^^^^^^^^^^^^^\n135 |     config = result.data.get(\"subagent_config\", {})\n136 |     print(f\"    - agent_type: {config.get('agent_type')}\")\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> tests/test_enhanced_architecture.py:145:11\n    |\n143 |     result = await decision_handler.handle_request(request)\n144 |     print(f\"  决策动作: {result.action}\")\n145 |     print(f\"  Subagent 配置:\")\n    |           ^^^^^^^^^^^^^^^^^^^\n146 |     config = result.data.get(\"subagent_config\", {})\n147 |     print(f\"    - agent_type: {config.get('agent_type')}\")\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> tests/test_enhanced_architecture.py:156:11\n    |\n154 |     result = await decision_handler.handle_request(request)\n155 |     print(f\"  决策动作: {result.action}\")\n156 |     print(f\"  Subagent 配置:\")\n    |           ^^^^^^^^^^^^^^^^^^^\n157 |     config = result.data.get(\"subagent_config\", {})\n158 |     print(f\"    - agent_type: {config.get('agent_type')}\")\n    |\nhelp: Remove extraneous `f` prefix\n\nF841 Local variable `request` is assigned to but never used\n   --> tests/test_enhanced_architecture.py:204:5\n    |\n202 |     from nanobot.agent.decision.models import DecisionRequest\n203 |\n204 |     request = DecisionRequest(\n    |     ^^^^^^^\n205 |         request_type=\"skill_decision\",\n206 |         data={\n    |\nhelp: Remove assignment to unused variable `request`\n\nF401 [*] `nanobot.agent.decision.models.DecisionResult` imported but unused\n   --> tests/test_enhanced_architecture.py:276:47\n    |\n274 |     print(\"=\" * 60)\n275 |\n276 |     from nanobot.agent.decision.models import DecisionResult\n    |                                               ^^^^^^^^^^^^^^\n277 |     from nanobot.agent.enhanced_main_agent import EnhancedMainAgent\n278 |     from nanobot.agent.subagent.models import SubagentTask\n    |\nhelp: Remove unused import: `nanobot.agent.decision.models.DecisionResult`\n\nF541 [*] f-string without any placeholders\n   --> tests/test_enhanced_architecture.py:306:15\n    |\n304 |             skills=subagent_config.get(\"skills\"),  # 🔥 技能信息被传递\n305 |         )\n306 |         print(f\"  ✅ SubagentTask 已创建\")\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n307 |         print(f\"     - task_id: {task.task_id}\")\n308 |         print(f\"     - agent_type: {task.agent_type}\")\n    |\nhelp: Remove extraneous `f` prefix\n\nF541 [*] f-string without any placeholders\n   --> tests/test_enhanced_architecture.py:345:15\n    |\n343 |         system_prompt = \"\".join(system_prompt_parts)\n344 |         print(f\"  系统提示长度: {len(system_prompt)} 字符\")\n345 |         print(f\"  系统提示预览 (前 300 字符):\")\n    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n346 |         print(f\"  {'-' * 60}\")\n347 |         print(f\"  {system_prompt[:300]}...\")\n    |\nhelp: Remove extraneous `f` prefix\n\nF401 [*] `nanobot.agents.event_bus.EventListener` imported but unused\n  --> tests/test_event_bus.py:10:5\n   |\n 8 |     Event,\n 9 |     EventBus,\n10 |     EventListener,\n   |     ^^^^^^^^^^^^^\n11 |     EventType,\n12 |     ServiceCommunicator,\n   |\nhelp: Remove unused import: `nanobot.agents.event_bus.EventListener`\n\nF841 Local variable `listener_id` is assigned to but never used\n  --> tests/test_event_bus.py:42:9\n   |\n41 |         # Subscribe\n42 |         listener_id = await bus.subscribe(EventType.TASK_COMPLETED, event_handler)\n   |         ^^^^^^^^^^^\n43 |\n44 |         # Publish event\n   |\nhelp: Remove assignment to unused variable `listener_id`\n\nF401 [*] `typing.Any` imported but unused\n  --> tests/test_intent_recognition.py:8:20\n   |\n 7 | import logging\n 8 | from typing import Any, Dict\n   |                    ^^^\n 9 |\n10 | import pytest\n   |\nhelp: Remove unused import\n\nF401 [*] `typing.Dict` imported but unused\n  --> tests/test_intent_recognition.py:8:25\n   |\n 7 | import logging\n 8 | from typing import Any, Dict\n   |                         ^^^^\n 9 |\n10 | import pytest\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.intent.MatchType` imported but unused\n  --> tests/test_intent_recognition.py:17:5\n   |\n15 |     LLMProvider,\n16 |     LLMRecognizer,\n17 |     MatchType,\n   |     ^^^^^^^^^\n18 |     MockLLMClient,\n19 |     RecognizerType,\n   |\nhelp: Remove unused import: `nanobot.agent.intent.MatchType`\n\nE712 Avoid equality comparisons to `False`; use `not status[\"is_processing\"]:` for false checks\n   --> tests/test_main_agent_handle_methods.py:147:12\n    |\n145 |     assert status[\"subagent_count\"] == 1\n146 |     assert len(status[\"subagent_results\"]) == 1\n147 |     assert status[\"is_processing\"] == False\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n148 |     assert status[\"running_count\"] == 1\n    |\nhelp: Replace with `not status[\"is_processing\"]`\n\nF401 [*] `pathlib.Path` imported but unused\n --> tests/test_mcp_tool.py:3:21\n  |\n1 | \"\"\"Tests for MCP tool.\"\"\"\n2 |\n3 | from pathlib import Path\n  |                     ^^^^\n4 | from unittest.mock import Mock, patch\n  |\nhelp: Remove unused import: `pathlib.Path`\n\nF401 [*] `datetime.datetime` imported but unused\n  --> tests/test_message_bus.py:12:22\n   |\n11 | import asyncio\n12 | from datetime import datetime\n   |                      ^^^^^^^^\n13 |\n14 | import pytest\n   |\nhelp: Remove unused import: `datetime.datetime`\n\nF401 [*] `nanobot.agent.message_bus.RedisBackend` imported but unused\n  --> tests/test_message_bus.py:16:66\n   |\n14 | import pytest\n15 |\n16 | from nanobot.agent.message_bus import MemoryBackend, MessageBus, RedisBackend\n   |                                                                  ^^^^^^^^^^^^\n17 | from nanobot.agent.message_schemas import (\n18 |     ControlMessage,\n   |\nhelp: Remove unused import: `nanobot.agent.message_bus.RedisBackend`\n\nF401 [*] `nanobot.agent.message_schemas.ControlMessage` imported but unused\n  --> tests/test_message_bus.py:18:5\n   |\n16 | from nanobot.agent.message_bus import MemoryBackend, MessageBus, RedisBackend\n17 | from nanobot.agent.message_schemas import (\n18 |     ControlMessage,\n   |     ^^^^^^^^^^^^^^\n19 |     MessageType,\n20 |     StatusUpdateMessage,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.message_schemas.StatusUpdateMessage` imported but unused\n  --> tests/test_message_bus.py:20:5\n   |\n18 |     ControlMessage,\n19 |     MessageType,\n20 |     StatusUpdateMessage,\n   |     ^^^^^^^^^^^^^^^^^^^\n21 |     TaskResultMessage,\n22 | )\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.message_schemas.TaskResultMessage` imported but unused\n  --> tests/test_message_bus.py:21:5\n   |\n19 |     MessageType,\n20 |     StatusUpdateMessage,\n21 |     TaskResultMessage,\n   |     ^^^^^^^^^^^^^^^^^\n22 | )\n   |\nhelp: Remove unused import\n\nF401 [*] `tempfile` imported but unused\n  --> tests/test_monitor.py:10:8\n   |\n 8 | import os\n 9 | import sys\n10 | import tempfile\n   |        ^^^^^^^^\n11 |\n12 | import pytest\n   |\nhelp: Remove unused import: `tempfile`\n\nF401 [*] `nanobot.monitor.alert_manager.Alert` imported but unused\n  --> tests/test_monitor.py:17:5\n   |\n16 | from nanobot.monitor.alert_manager import (\n17 |     Alert,\n   |     ^^^^^\n18 |     AlertManager,\n19 |     AlertRule,\n   |\nhelp: Remove unused import: `nanobot.monitor.alert_manager.Alert`\n\nF401 [*] `nanobot.agent.monitoring.metrics_collector.ContextMetrics` imported but unused\n  --> tests/test_monitoring.py:16:5\n   |\n14 | from nanobot.agent.monitoring.logger import StructuredLogger\n15 | from nanobot.agent.monitoring.metrics_collector import (\n16 |     ContextMetrics,\n   |     ^^^^^^^^^^^^^^\n17 |     LLMCallMetrics,\n18 |     MetricsCollector,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.monitoring.metrics_collector.LLMCallMetrics` imported but unused\n  --> tests/test_monitoring.py:17:5\n   |\n15 | from nanobot.agent.monitoring.metrics_collector import (\n16 |     ContextMetrics,\n17 |     LLMCallMetrics,\n   |     ^^^^^^^^^^^^^^\n18 |     MetricsCollector,\n19 |     ToolUseMetrics,\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.monitoring.metrics_collector.ToolUseMetrics` imported but unused\n  --> tests/test_monitoring.py:19:5\n   |\n17 |     LLMCallMetrics,\n18 |     MetricsCollector,\n19 |     ToolUseMetrics,\n   |     ^^^^^^^^^^^^^^\n20 | )\n21 | from nanobot.agent.monitoring.state_tracker import (\n   |\nhelp: Remove unused import\n\nF401 [*] `pathlib.Path` imported but unused\n  --> tests/test_prompt_builder.py:12:21\n   |\n10 | \"\"\"\n11 |\n12 | from pathlib import Path\n   |                     ^^^^\n13 |\n14 | import pytest\n   |\nhelp: Remove unused import: `pathlib.Path`\n\nF401 [*] `nanobot.agents.subagent_manager.SubagentTask` imported but unused\n  --> tests/test_subagent_manager.py:10:5\n   |\n 8 |     SubagentManager,\n 9 |     SubagentStatus,\n10 |     SubagentTask,\n   |     ^^^^^^^^^^^^\n11 | )\n   |\nhelp: Remove unused import: `nanobot.agents.subagent_manager.SubagentTask`\n\nF401 [*] `nanobot.agents.subagent_manager.SubagentStatus` imported but unused\n  --> tests/test_subagent_manager_advanced.py:9:5\n   |\n 7 | from nanobot.agents.subagent_manager import (\n 8 |     SubagentManager,\n 9 |     SubagentStatus,\n   |     ^^^^^^^^^^^^^^\n10 |     SubagentTask,\n11 | )\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agents.subagent_manager.SubagentTask` imported but unused\n  --> tests/test_subagent_manager_advanced.py:10:5\n   |\n 8 |     SubagentManager,\n 9 |     SubagentStatus,\n10 |     SubagentTask,\n   |     ^^^^^^^^^^^^\n11 | )\n   |\nhelp: Remove unused import\n\nF401 [*] `asyncio` imported but unused\n --> tests/test_subagent_manager_enhanced.py:8:8\n  |\n6 | \"\"\"\n7 |\n8 | import asyncio\n  |        ^^^^^^^\n9 | from datetime import datetime, timedelta\n  |\nhelp: Remove unused import: `asyncio`\n\nF401 [*] `nanobot.agent.subagent.models.SubagentState` imported but unused\n  --> tests/test_subagent_manager_enhanced.py:14:43\n   |\n13 | from nanobot.agent.subagent.manager import SubagentManager\n14 | from nanobot.agent.subagent.models import SubagentState, SubagentStatus, SubagentTask\n   |                                           ^^^^^^^^^^^^^\n15 | from nanobot.agent.task import TaskStatus\n16 | from nanobot.agent.task_manager import TaskManager\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.subagent.models.SubagentTask` imported but unused\n  --> tests/test_subagent_manager_enhanced.py:14:74\n   |\n13 | from nanobot.agent.subagent.manager import SubagentManager\n14 | from nanobot.agent.subagent.models import SubagentState, SubagentStatus, SubagentTask\n   |                                                                          ^^^^^^^^^^^^\n15 | from nanobot.agent.task import TaskStatus\n16 | from nanobot.agent.task_manager import TaskManager\n   |\nhelp: Remove unused import\n\nF401 [*] `nanobot.agent.task.TaskStatus` imported but unused\n  --> tests/test_subagent_manager_enhanced.py:15:32\n   |\n13 | from nanobot.agent.subagent.manager import SubagentManager\n14 | from nanobot.agent.subagent.models import SubagentState, SubagentStatus, SubagentTask\n15 | from nanobot.agent.task import TaskStatus\n   |                                ^^^^^^^^^^\n16 | from nanobot.agent.task_manager import TaskManager\n   |\nhelp: Remove unused import: `nanobot.agent.task.TaskStatus`\n\nF841 Local variable `task_id2` is assigned to but never used\n   --> tests/test_subagent_manager_enhanced.py:199:9\n    |\n197 |         # 创建任务\n198 |         task_id1 = manager.create_subagent(\"任务1\")\n199 |         task_id2 = manager.create_subagent(\"任务2\")\n    |         ^^^^^^^^\n200 |\n201 |         # 标记任务1为完成\n    |\nhelp: Remove assignment to unused variable `task_id2`\n\nF401 [*] `json` imported but unused\n  --> tests/test_task_manager.py:10:8\n   |\n 8 | \"\"\"\n 9 |\n10 | import json\n   |        ^^^^\n11 | import os\n12 | import unittest\n   |\nhelp: Remove unused import: `json`\n\nF401 [*] `datetime.datetime` imported but unused\n  --> tests/test_task_manager.py:13:22\n   |\n11 | import os\n12 | import unittest\n13 | from datetime import datetime, timedelta\n   |                      ^^^^^^^^\n14 |\n15 | from nanobot.agent.task_manager import Task, TaskManager\n   |\nhelp: Remove unused import\n\nF401 [*] `datetime.timedelta` imported but unused\n  --> tests/test_task_manager.py:13:32\n   |\n11 | import os\n12 | import unittest\n13 | from datetime import datetime, timedelta\n   |                                ^^^^^^^^^\n14 |\n15 | from nanobot.agent.task_manager import Task, TaskManager\n   |\nhelp: Remove unused import\n\nF401 [*] `unittest.mock.MagicMock` imported but unused\n --> tests/test_ui_widgets.py:5:27\n  |\n3 | import time\n4 | import unittest\n5 | from unittest.mock import MagicMock, patch\n  |                           ^^^^^^^^^\n6 |\n7 | import pytest\n  |\nhelp: Remove unused import: `unittest.mock.MagicMock`\n\nF401 [*] `pytest` imported but unused\n --> tests/test_ui_widgets.py:7:8\n  |\n5 | from unittest.mock import MagicMock, patch\n6 |\n7 | import pytest\n  |        ^^^^^^\n8 | from rich.console import Console\n9 | from rich.panel import Panel\n  |\nhelp: Remove unused import: `pytest`\n\nF841 Local variable `task2` is assigned to but never used\n   --> tests/test_ui_widgets.py:225:9\n    |\n223 |         \"\"\"测试获取运行中的任务.\"\"\"\n224 |         task1 = self.manager.create_task(name=\"Task 1\")\n225 |         task2 = self.manager.create_task(name=\"Task 2\")\n    |         ^^^^^\n226 |\n227 |         self.manager.start_task(task1.id)\n    |\nhelp: Remove assignment to unused variable `task2`\n\nF401 [*] `nanobot.agent.message_analyzer.AnalysisResult` imported but unused\n  --> tests/test_workflow_message_router.py:10:44\n   |\n 8 | import unittest\n 9 |\n10 | from nanobot.agent.message_analyzer import AnalysisResult, MessageAnalyzer\n   |                                            ^^^^^^^^^^^^^^\n11 | from nanobot.agent.message_router import MessageRouter, RouteMatchType, RouteRule\n   |\nhelp: Remove unused import: `nanobot.agent.message_analyzer.AnalysisResult`\n\nFound 358 errors.\n[*] 193 fixable with the `--fix` option (20 hidden fixes can be enabled with the `--unsafe-fixes` option).\n\n=== 静态类型检查 ===\nnanobot/agent/subagent/enhanced_agno_subagent.py:148: error: Invalid syntax. Perhaps you forgot a comma?  [syntax]\nFound 1 error in 1 file (errors prevented further checking)\n\n=== 代码复杂度分析 ===\n************* Module nanobot.agent._handle_tool_calls_template\nnanobot/agent/_handle_tool_calls_template.py:7:15: E0001: Parsing failed: 'unterminated string literal (detected at line 7) (nanobot.agent._handle_tool_calls_template, line 7)' (syntax-error)\n************* Module nanobot.agent.subagent.enhanced_agno_subagent\nnanobot/agent/subagent/enhanced_agno_subagent.py:148:17: E0001: Parsing failed: 'invalid syntax. Perhaps you forgot a comma? (nanobot.agent.subagent.enhanced_agno_subagent, line 148)' (syntax-error)\n************* Module nanobot.ui.formatters\nnanobot/ui/formatters.py:332:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/ui/formatters.py:266:0: R0903: Too few public methods (1/2) (too-few-public-methods)\nnanobot/ui/formatters.py:403:4: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/ui/formatters.py:11:0: W0611: Unused Panel imported from rich.panel (unused-import)\nnanobot/ui/formatters.py:12:0: W0611: Unused Style imported from rich.style (unused-import)\n************* Module nanobot.ui.progress_manager\nnanobot/ui/progress_manager.py:28:0: R0902: Too many instance attributes (9/7) (too-many-instance-attributes)\nnanobot/ui/progress_manager.py:96:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/ui/progress_manager.py:96:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/ui/progress_manager.py:155:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/ui/progress_manager.py:155:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/ui/progress_manager.py:7:0: W0611: Unused Set imported from typing (unused-import)\n************* Module nanobot.ui.widgets\nnanobot/ui/widgets.py:30:0: R0902: Too many instance attributes (8/7) (too-many-instance-attributes)\nnanobot/ui/widgets.py:90:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/ui/widgets.py:90:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/ui/widgets.py:166:8: C0415: Import outside toplevel (uuid) (import-outside-toplevel)\nnanobot/ui/widgets.py:181:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/ui/widgets.py:181:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/ui/widgets.py:246:0: R0902: Too many instance attributes (8/7) (too-many-instance-attributes)\nnanobot/ui/widgets.py:249:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/ui/widgets.py:249:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/ui/widgets.py:345:12: C0104: Disallowed name \"bar\" (disallowed-name)\nnanobot/ui/widgets.py:352:12: C0104: Disallowed name \"bar\" (disallowed-name)\nnanobot/ui/widgets.py:362:12: C0104: Disallowed name \"bar\" (disallowed-name)\nnanobot/ui/widgets.py:398:14: W0613: Unused argument 'console' (unused-argument)\nnanobot/ui/widgets.py:398:32: W0613: Unused argument 'options' (unused-argument)\nnanobot/ui/widgets.py:7:0: W0611: Unused Tuple imported from typing (unused-import)\nnanobot/ui/widgets.py:10:0: W0611: Unused box imported from rich (unused-import)\nnanobot/ui/widgets.py:12:0: W0611: Unused Layout imported from rich.layout (unused-import)\nnanobot/ui/widgets.py:24:0: W0611: Unused Spinner imported from rich.spinner (unused-import)\nnanobot/ui/widgets.py:26:0: W0611: Unused Text imported from rich.text (unused-import)\n************* Module nanobot.config.loader\nnanobot/config/loader.py:19:4: C0415: Import outside toplevel (nanobot.utils.helpers.get_data_path) (import-outside-toplevel)\nnanobot/config/loader.py:46:15: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.config.hot_reload\nnanobot/config/hot_reload.py:88:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/config/hot_reload.py:84:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/config/hot_reload.py:135:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/config/hot_reload.py:185:0: C0103: Constant name \"_hot_reloader_instance\" doesn't conform to UPPER_CASE naming style (invalid-name)\nnanobot/config/hot_reload.py:198:4: W0603: Using the global statement (global-statement)\nnanobot/config/hot_reload.py:222:4: W0602: Using global for '_hot_reloader_instance' but no assignment is done (global-variable-not-assigned)\nnanobot/config/hot_reload.py:227:0: R1710: Either all return statements in a function should return an expression, or none of them should. (inconsistent-return-statements)\n************* Module nanobot.config.schema\nnanobot/config/schema.py:360:0: C0301: Line too long (132/100) (line-too-long)\nnanobot/config/schema.py:220:12: C0415: Import outside toplevel (yaml) (import-outside-toplevel)\nnanobot/config/schema.py:222:17: W1514: Using open without explicitly specifying an encoding (unspecified-encoding)\nnanobot/config/schema.py:231:4: R0912: Too many branches (20/12) (too-many-branches)\nnanobot/config/schema.py:302:20: E1101: Instance of 'FieldInfo' has no 'defaults' member; maybe 'default'? (no-member)\nnanobot/config/schema.py:306:15: E1101: Instance of 'FieldInfo' has no 'enabled' member (no-member)\nnanobot/config/schema.py:308:15: E1101: Instance of 'FieldInfo' has no 'skills' member (no-member)\nnanobot/config/schema.py:312:26: E1101: Instance of 'FieldInfo' has no 'skills' member (no-member)\nnanobot/config/schema.py:313:22: E1101: Instance of 'FieldInfo' has no 'skills' member (no-member)\nnanobot/config/schema.py:318:15: E1101: Instance of 'FieldInfo' has no 'enabled' member (no-member)\nnanobot/config/schema.py:320:15: E1101: Instance of 'FieldInfo' has no 'commands' member (no-member)\nnanobot/config/schema.py:324:26: E1101: Instance of 'FieldInfo' has no 'commands' member (no-member)\nnanobot/config/schema.py:325:24: E1101: Instance of 'FieldInfo' has no 'commands' member (no-member)\nnanobot/config/schema.py:330:15: E1101: Instance of 'FieldInfo' has no 'enabled' member (no-member)\nnanobot/config/schema.py:332:15: E1101: Instance of 'FieldInfo' has no 'agents' member (no-member)\nnanobot/config/schema.py:336:26: E1101: Instance of 'FieldInfo' has no 'agents' member (no-member)\nnanobot/config/schema.py:337:22: E1101: Instance of 'FieldInfo' has no 'agents' member (no-member)\nnanobot/config/schema.py:342:15: E1101: Instance of 'FieldInfo' has no 'enabled' member (no-member)\nnanobot/config/schema.py:344:15: E1101: Instance of 'FieldInfo' has no 'mcp_servers' member (no-member)\nnanobot/config/schema.py:355:30: E1101: Instance of 'FieldInfo' has no 'mcp_servers' member (no-member)\nnanobot/config/schema.py:362:12: E1101: Instance of 'FieldInfo' has no 'openrouter' member (no-member)\nnanobot/config/schema.py:363:15: E1101: Instance of 'FieldInfo' has no 'deepseek' member (no-member)\nnanobot/config/schema.py:364:15: E1101: Instance of 'FieldInfo' has no 'anthropic' member (no-member)\nnanobot/config/schema.py:365:15: E1101: Instance of 'FieldInfo' has no 'openai' member (no-member)\nnanobot/config/schema.py:366:15: E1101: Instance of 'FieldInfo' has no 'gemini' member (no-member)\nnanobot/config/schema.py:367:15: E1101: Instance of 'FieldInfo' has no 'zhipu' member (no-member)\nnanobot/config/schema.py:368:15: E1101: Instance of 'FieldInfo' has no 'groq' member (no-member)\nnanobot/config/schema.py:369:15: E1101: Instance of 'FieldInfo' has no 'vllm' member (no-member)\nnanobot/config/schema.py:370:15: E1101: Instance of 'FieldInfo' has no 'volcengine' member (no-member)\nnanobot/config/schema.py:376:11: E1101: Instance of 'FieldInfo' has no 'openrouter' member (no-member)\nnanobot/config/schema.py:377:19: E1101: Instance of 'FieldInfo' has no 'openrouter' member (no-member)\nnanobot/config/schema.py:378:11: E1101: Instance of 'FieldInfo' has no 'zhipu' member (no-member)\nnanobot/config/schema.py:379:19: E1101: Instance of 'FieldInfo' has no 'zhipu' member (no-member)\nnanobot/config/schema.py:380:11: E1101: Instance of 'FieldInfo' has no 'vllm' member (no-member)\nnanobot/config/schema.py:381:19: E1101: Instance of 'FieldInfo' has no 'vllm' member (no-member)\nnanobot/config/schema.py:382:11: E1101: Instance of 'FieldInfo' has no 'volcengine' member (no-member)\nnanobot/config/schema.py:383:19: E1101: Instance of 'FieldInfo' has no 'volcengine' member (no-member)\nnanobot/config/schema.py:386:4: C0115: Missing class docstring (missing-class-docstring)\nnanobot/config/schema.py:386:4: R0903: Too few public methods (0/2) (too-few-public-methods)\n************* Module nanobot.providers.transcription\nnanobot/providers/transcription.py:59:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/providers/transcription.py:10:0: R0903: Too few public methods (1/2) (too-few-public-methods)\n************* Module nanobot.providers.litellm_provider\nnanobot/providers/litellm_provider.py:73:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/providers/litellm_provider.py:73:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/providers/litellm_provider.py:141:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/providers/litellm_provider.py:159:20: C0415: Import outside toplevel (json) (import-outside-toplevel)\n************* Module nanobot.providers.base\nnanobot/providers/base.py:45:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/providers/base.py:45:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/providers/base.py:66:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/providers/base.py:71:8: W0107: Unnecessary pass statement (unnecessary-pass)\n************* Module nanobot.bus.queue\nnanobot/bus/queue.py:69:27: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.bus.message_analyzer\nnanobot/bus/message_analyzer.py:68:27: E1101: Instance of 'TaskManager' has no 'get_active_tasks' member (no-member)\nnanobot/bus/message_analyzer.py:99:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/bus/message_analyzer.py:110:12: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/bus/message_analyzer.py:229:23: E1101: Instance of 'TaskManager' has no 'get_active_tasks' member (no-member)\n************* Module nanobot.agents.agno_subagent\nnanobot/agents/agno_subagent.py:366:9: W0511: TODO: 实现知识库集成 (fixme)\nnanobot/agents/agno_subagent.py:476:13: W0511: TODO: 实现实际的父 Agent 通信 (fixme)\nnanobot/agents/agno_subagent.py:120:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_subagent.py:133:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_subagent.py:130:19: E1120: No value for argument 'task_description' in method call (no-value-for-parameter)\nnanobot/agents/agno_subagent.py:253:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_subagent.py:317:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_subagent.py:260:12: C0415: Import outside toplevel (nanobot.agent.tools.web.WebFetchTool, nanobot.agent.tools.web.WebSearchTool) (import-outside-toplevel)\nnanobot/agents/agno_subagent.py:270:20: W0621: Redefining name 'asyncio' from outer scope (line 13) (redefined-outer-name)\nnanobot/agents/agno_subagent.py:275:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_subagent.py:270:20: W0404: Reimport 'asyncio' (imported line 13) (reimported)\nnanobot/agents/agno_subagent.py:270:20: C0415: Import outside toplevel (asyncio) (import-outside-toplevel)\nnanobot/agents/agno_subagent.py:293:20: W0621: Redefining name 'asyncio' from outer scope (line 13) (redefined-outer-name)\nnanobot/agents/agno_subagent.py:300:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_subagent.py:293:20: W0404: Reimport 'asyncio' (imported line 13) (reimported)\nnanobot/agents/agno_subagent.py:293:20: C0415: Import outside toplevel (asyncio) (import-outside-toplevel)\nnanobot/agents/agno_subagent.py:360:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_subagent.py:329:16: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agents/agno_subagent.py:346:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_subagent.py:332:29: W1510: 'subprocess.run' used without explicitly defining the value for 'check'. (subprocess-run-check)\nnanobot/agents/agno_subagent.py:340:20: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agents/agno_subagent.py:532:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agents/agno_subagent.py:532:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agents/agno_subagent.py:14:0: W0611: Unused import logging (unused-import)\nnanobot/agents/agno_subagent.py:16:0: W0611: Unused Awaitable imported from typing (unused-import)\nnanobot/agents/agno_subagent.py:43:4: W0611: Unused NanobotConfig imported from nanobot.config.schema (unused-import)\n************* Module nanobot.agents.concurrent_scheduler\nnanobot/agents/concurrent_scheduler.py:235:0: C0301: Line too long (121/100) (line-too-long)\nnanobot/agents/concurrent_scheduler.py:258:0: C0301: Line too long (121/100) (line-too-long)\nnanobot/agents/concurrent_scheduler.py:24:0: R0902: Too many instance attributes (10/7) (too-many-instance-attributes)\nnanobot/agents/concurrent_scheduler.py:45:0: R0902: Too many instance attributes (12/7) (too-many-instance-attributes)\nnanobot/agents/concurrent_scheduler.py:121:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agents/concurrent_scheduler.py:184:12: W0707: Consider explicitly re-raising using 'except Exception as exc' and 'raise TimeoutError(f'Wait timeout for task: {task_id}') from exc' (raise-missing-from)\nnanobot/agents/concurrent_scheduler.py:281:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/concurrent_scheduler.py:250:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/concurrent_scheduler.py:192:4: R0915: Too many statements (53/50) (too-many-statements)\nnanobot/agents/concurrent_scheduler.py:402:12: W0707: Consider explicitly re-raising using 'except Exception as exc' and 'raise TimeoutError(f'Failed to acquire resource within {self.acquire_timeout}s') from exc' (raise-missing-from)\n************* Module nanobot.agents.agno_main_agent\nnanobot/agents/agno_main_agent.py:310:9: W0511: TODO: 实现知识库集成 (fixme)\nnanobot/agents/agno_main_agent.py:115:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_main_agent.py:126:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_main_agent.py:125:19: E1101: Instance of 'PromptSystemV2' has no 'get_prompt' member (no-member)\nnanobot/agents/agno_main_agent.py:199:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_main_agent.py:263:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_main_agent.py:206:12: C0415: Import outside toplevel (nanobot.agent.tools.web.WebFetchTool, nanobot.agent.tools.web.WebSearchTool) (import-outside-toplevel)\nnanobot/agents/agno_main_agent.py:216:20: W0621: Redefining name 'asyncio' from outer scope (line 13) (redefined-outer-name)\nnanobot/agents/agno_main_agent.py:221:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_main_agent.py:216:20: W0404: Reimport 'asyncio' (imported line 13) (reimported)\nnanobot/agents/agno_main_agent.py:216:20: C0415: Import outside toplevel (asyncio) (import-outside-toplevel)\nnanobot/agents/agno_main_agent.py:239:20: W0621: Redefining name 'asyncio' from outer scope (line 13) (redefined-outer-name)\nnanobot/agents/agno_main_agent.py:246:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_main_agent.py:239:20: W0404: Reimport 'asyncio' (imported line 13) (reimported)\nnanobot/agents/agno_main_agent.py:239:20: C0415: Import outside toplevel (asyncio) (import-outside-toplevel)\nnanobot/agents/agno_main_agent.py:304:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_main_agent.py:275:16: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agents/agno_main_agent.py:292:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/agno_main_agent.py:278:29: W1510: 'subprocess.run' used without explicitly defining the value for 'check'. (subprocess-run-check)\nnanobot/agents/agno_main_agent.py:286:20: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agents/agno_main_agent.py:13:0: W0611: Unused import asyncio (unused-import)\nnanobot/agents/agno_main_agent.py:14:0: W0611: Unused import logging (unused-import)\nnanobot/agents/agno_main_agent.py:43:4: W0611: Unused NanobotConfig imported from nanobot.config.schema (unused-import)\n************* Module nanobot.agents.event_bus\nnanobot/agents/event_bus.py:95:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/event_bus.py:55:0: R0903: Too few public methods (1/2) (too-few-public-methods)\nnanobot/agents/event_bus.py:408:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/event_bus.py:8:0: W0611: Unused Set imported from typing (unused-import)\n************* Module nanobot.agents.error_recovery\nnanobot/agents/error_recovery.py:254:0: C0301: Line too long (103/100) (line-too-long)\nnanobot/agents/error_recovery.py:89:8: W0612: Unused variable 'e' (unused-variable)\nnanobot/agents/error_recovery.py:180:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agents/error_recovery.py:180:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agents/error_recovery.py:234:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/error_recovery.py:271:12: C0415: Import outside toplevel (random) (import-outside-toplevel)\nnanobot/agents/error_recovery.py:169:0: R0903: Too few public methods (1/2) (too-few-public-methods)\nnanobot/agents/error_recovery.py:342:12: W0707: Consider explicitly re-raising using 'except Exception as exc' and 'raise TimeoutError(f'Function {func.__name__} timed out after {timeout}s') from exc' (raise-missing-from)\nnanobot/agents/error_recovery.py:278:0: R0903: Too few public methods (1/2) (too-few-public-methods)\nnanobot/agents/error_recovery.py:440:19: C3001: Lambda expression assigned to a variable. Define a function using the \"def\" keyword instead. (unnecessary-lambda-assignment)\nnanobot/agents/error_recovery.py:445:19: C3001: Lambda expression assigned to a variable. Define a function using the \"def\" keyword instead. (unnecessary-lambda-assignment)\nnanobot/agents/error_recovery.py:448:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agents/error_recovery.py:453:12: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\n************* Module nanobot.agents.subagent_manager\nnanobot/agents/subagent_manager.py:26:0: R0902: Too many instance attributes (11/7) (too-many-instance-attributes)\nnanobot/agents/subagent_manager.py:42:0: R0902: Too many instance attributes (14/7) (too-many-instance-attributes)\nnanobot/agents/subagent_manager.py:54:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agents/subagent_manager.py:54:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agents/subagent_manager.py:317:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/subagent_manager.py:303:27: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/subagent_manager.py:359:33: W0212: Access to a protected member _value of a client class (protected-access)\nnanobot/agents/subagent_manager.py:422:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agents/subagent_manager.py:6:0: W0611: Unused import traceback (unused-import)\n************* Module nanobot.utils.graceful_shutdown\nnanobot/utils/graceful_shutdown.py:51:34: W0613: Unused argument 'frame' (unused-argument)\nnanobot/utils/graceful_shutdown.py:117:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/graceful_shutdown.py:188:0: C0103: Constant name \"_shutdown_manager_instance\" doesn't conform to UPPER_CASE naming style (invalid-name)\nnanobot/utils/graceful_shutdown.py:198:4: W0603: Using the global statement (global-statement)\nnanobot/utils/graceful_shutdown.py:15:0: W0611: Unused import os (unused-import)\nnanobot/utils/graceful_shutdown.py:17:0: W0611: Unused import sys (unused-import)\n************* Module nanobot.utils.cache\nnanobot/utils/cache.py:94:23: W0621: Redefining name 'logger' from outer scope (line 20) (redefined-outer-name)\nnanobot/utils/cache.py:229:8: W0621: Redefining name 'logger' from outer scope (line 20) (redefined-outer-name)\nnanobot/utils/cache.py:394:8: W0621: Redefining name 'logger' from outer scope (line 20) (redefined-outer-name)\nnanobot/utils/cache.py:441:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:431:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:435:27: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:455:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:477:27: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:505:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:532:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:554:27: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:569:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:613:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/cache.py:628:0: C0103: Constant name \"_memory_cache_instance\" doesn't conform to UPPER_CASE naming style (invalid-name)\nnanobot/utils/cache.py:629:0: C0103: Constant name \"_file_cache_instance\" doesn't conform to UPPER_CASE naming style (invalid-name)\nnanobot/utils/cache.py:639:4: W0603: Using the global statement (global-statement)\nnanobot/utils/cache.py:652:4: W0603: Using the global statement (global-statement)\nnanobot/utils/cache.py:18:0: W0611: Unused Callable imported from typing (unused-import)\nnanobot/utils/cache.py:18:0: W0611: Unused Type imported from typing (unused-import)\n************* Module nanobot.utils.workspace_resolver\nnanobot/utils/workspace_resolver.py:23:4: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/utils/workspace_resolver.py:39:11: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/utils/workspace_resolver.py:31:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/utils/workspace_resolver.py:35:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/utils/workspace_resolver.py:40:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/utils/workspace_resolver.py:76:15: E0606: Possibly using variable 'os' before assignment (possibly-used-before-assignment)\nnanobot/utils/workspace_resolver.py:119:30: W0621: Redefining name 'config_workspace' from outer scope (line 198) (redefined-outer-name)\nnanobot/utils/workspace_resolver.py:175:18: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/utils/workspace_resolver.py:176:18: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/utils/workspace_resolver.py:177:18: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/utils/workspace_resolver.py:181:18: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/utils/workspace_resolver.py:182:18: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/utils/workspace_resolver.py:201:8: C0103: Constant name \"config_workspace\" doesn't conform to UPPER_CASE naming style (invalid-name)\n************* Module nanobot.utils.helpers\nnanobot/utils/helpers.py:127:19: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.agent.message_analyzer\nnanobot/agent/message_analyzer.py:116:36: W0130: Duplicate value '看' in set (duplicate-value)\nnanobot/agent/message_analyzer.py:174:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:204:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:219:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:251:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:224:12: W0612: Unused variable 'category' (unused-variable)\nnanobot/agent/message_analyzer.py:266:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:289:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:270:8: R1702: Too many nested blocks (6/5) (too-many-nested-blocks)\nnanobot/agent/message_analyzer.py:307:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:324:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:345:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:359:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:375:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_analyzer.py:385:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\n************* Module nanobot.agent.task\nnanobot/agent/task.py:27:0: R0902: Too many instance attributes (16/7) (too-many-instance-attributes)\n************* Module nanobot.agent.message_bus\nnanobot/agent/message_bus.py:38:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/message_bus.py:45:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/message_bus.py:50:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/message_bus.py:57:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/message_bus.py:62:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/message_bus.py:93:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:94:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:118:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:119:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:133:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:157:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:142:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:151:24: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:154:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:158:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:184:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:230:12: C0415: Import outside toplevel (redis.asyncio) (import-outside-toplevel)\nnanobot/agent/message_bus.py:235:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:238:12: W0707: Consider explicitly re-raising using 'except ImportError as exc' and 'raise RuntimeError('redis-py未安装，请运行: pip install redis') from exc' (raise-missing-from)\nnanobot/agent/message_bus.py:240:12: W0707: Consider explicitly re-raising using 'raise RuntimeError(f'连接Redis失败: {e}') from e' (raise-missing-from)\nnanobot/agent/message_bus.py:256:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:257:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:281:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:285:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:325:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:319:35: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:320:32: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:323:24: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:326:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:355:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:333:20: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:352:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:356:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:385:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:406:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:407:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:410:0: R0902: Too many instance attributes (8/7) (too-many-instance-attributes)\nnanobot/agent/message_bus.py:449:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:471:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/message_bus.py:471:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/message_bus.py:494:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/message_bus.py:499:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/message_bus.py:499:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/message_bus.py:518:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/message_bus.py:540:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/message_bus.py:554:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:555:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:567:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:570:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:580:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:581:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:593:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:594:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:626:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:624:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:627:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:660:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_bus.py:657:20: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:661:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:665:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_bus.py:10:0: W0611: Unused import time (unused-import)\nnanobot/agent/message_bus.py:13:0: W0611: Unused datetime imported from datetime (unused-import)\nnanobot/agent/message_bus.py:14:0: W0611: Unused Any imported from typing (unused-import)\nnanobot/agent/message_bus.py:14:0: W0611: Unused Set imported from typing (unused-import)\nnanobot/agent/message_bus.py:16:0: W0611: Unused ErrorMessage imported from nanobot.agent.message_schemas (unused-import)\nnanobot/agent/message_bus.py:16:0: W0611: Unused HeartbeatMessage imported from nanobot.agent.message_schemas (unused-import)\nnanobot/agent/message_bus.py:16:0: W0611: Unused LogMessage imported from nanobot.agent.message_schemas (unused-import)\nnanobot/agent/message_bus.py:16:0: W0611: Unused MessageType imported from nanobot.agent.message_schemas (unused-import)\nnanobot/agent/message_bus.py:16:0: W0611: Unused RequestMessage imported from nanobot.agent.message_schemas (unused-import)\nnanobot/agent/message_bus.py:16:0: W0611: Unused ResponseMessage imported from nanobot.agent.message_schemas (unused-import)\nnanobot/agent/message_bus.py:16:0: W0611: Unused parse_message imported from nanobot.agent.message_schemas (unused-import)\n************* Module nanobot.agent.hooks\nnanobot/agent/hooks.py:12:0: E0611: No name 'models' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/hooks.py:43:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:58:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:68:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:80:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:90:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:100:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:109:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:118:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:127:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:137:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:152:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:208:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:212:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:216:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:220:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:224:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:228:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:232:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:236:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:240:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:244:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks.py:248:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\n************* Module nanobot.agent.context_manager\nnanobot/agent/context_manager.py:31:0: R0902: Too many instance attributes (8/7) (too-many-instance-attributes)\nnanobot/agent/context_manager.py:44:0: R0902: Too many instance attributes (9/7) (too-many-instance-attributes)\nnanobot/agent/context_manager.py:77:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/context_manager.py:78:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_manager.py:86:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/context_manager.py:87:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_manager.py:102:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_manager.py:118:4: R0914: Too many local variables (19/15) (too-many-locals)\nnanobot/agent/context_manager.py:265:4: R0914: Too many local variables (18/15) (too-many-locals)\nnanobot/agent/context_manager.py:278:8: C0415: Import outside toplevel (yaml) (import-outside-toplevel)\nnanobot/agent/context_manager.py:311:27: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/context_manager.py:310:28: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_manager.py:312:24: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_manager.py:335:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/context_manager.py:333:20: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_manager.py:336:20: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_manager.py:348:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_manager.py:265:4: R0912: Too many branches (13/12) (too-many-branches)\n************* Module nanobot.agent.prompt_builder\nnanobot/agent/prompt_builder.py:115:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/prompt_builder.py:115:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/prompt_builder.py:202:8: C0415: Import outside toplevel (nanobot.agent.skill_loader.SkillLoader) (import-outside-toplevel)\nnanobot/agent/prompt_builder.py:215:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/prompt_builder.py:394:0: C0103: Constant name \"_prompt_builder_instance\" doesn't conform to UPPER_CASE naming style (invalid-name)\nnanobot/agent/prompt_builder.py:404:4: W0603: Using the global statement (global-statement)\nnanobot/agent/prompt_builder.py:13:0: W0611: Unused import os (unused-import)\nnanobot/agent/prompt_builder.py:14:0: W0611: Unused datetime imported from datetime (unused-import)\nnanobot/agent/prompt_builder.py:21:0: W0611: Unused load_config imported from nanobot.config.loader (unused-import)\n************* Module nanobot.agent.skills\nnanobot/agent/skills.py:47:4: R0912: Too many branches (17/12) (too-many-branches)\nnanobot/agent/skills.py:242:59: E1101: Module 're' has no 'DOT' member (no-member)\n************* Module nanobot.agent.prompt_system\nnanobot/agent/prompt_system.py:68:0: C0301: Line too long (105/100) (line-too-long)\nnanobot/agent/prompt_system.py:181:0: C0301: Line too long (153/100) (line-too-long)\nnanobot/agent/prompt_system.py:182:0: C0301: Line too long (298/100) (line-too-long)\nnanobot/agent/prompt_system.py:429:9: W0511: TODO: 从真实上下文判断 (fixme)\nnanobot/agent/prompt_system.py:67:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:80:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/prompt_system.py:90:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:95:8: C0415: Import outside toplevel (yaml) (import-outside-toplevel)\nnanobot/agent/prompt_system.py:200:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:208:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:219:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:222:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:226:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/prompt_system.py:227:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:255:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:260:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:266:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:265:8: W0612: Unused variable 'content' (unused-variable)\nnanobot/agent/prompt_system.py:272:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:279:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:283:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:283:21: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/prompt_system.py:281:0: W0613: Unused argument 'kwargs' (unused-argument)\nnanobot/agent/prompt_system.py:289:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:287:8: W0612: Unused variable 'agent' (unused-variable)\nnanobot/agent/prompt_system.py:294:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:318:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:321:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:298:27: W0613: Unused argument 'paths' (unused-argument)\nnanobot/agent/prompt_system.py:333:26: W0613: Unused argument 'layer_name' (unused-argument)\nnanobot/agent/prompt_system.py:386:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:392:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/prompt_system.py:393:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:415:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/prompt_system.py:416:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/prompt_system.py:624:0: C0103: Constant name \"_prompt_system_v2_instance\" doesn't conform to UPPER_CASE naming style (invalid-name)\nnanobot/agent/prompt_system.py:640:4: W0603: Using the global statement (global-statement)\nnanobot/agent/prompt_system.py:9:0: W0611: Unused dataclass imported from dataclasses (unused-import)\n************* Module nanobot.agent.cron_system\nnanobot/agent/cron_system.py:39:0: R0902: Too many instance attributes (8/7) (too-many-instance-attributes)\nnanobot/agent/cron_system.py:55:0: R0902: Too many instance attributes (12/7) (too-many-instance-attributes)\nnanobot/agent/cron_system.py:74:0: R0902: Too many instance attributes (8/7) (too-many-instance-attributes)\nnanobot/agent/cron_system.py:95:4: E0213: Method '_thread_safe' should have \"self\" as first argument (no-self-argument)\nnanobot/agent/cron_system.py:102:17: W0212: Access to a protected member _lock of a client class (protected-access)\nnanobot/agent/cron_system.py:103:23: E1102: func is not callable (not-callable)\nnanobot/agent/cron_system.py:128:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:150:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/cron_system.py:151:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:157:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:180:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:206:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/cron_system.py:207:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:209:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:258:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/cron_system.py:259:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:301:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/cron_system.py:299:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:302:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:355:32: W0621: Redefining name 'field' from outer scope (line 12) (redefined-outer-name)\nnanobot/agent/cron_system.py:363:12: W0707: Consider explicitly re-raising using 'except ValueError as exc' and 'raise ValueError(f'无效的时间字段: {field}') from exc' (raise-missing-from)\nnanobot/agent/cron_system.py:377:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:392:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/cron_system.py:386:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:397:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:376:8: W0612: Unused variable 'start_time' (unused-variable)\nnanobot/agent/cron_system.py:381:12: W0612: Unused variable 'result' (unused-variable)\nnanobot/agent/cron_system.py:420:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/cron_system.py:421:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/cron_system.py:411:16: W0612: Unused variable 'job' (unused-variable)\nnanobot/agent/cron_system.py:571:0: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/cron_system.py:571:0: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/cron_system.py:610:0: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/cron_system.py:610:0: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/cron_system.py:649:0: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/cron_system.py:649:0: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\n************* Module nanobot.agent.context_compressor\nnanobot/agent/context_compressor.py:68:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/context_compressor.py:69:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_compressor.py:86:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/context_compressor.py:87:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_compressor.py:227:12: W0612: Unused variable 'role' (unused-variable)\nnanobot/agent/context_compressor.py:260:4: R0914: Too many local variables (20/15) (too-many-locals)\nnanobot/agent/context_compressor.py:15:0: W0611: Unused Optional imported from typing (unused-import)\n************* Module nanobot.agent.main_agent\nnanobot/agent/main_agent.py:261:0: C0301: Line too long (101/100) (line-too-long)\nnanobot/agent/main_agent.py:130:9: W0511: TODO: 从配置中注册自定义钩子 (fixme)\nnanobot/agent/main_agent.py:393:9: W0511: TODO: 实现帮助文档 (fixme)\nnanobot/agent/main_agent.py:402:9: W0511: TODO: 实现控制逻辑 (fixme)\nnanobot/agent/main_agent.py:618:9: W0511: TODO: 从现有的 prompt_builder.py 迁移逻辑到这里 (fixme)\nnanobot/agent/main_agent.py:642:9: W0511: TODO: 从 skills loader 获取 (fixme)\nnanobot/agent/main_agent.py:652:9: W0511: TODO: 从工具注册表获取 (fixme)\nnanobot/agent/main_agent.py:666:9: W0511: TODO: 从工具注册表获取 (fixme)\nnanobot/agent/main_agent.py:20:0: C0414: Import alias does not rename original package (useless-import-alias)\nnanobot/agent/main_agent.py:23:0: E0611: No name 'manager' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/main_agent.py:24:0: E0611: No name 'models' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/main_agent.py:54:0: R0902: Too many instance attributes (12/7) (too-many-instance-attributes)\nnanobot/agent/main_agent.py:67:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/main_agent.py:67:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/main_agent.py:97:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:102:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:107:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:126:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:131:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/main_agent.py:143:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:150:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:211:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/main_agent.py:165:20: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/main_agent.py:177:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:190:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:207:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:212:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:133:4: R0912: Too many branches (14/12) (too-many-branches)\nnanobot/agent/main_agent.py:160:16: W0612: Unused variable 'context' (unused-variable)\nnanobot/agent/main_agent.py:226:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:260:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:266:12: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/main_agent.py:267:12: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/main_agent.py:270:12: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/main_agent.py:271:12: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/main_agent.py:282:16: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/main_agent.py:290:4: R0914: Too many local variables (21/15) (too-many-locals)\nnanobot/agent/main_agent.py:292:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:323:16: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/main_agent.py:327:16: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/main_agent.py:332:38: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/main_agent.py:381:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:385:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/main_agent.py:398:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:407:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:462:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/main_agent.py:442:16: C0415: Import outside toplevel (nanobot.providers.litellm_provider.LiteLLMProvider) (import-outside-toplevel)\nnanobot/agent/main_agent.py:457:12: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/main_agent.py:463:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:466:4: R0914: Too many local variables (19/15) (too-many-locals)\nnanobot/agent/main_agent.py:527:28: W0621: Redefining name 'inspect' from outer scope (line 8) (redefined-outer-name)\nnanobot/agent/main_agent.py:479:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:491:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:496:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:503:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:558:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/main_agent.py:513:28: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:519:28: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:522:28: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:527:28: W0404: Reimport 'inspect' (imported line 8) (reimported)\nnanobot/agent/main_agent.py:527:28: C0415: Import outside toplevel (inspect) (import-outside-toplevel)\nnanobot/agent/main_agent.py:540:28: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:544:28: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:554:24: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:559:20: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:488:8: R1702: Too many nested blocks (6/5) (too-many-nested-blocks)\nnanobot/agent/main_agent.py:575:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:583:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:598:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/main_agent.py:590:20: C0415: Import outside toplevel (nanobot.providers.litellm_provider.LiteLLMProvider) (import-outside-toplevel)\nnanobot/agent/main_agent.py:599:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:466:4: R0912: Too many branches (15/12) (too-many-branches)\nnanobot/agent/main_agent.py:466:4: R0915: Too many statements (55/50) (too-many-statements)\nnanobot/agent/main_agent.py:682:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/main_agent.py:683:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:698:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/main_agent.py:7:0: W0611: Unused import asyncio (unused-import)\nnanobot/agent/main_agent.py:8:0: W0611: Unused import inspect (unused-import)\nnanobot/agent/main_agent.py:19:0: W0611: Unused DecisionRequest imported from nanobot.agent.decision.models (unused-import)\nnanobot/agent/main_agent.py:19:0: W0611: Unused DecisionResult imported from nanobot.agent.decision.models (unused-import)\nnanobot/agent/main_agent.py:21:0: W0611: Unused TaskPlan imported from nanobot.agent.planner.models (unused-import)\n************* Module nanobot.agent.context\nnanobot/agent/context.py:27:34: W0613: Unused argument 'skill_names' (unused-argument)\nnanobot/agent/context.py:74:8: C0415: Import outside toplevel (datetime.datetime) (import-outside-toplevel)\n************* Module nanobot.agent.task_manager\nnanobot/agent/task_manager.py:72:0: C0325: Unnecessary parens after 'not' keyword (superfluous-parens)\nnanobot/agent/task_manager.py:294:0: C0325: Unnecessary parens after 'not' keyword (superfluous-parens)\nnanobot/agent/task_manager.py:27:0: R0902: Too many instance attributes (10/7) (too-many-instance-attributes)\nnanobot/agent/task_manager.py:143:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:160:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/task_manager.py:157:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:161:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:164:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:177:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/task_manager.py:174:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:178:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:203:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:218:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:220:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:223:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/task_manager.py:223:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/task_manager.py:305:8: C0415: Import outside toplevel (time) (import-outside-toplevel)\nnanobot/agent/task_manager.py:312:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:223:4: R0912: Too many branches (16/12) (too-many-branches)\nnanobot/agent/task_manager.py:357:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:370:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/task_manager.py:374:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:377:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/task_manager.py:404:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\n************* Module nanobot.agent.loop\nnanobot/agent/loop.py:14:0: E0611: No name 'SubagentManager' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/loop.py:30:0: R0902: Too many instance attributes (15/7) (too-many-instance-attributes)\nnanobot/agent/loop.py:42:4: R0913: Too many arguments (9/5) (too-many-arguments)\nnanobot/agent/loop.py:42:4: R0917: Too many positional arguments (9/5) (too-many-positional-arguments)\nnanobot/agent/loop.py:121:8: C0415: Import outside toplevel (nanobot.agent.tools.mcp.MCPTool) (import-outside-toplevel)\nnanobot/agent/loop.py:125:48: E1101: Instance of 'AgentLoop' has no 'opencode_config' member (no-member)\nnanobot/agent/loop.py:126:26: E1101: Instance of 'AgentLoop' has no 'opencode_config' member (no-member)\nnanobot/agent/loop.py:155:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/loop.py:232:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/loop.py:269:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/loop.py:277:4: R0914: Too many local variables (19/15) (too-many-locals)\nnanobot/agent/loop.py:449:28: W0613: Unused argument 'session_key' (unused-argument)\n************* Module nanobot.agent.message_schemas\nnanobot/agent/message_schemas.py:9:0: W0611: Unused Union imported from typing (unused-import)\n************* Module nanobot.agent.enhanced_main_agent\nnanobot/agent/enhanced_main_agent.py:27:0: E0611: No name 'manager' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/enhanced_main_agent.py:28:0: E0611: No name 'models' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/enhanced_main_agent.py:55:0: R0902: Too many instance attributes (12/7) (too-many-instance-attributes)\nnanobot/agent/enhanced_main_agent.py:78:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:83:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:96:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:103:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:122:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:127:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:143:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/enhanced_main_agent.py:144:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:154:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:158:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:161:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/enhanced_main_agent.py:178:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:183:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:211:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:214:8: C0415: Import outside toplevel (time) (import-outside-toplevel)\nnanobot/agent/enhanced_main_agent.py:232:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:239:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:252:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:264:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:270:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:283:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:300:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:318:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:323:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:343:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:345:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/enhanced_main_agent.py:356:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:375:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:389:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:396:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/enhanced_main_agent.py:409:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\n************* Module nanobot.agent.message_router\nnanobot/agent/message_router.py:81:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:97:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:113:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:128:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:154:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:166:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:177:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_router.py:175:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:178:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:188:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_router.py:189:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:212:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/message_router.py:216:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/message_router.py:222:12: C0415: Import outside toplevel (re) (import-outside-toplevel)\nnanobot/agent/message_router.py:224:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/message_router.py:234:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/message_router.py:240:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/message_router.py:194:4: R0911: Too many return statements (11/6) (too-many-return-statements)\nnanobot/agent/message_router.py:194:4: R0912: Too many branches (14/12) (too-many-branches)\nnanobot/agent/message_router.py:247:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/message_router.py:247:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/message_router.py:338:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/message_router.py:339:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/message_router.py:11:0: W0611: Unused Tuple imported from typing (unused-import)\n************* Module nanobot.agent.context_monitor\nnanobot/agent/context_monitor.py:120:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:146:12: C0415: Import outside toplevel (tiktoken) (import-outside-toplevel)\nnanobot/agent/context_monitor.py:152:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:192:28: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:194:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:221:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:243:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:271:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:311:12: R1723: Unnecessary \"else\" after \"break\", remove the \"else\" and de-indent the code inside it (no-else-break)\nnanobot/agent/context_monitor.py:336:12: C0415: Import outside toplevel (nanobot.agent.context_compressor.ContextCompressor) (import-outside-toplevel)\nnanobot/agent/context_monitor.py:375:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:355:32: W0612: Unused variable 'stats' (unused-variable)\nnanobot/agent/context_monitor.py:388:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:415:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:419:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:459:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/context_monitor.py:449:12: C0415: Import outside toplevel (asyncio) (import-outside-toplevel)\nnanobot/agent/context_monitor.py:460:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/context_monitor.py:15:0: W0611: Unused field imported from dataclasses (unused-import)\n************* Module nanobot.agent.skill_loader\nnanobot/agent/skill_loader.py:59:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/skill_loader.py:197:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/skill_loader.py:223:15: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.agent.legacy_memory\nnanobot/agent/legacy_memory.py:66:8: C0415: Import outside toplevel (datetime.timedelta) (import-outside-toplevel)\n************* Module nanobot.agent.tools.web\nnanobot/agent/tools/web.py:42:11: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/web.py:69:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 4 in overriding 'WebSearchTool.execute' method (arguments-differ)\nnanobot/agent/tools/web.py:97:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/web.py:123:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 5 in overriding 'WebFetchTool.execute' method (arguments-differ)\nnanobot/agent/tools/web.py:123:4: R0914: Too many local variables (17/15) (too-many-locals)\nnanobot/agent/tools/web.py:130:8: C0415: Import outside toplevel (readability.Document) (import-outside-toplevel)\nnanobot/agent/tools/web.py:183:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/web.py:186:27: W0621: Redefining name 'html' from outer scope (line 3) (redefined-outer-name)\n************* Module nanobot.agent.tools.git_tools\nnanobot/agent/tools/git_tools.py:34:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 4 in overriding 'GitCloneTool.execute' method (arguments-differ)\nnanobot/agent/tools/git_tools.py:34:4: W0221: Variadics removed in overriding 'GitCloneTool.execute' method (arguments-differ)\nnanobot/agent/tools/git_tools.py:61:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/git_tools.py:39:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/git_tools.py:85:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 3 in overriding 'GitCommitTool.execute' method (arguments-differ)\nnanobot/agent/tools/git_tools.py:85:4: W0221: Variadics removed in overriding 'GitCommitTool.execute' method (arguments-differ)\nnanobot/agent/tools/git_tools.py:119:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/git_tools.py:88:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/git_tools.py:142:4: W0221: Variadics removed in overriding 'GitPushTool.execute' method (arguments-differ)\nnanobot/agent/tools/git_tools.py:166:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/git_tools.py:145:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/git_tools.py:189:4: W0221: Variadics removed in overriding 'GitPullTool.execute' method (arguments-differ)\nnanobot/agent/tools/git_tools.py:213:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/git_tools.py:192:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/git_tools.py:225:4: W0221: Variadics removed in overriding 'GitStatusTool.execute' method (arguments-differ)\nnanobot/agent/tools/git_tools.py:241:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/git_tools.py:228:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/git_tools.py:259:4: W0221: Variadics removed in overriding 'GitLogTool.execute' method (arguments-differ)\nnanobot/agent/tools/git_tools.py:276:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/git_tools.py:262:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/git_tools.py:5:0: W0611: Unused Any imported from typing (unused-import)\nnanobot/agent/tools/git_tools.py:5:0: W0611: Unused Dict imported from typing (unused-import)\n************* Module nanobot.agent.tools.config_tools\nnanobot/agent/tools/config_tools.py:55:0: C0301: Line too long (128/100) (line-too-long)\nnanobot/agent/tools/config_tools.py:18:4: W0221: Variadics removed in overriding 'GetAvailableSkillsTool.execute' method (arguments-differ)\nnanobot/agent/tools/config_tools.py:42:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/config_tools.py:21:12: C0415: Import outside toplevel (nanobot.agent.skill_loader.SkillLoader) (import-outside-toplevel)\nnanobot/agent/tools/config_tools.py:60:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 2 in overriding 'GetSkillsForTaskTool.execute' method (arguments-differ)\nnanobot/agent/tools/config_tools.py:60:4: W0221: Variadics removed in overriding 'GetSkillsForTaskTool.execute' method (arguments-differ)\nnanobot/agent/tools/config_tools.py:76:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/config_tools.py:63:12: C0415: Import outside toplevel (nanobot.agent.skill_loader.SkillLoader) (import-outside-toplevel)\nnanobot/agent/tools/config_tools.py:87:4: W0221: Variadics removed in overriding 'GetAvailableAgentsTool.execute' method (arguments-differ)\nnanobot/agent/tools/config_tools.py:102:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/config_tools.py:120:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 2 in overriding 'GetSkillContentTool.execute' method (arguments-differ)\nnanobot/agent/tools/config_tools.py:120:4: W0221: Variadics removed in overriding 'GetSkillContentTool.execute' method (arguments-differ)\nnanobot/agent/tools/config_tools.py:133:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/config_tools.py:123:12: C0415: Import outside toplevel (nanobot.agent.skill_loader.SkillLoader) (import-outside-toplevel)\nnanobot/agent/tools/config_tools.py:128:12: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/tools/config_tools.py:5:0: W0611: Unused Path imported from pathlib (unused-import)\nnanobot/agent/tools/config_tools.py:6:0: W0611: Unused Any imported from typing (unused-import)\nnanobot/agent/tools/config_tools.py:6:0: W0611: Unused Dict imported from typing (unused-import)\nnanobot/agent/tools/config_tools.py:6:0: W0611: Unused List imported from typing (unused-import)\n************* Module nanobot.agent.tools.registry\nnanobot/agent/tools/registry.py:63:15: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.agent.tools.filesystem\nnanobot/agent/tools/filesystem.py:27:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 3 in overriding 'ReadFileTool.execute' method (arguments-differ)\nnanobot/agent/tools/filesystem.py:39:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/filesystem.py:64:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 4 in overriding 'WriteFileTool.execute' method (arguments-differ)\nnanobot/agent/tools/filesystem.py:79:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/filesystem.py:103:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 3 in overriding 'ListDirTool.execute' method (arguments-differ)\nnanobot/agent/tools/filesystem.py:121:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/filesystem.py:4:0: W0611: Unused List imported from typing (unused-import)\nnanobot/agent/tools/filesystem.py:4:0: W0611: Unused Optional imported from typing (unused-import)\n************* Module nanobot.agent.tools.shell\nnanobot/agent/tools/shell.py:15:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/tools/shell.py:15:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/tools/shell.py:63:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 4 in overriding 'ExecTool.execute' method (arguments-differ)\nnanobot/agent/tools/shell.py:112:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/shell.py:142:23: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.agent.tools.message\nnanobot/agent/tools/message.py:62:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 5 in overriding 'MessageTool.execute' method (arguments-differ)\nnanobot/agent/tools/message.py:83:15: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.agent.tools.mcp\nnanobot/agent/tools/mcp.py:73:0: C0301: Line too long (106/100) (line-too-long)\nnanobot/agent/tools/mcp.py:353:0: C0301: Line too long (107/100) (line-too-long)\nnanobot/agent/tools/mcp.py:448:0: C0301: Line too long (107/100) (line-too-long)\nnanobot/agent/tools/mcp.py:628:0: C0301: Line too long (105/100) (line-too-long)\nnanobot/agent/tools/mcp.py:757:0: C0301: Line too long (107/100) (line-too-long)\nnanobot/agent/tools/mcp.py:102:18: E1121: Too many positional arguments for method call (too-many-function-args)\nnanobot/agent/tools/mcp.py:168:8: W0621: Redefining name 'json' from outer scope (line 4) (redefined-outer-name)\nnanobot/agent/tools/mcp.py:168:8: W0404: Reimport 'json' (imported line 4) (reimported)\nnanobot/agent/tools/mcp.py:168:8: C0415: Import outside toplevel (json) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:193:8: C0415: Import outside toplevel (select) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:194:8: C0415: Import outside toplevel (time) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:199:8: R1702: Too many nested blocks (6/5) (too-many-nested-blocks)\nnanobot/agent/tools/mcp.py:122:23: R1732: Consider using 'with' for resource-allocating operations (consider-using-with)\nnanobot/agent/tools/mcp.py:245:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 3 in overriding 'MCPTool.execute' method (arguments-differ)\nnanobot/agent/tools/mcp.py:266:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/mcp.py:258:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/tools/mcp.py:270:4: E0102: method already defined line 150 (function-redefined)\nnanobot/agent/tools/mcp.py:372:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/mcp.py:365:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/tools/mcp.py:369:23: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/tools/mcp.py:330:4: R0911: Too many return statements (7/6) (too-many-return-statements)\nnanobot/agent/tools/mcp.py:376:4: R0914: Too many local variables (18/15) (too-many-locals)\nnanobot/agent/tools/mcp.py:385:16: W0621: Redefining name 'json' from outer scope (line 4) (redefined-outer-name)\nnanobot/agent/tools/mcp.py:456:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/mcp.py:385:16: W0404: Reimport 'json' (imported line 4) (reimported)\nnanobot/agent/tools/mcp.py:385:16: C0415: Import outside toplevel (json) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:399:16: C0415: Import outside toplevel (select) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:400:16: C0415: Import outside toplevel (time) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:459:4: E0102: method already defined line 113 (function-redefined)\nnanobot/agent/tools/mcp.py:382:8: R1702: Too many nested blocks (10/5) (too-many-nested-blocks)\nnanobot/agent/tools/mcp.py:492:4: E0102: method already defined line 134 (function-redefined)\nnanobot/agent/tools/mcp.py:498:4: E0102: method already defined line 164 (function-redefined)\nnanobot/agent/tools/mcp.py:502:8: W0621: Redefining name 'json' from outer scope (line 4) (redefined-outer-name)\nnanobot/agent/tools/mcp.py:502:8: W0404: Reimport 'json' (imported line 4) (reimported)\nnanobot/agent/tools/mcp.py:502:8: C0415: Import outside toplevel (json) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:503:8: C0415: Import outside toplevel (select) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:504:8: C0415: Import outside toplevel (time) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:524:19: W0212: Access to a protected member _lock of a client class (protected-access)\nnanobot/agent/tools/mcp.py:532:8: W0212: Access to a protected member _pending_responses of a client class (protected-access)\nnanobot/agent/tools/mcp.py:539:12: W0707: Consider explicitly re-raising using 'except Exception as exc' and 'raise TimeoutError(f'MCP tool call timed out after {conn.config.timeout} seconds') from exc' (raise-missing-from)\nnanobot/agent/tools/mcp.py:543:12: W0212: Access to a protected member _pending_responses of a client class (protected-access)\nnanobot/agent/tools/mcp.py:503:8: W0611: Unused import select (unused-import)\nnanobot/agent/tools/mcp.py:504:8: W0611: Unused import time (unused-import)\nnanobot/agent/tools/mcp.py:547:8: W0621: Redefining name 'json' from outer scope (line 4) (redefined-outer-name)\nnanobot/agent/tools/mcp.py:547:8: W0404: Reimport 'json' (imported line 4) (reimported)\nnanobot/agent/tools/mcp.py:547:8: C0415: Import outside toplevel (json) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:593:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/mcp.py:566:37: W0212: Access to a protected member _pending_responses of a client class (protected-access)\nnanobot/agent/tools/mcp.py:567:33: W0212: Access to a protected member _pending_responses of a client class (protected-access)\nnanobot/agent/tools/mcp.py:552:8: R1702: Too many nested blocks (7/5) (too-many-nested-blocks)\nnanobot/agent/tools/mcp.py:609:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/mcp.py:617:4: E0102: method already defined line 224 (function-redefined)\nnanobot/agent/tools/mcp.py:468:23: R1732: Consider using 'with' for resource-allocating operations (consider-using-with)\nnanobot/agent/tools/mcp.py:638:4: E0102: method already defined line 245 (function-redefined)\nnanobot/agent/tools/mcp.py:638:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 3 in overriding 'MCPTool.execute' method (arguments-differ)\nnanobot/agent/tools/mcp.py:659:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/mcp.py:651:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/tools/mcp.py:663:4: E0102: method already defined line 150 (function-redefined)\nnanobot/agent/tools/mcp.py:701:4: E0102: method already defined line 302 (function-redefined)\nnanobot/agent/tools/mcp.py:734:4: E0102: method already defined line 330 (function-redefined)\nnanobot/agent/tools/mcp.py:776:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/mcp.py:769:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/tools/mcp.py:773:23: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/tools/mcp.py:734:4: R0911: Too many return statements (7/6) (too-many-return-statements)\nnanobot/agent/tools/mcp.py:780:4: E0102: method already defined line 164 (function-redefined)\nnanobot/agent/tools/mcp.py:780:4: R0914: Too many local variables (22/15) (too-many-locals)\nnanobot/agent/tools/mcp.py:784:8: W0621: Redefining name 'json' from outer scope (line 4) (redefined-outer-name)\nnanobot/agent/tools/mcp.py:784:8: W0404: Reimport 'json' (imported line 4) (reimported)\nnanobot/agent/tools/mcp.py:784:8: C0415: Import outside toplevel (json) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:804:19: W0212: Access to a protected member _lock of a client class (protected-access)\nnanobot/agent/tools/mcp.py:811:8: C0415: Import outside toplevel (select) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:812:8: C0415: Import outside toplevel (time) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:868:4: E0102: method already defined line 596 (function-redefined)\nnanobot/agent/tools/mcp.py:875:24: W0621: Redefining name 'json' from outer scope (line 4) (redefined-outer-name)\nnanobot/agent/tools/mcp.py:817:8: R1702: Too many nested blocks (7/5) (too-many-nested-blocks)\nnanobot/agent/tools/mcp.py:905:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/mcp.py:893:27: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/mcp.py:875:24: W0404: Reimport 'json' (imported line 4) (reimported)\nnanobot/agent/tools/mcp.py:875:24: C0415: Import outside toplevel (json) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:886:24: C0415: Import outside toplevel (select) (import-outside-toplevel)\nnanobot/agent/tools/mcp.py:888:37: E0602: Undefined variable 'time' (undefined-variable)\nnanobot/agent/tools/mcp.py:889:30: E0602: Undefined variable 'time' (undefined-variable)\nnanobot/agent/tools/mcp.py:870:8: R1702: Too many nested blocks (6/5) (too-many-nested-blocks)\n************* Module nanobot.agent.tools.spawn\nnanobot/agent/tools/spawn.py:58:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 4 in overriding 'SpawnTool.execute' method (arguments-differ)\n************* Module nanobot.agent.tools.database_tools\nnanobot/agent/tools/database_tools.py:51:4: W0221: Variadics removed in overriding 'MySQLQueryTool.execute' method (arguments-differ)\nnanobot/agent/tools/database_tools.py:51:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/tools/database_tools.py:51:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/tools/database_tools.py:92:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/database_tools.py:62:12: C0415: Import outside toplevel (mysql.connector) (import-outside-toplevel)\nnanobot/agent/tools/database_tools.py:62:12: E0401: Unable to import 'mysql.connector' (import-error)\nnanobot/agent/tools/database_tools.py:137:4: W0221: Variadics removed in overriding 'PostgreSQLQueryTool.execute' method (arguments-differ)\nnanobot/agent/tools/database_tools.py:137:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/tools/database_tools.py:137:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/tools/database_tools.py:178:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/database_tools.py:148:12: C0415: Import outside toplevel (psycopg2) (import-outside-toplevel)\nnanobot/agent/tools/database_tools.py:148:12: E0401: Unable to import 'psycopg2' (import-error)\nnanobot/agent/tools/database_tools.py:5:0: W0611: Unused Any imported from typing (unused-import)\nnanobot/agent/tools/database_tools.py:5:0: W0611: Unused Dict imported from typing (unused-import)\n************* Module nanobot.agent.tools.docker_tools\nnanobot/agent/tools/docker_tools.py:39:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 5 in overriding 'DockerBuildTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:39:4: W0221: Variadics removed in overriding 'DockerBuildTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:68:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/docker_tools.py:44:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/docker_tools.py:53:32: W1309: Using an f-string that does not have any interpolated variables (f-string-without-interpolation)\nnanobot/agent/tools/docker_tools.py:113:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 7 in overriding 'DockerRunTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:113:4: W0221: Variadics removed in overriding 'DockerRunTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:113:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/tools/docker_tools.py:113:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/tools/docker_tools.py:113:4: R0914: Too many local variables (16/15) (too-many-locals)\nnanobot/agent/tools/docker_tools.py:160:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/docker_tools.py:124:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/docker_tools.py:188:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 4 in overriding 'DockerComposeTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:188:4: W0221: Variadics removed in overriding 'DockerComposeTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:216:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/docker_tools.py:193:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/docker_tools.py:234:4: W0221: Variadics removed in overriding 'DockerPsTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:234:28: W0622: Redefining built-in 'all' (redefined-builtin)\nnanobot/agent/tools/docker_tools.py:255:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/docker_tools.py:237:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/docker_tools.py:273:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 2 in overriding 'DockerStopTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:273:4: W0221: Variadics removed in overriding 'DockerStopTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:289:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/docker_tools.py:276:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/docker_tools.py:317:4: W0221: Number of parameters was 2 in 'Tool.execute' and is now 4 in overriding 'DockerRemoveTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:317:4: W0221: Variadics removed in overriding 'DockerRemoveTool.execute' method (arguments-differ)\nnanobot/agent/tools/docker_tools.py:318:27: W0622: Redefining built-in 'type' (redefined-builtin)\nnanobot/agent/tools/docker_tools.py:342:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/tools/docker_tools.py:322:12: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/agent/tools/docker_tools.py:5:0: W0611: Unused Any imported from typing (unused-import)\nnanobot/agent/tools/docker_tools.py:5:0: W0611: Unused Dict imported from typing (unused-import)\n************* Module nanobot.agent.tools.base\nnanobot/agent/tools/base.py:28:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/tools/base.py:34:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/tools/base.py:40:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/tools/base.py:53:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/tools/base.py:62:4: R0912: Too many branches (15/12) (too-many-branches)\n************* Module nanobot.agent.memory.models\nnanobot/agent/memory/models.py:29:4: R0903: Too few public methods (0/2) (too-few-public-methods)\n************* Module nanobot.agent.memory.enhanced_memory\nnanobot/agent/memory/enhanced_memory.py:59:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/memory/enhanced_memory.py:82:15: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.agent.planner.complexity_analyzer\nnanobot/agent/planner/complexity_analyzer.py:90:4: R0903: Too few public methods (0/2) (too-few-public-methods)\nnanobot/agent/planner/complexity_analyzer.py:108:15: R0916: Too many boolean expressions in if statement (7/5) (too-many-boolean-expressions)\nnanobot/agent/planner/complexity_analyzer.py:124:34: E1101: Instance of 'FieldInfo' has no 'get' member (no-member)\nnanobot/agent/planner/complexity_analyzer.py:136:12: W0707: Consider explicitly re-raising using 'raise Exception(f'复杂度分析失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/complexity_analyzer.py:136:12: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/planner/complexity_analyzer.py:153:30: E1101: Instance of 'FieldInfo' has no 'get' member (no-member)\nnanobot/agent/planner/complexity_analyzer.py:175:12: W0707: Consider explicitly re-raising using 'raise Exception(f'详细复杂度分析失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/complexity_analyzer.py:175:12: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/planner/complexity_analyzer.py:193:4: R0914: Too many local variables (16/15) (too-many-locals)\nnanobot/agent/planner/complexity_analyzer.py:235:23: E1101: Instance of 'FieldInfo' has no 'get' member (no-member)\nnanobot/agent/planner/complexity_analyzer.py:273:22: E1101: Instance of 'FieldInfo' has no 'get' member (no-member)\nnanobot/agent/planner/complexity_analyzer.py:317:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\n************* Module nanobot.agent.planner.task_detector\nnanobot/agent/planner/task_detector.py:97:4: R0903: Too few public methods (0/2) (too-few-public-methods)\nnanobot/agent/planner/task_detector.py:118:12: W0707: Consider explicitly re-raising using 'raise Exception(f'任务类型检测失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/task_detector.py:118:12: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/planner/task_detector.py:175:12: W0707: Consider explicitly re-raising using 'raise Exception(f'详细任务类型检测失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/task_detector.py:175:12: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/planner/task_detector.py:203:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\n************* Module nanobot.agent.planner.task_planner\nnanobot/agent/planner/task_planner.py:33:4: R0903: Too few public methods (0/2) (too-few-public-methods)\nnanobot/agent/planner/task_planner.py:118:25: E1101: Instance of 'FieldInfo' has no 'is_cancellation' member (no-member)\nnanobot/agent/planner/task_planner.py:121:40: E1101: Instance of 'FieldInfo' has no 'get_reason' member (no-member)\nnanobot/agent/planner/task_planner.py:127:31: E1101: Instance of 'FieldInfo' has no 'detect_correction' member (no-member)\nnanobot/agent/planner/task_planner.py:134:21: E1101: Instance of 'FieldInfo' has no 'is_cancellation' member (no-member)\nnanobot/agent/planner/task_planner.py:137:36: E1101: Instance of 'FieldInfo' has no 'get_reason' member (no-member)\nnanobot/agent/planner/task_planner.py:141:30: E1101: Instance of 'FieldInfo' has no 'detect_task_type' member (no-member)\nnanobot/agent/planner/task_planner.py:144:31: E1101: Instance of 'FieldInfo' has no 'analyze_complexity' member (no-member)\nnanobot/agent/planner/task_planner.py:154:12: W0707: Consider explicitly re-raising using 'raise Exception(f'任务规划失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/task_planner.py:154:12: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/planner/task_planner.py:258:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/planner/task_planner.py:248:29: E1101: Instance of 'FieldInfo' has no 'chat' member (no-member)\nnanobot/agent/planner/task_planner.py:264:31: W0613: Unused argument 'context' (unused-argument)\nnanobot/agent/planner/task_planner.py:364:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/planner/task_planner.py:355:29: E1101: Instance of 'FieldInfo' has no 'chat' member (no-member)\nnanobot/agent/planner/task_planner.py:385:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/planner/task_planner.py:422:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/planner/task_planner.py:465:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/planner/task_planner.py:455:4: R0911: Too many return statements (7/6) (too-many-return-statements)\nnanobot/agent/planner/task_planner.py:714:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/planner/task_planner.py:743:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/planner/task_planner.py:781:8: W0612: Unused variable 'dependent_steps' (unused-variable)\nnanobot/agent/planner/task_planner.py:782:8: W0612: Unused variable 'independent_steps' (unused-variable)\nnanobot/agent/planner/task_planner.py:785:8: W0612: Unused variable 'priority_order' (unused-variable)\nnanobot/agent/planner/task_planner.py:911:26: E1101: Instance of 'FieldInfo' has no 'detect_task_type' member (no-member)\nnanobot/agent/planner/task_planner.py:912:27: E1101: Instance of 'FieldInfo' has no 'analyze_complexity' member (no-member)\nnanobot/agent/planner/task_planner.py:927:21: E1101: Instance of 'FieldInfo' has no 'detect_task_type' member (no-member)\n************* Module nanobot.agent.planner.cancellation_detector\nnanobot/agent/planner/cancellation_detector.py:47:4: R0903: Too few public methods (0/2) (too-few-public-methods)\nnanobot/agent/planner/cancellation_detector.py:74:12: W0707: Consider explicitly re-raising using 'raise Exception(f'取消检测失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/cancellation_detector.py:74:12: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/planner/cancellation_detector.py:164:12: W0707: Consider explicitly re-raising using 'raise Exception(f'取消原因提取失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/cancellation_detector.py:164:12: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/planner/cancellation_detector.py:198:24: R1731: Consider using 'max_weight = max(max_weight, pattern.weight)' instead of unnecessary if block (consider-using-max-builtin)\nnanobot/agent/planner/cancellation_detector.py:204:12: W0707: Consider explicitly re-raising using 'raise Exception(f'置信度计算失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/cancellation_detector.py:204:12: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/planner/cancellation_detector.py:244:12: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/planner/cancellation_detector.py:278:12: W0707: Consider explicitly re-raising using 'raise Exception(f'取消目标提取失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/cancellation_detector.py:278:12: W0719: Raising too general exception: Exception (broad-exception-raised)\n************* Module nanobot.agent.planner.correction_detector\nnanobot/agent/planner/correction_detector.py:55:4: R0903: Too few public methods (0/2) (too-few-public-methods)\nnanobot/agent/planner/correction_detector.py:99:12: W0707: Consider explicitly re-raising using 'raise Exception(f'修正检测失败: {str(e)}') from e' (raise-missing-from)\nnanobot/agent/planner/correction_detector.py:99:12: W0719: Raising too general exception: Exception (broad-exception-raised)\nnanobot/agent/planner/correction_detector.py:121:4: R0912: Too many branches (16/12) (too-many-branches)\nnanobot/agent/planner/correction_detector.py:192:31: W0613: Unused argument 'correction_type' (unused-argument)\nnanobot/agent/planner/correction_detector.py:257:20: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/planner/correction_detector.py:334:15: R0916: Too many boolean expressions in if statement (7/5) (too-many-boolean-expressions)\n************* Module nanobot.agent.intent.llm_recognizer\nnanobot/agent/intent/llm_recognizer.py:110:0: C0301: Line too long (101/100) (line-too-long)\nnanobot/agent/intent/llm_recognizer.py:77:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/intent/llm_recognizer.py:52:0: R0903: Too few public methods (1/2) (too-few-public-methods)\nnanobot/agent/intent/llm_recognizer.py:80:0: R0903: Too few public methods (1/2) (too-few-public-methods)\nnanobot/agent/intent/llm_recognizer.py:103:0: R0902: Too many instance attributes (9/7) (too-many-instance-attributes)\nnanobot/agent/intent/llm_recognizer.py:122:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/intent/llm_recognizer.py:122:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/intent/llm_recognizer.py:141:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/llm_recognizer.py:210:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/llm_recognizer.py:262:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/llm_recognizer.py:281:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/intent/llm_recognizer.py:278:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/llm_recognizer.py:282:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/llm_recognizer.py:287:40: W0613: Unused argument 'text' (unused-argument)\nnanobot/agent/intent/llm_recognizer.py:336:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/intent/llm_recognizer.py:335:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/llm_recognizer.py:337:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/llm_recognizer.py:359:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/llm_recognizer.py:12:0: W0611: Unused Callable imported from typing (unused-import)\nnanobot/agent/intent/llm_recognizer.py:12:0: W0611: Unused Union imported from typing (unused-import)\n************* Module nanobot.agent.intent.code_based_recognizer\nnanobot/agent/intent/code_based_recognizer.py:70:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/intent/code_based_recognizer.py:70:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/intent/code_based_recognizer.py:103:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/code_based_recognizer.py:113:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/code_based_recognizer.py:136:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/code_based_recognizer.py:151:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/intent/code_based_recognizer.py:144:20: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/code_based_recognizer.py:152:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/code_based_recognizer.py:185:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/intent/code_based_recognizer.py:186:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/code_based_recognizer.py:202:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/code_based_recognizer.py:205:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/intent/code_based_recognizer.py:205:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/intent/code_based_recognizer.py:240:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/intent/code_based_recognizer.py:240:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/intent/code_based_recognizer.py:263:33: W0613: Unused argument 'context' (unused-argument)\nnanobot/agent/intent/code_based_recognizer.py:275:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/intent/code_based_recognizer.py:275:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/intent/code_based_recognizer.py:298:33: W0613: Unused argument 'context' (unused-argument)\nnanobot/agent/intent/code_based_recognizer.py:315:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/intent/code_based_recognizer.py:315:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/intent/code_based_recognizer.py:338:22: W0613: Unused argument 'text' (unused-argument)\nnanobot/agent/intent/code_based_recognizer.py:9:0: W0611: Unused Union imported from typing (unused-import)\n************* Module nanobot.agent.intent.hybrid_recognizer\nnanobot/agent/intent/hybrid_recognizer.py:140:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/hybrid_recognizer.py:152:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/hybrid_recognizer.py:215:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/hybrid_recognizer.py:234:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/intent/hybrid_recognizer.py:235:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/hybrid_recognizer.py:256:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/intent/hybrid_recognizer.py:263:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/hybrid_recognizer.py:411:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\n************* Module nanobot.agent.intent.rule_based_recognizer\nnanobot/agent/intent/rule_based_recognizer.py:79:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/intent/rule_based_recognizer.py:79:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/intent/rule_based_recognizer.py:119:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/rule_based_recognizer.py:123:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/rule_based_recognizer.py:125:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/intent/rule_based_recognizer.py:125:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/intent/rule_based_recognizer.py:159:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/intent/rule_based_recognizer.py:159:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/intent/rule_based_recognizer.py:199:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/rule_based_recognizer.py:223:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/rule_based_recognizer.py:231:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/rule_based_recognizer.py:236:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/rule_based_recognizer.py:262:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/intent/rule_based_recognizer.py:267:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/rule_based_recognizer.py:299:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/rule_based_recognizer.py:345:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/intent/rule_based_recognizer.py:366:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\n************* Module nanobot.agent.hooks.hook_system\nnanobot/agent/hooks/hook_system.py:45:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks/hook_system.py:58:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks/hook_system.py:60:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks/hook_system.py:73:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks/hook_system.py:76:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/hooks/hook_system.py:81:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/hooks/hook_system.py:82:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\n************* Module nanobot.agent.decision.skill_decision_handler\nnanobot/agent/decision/skill_decision_handler.py:18:0: C0413: Import \"from .models import DecisionRequest, DecisionResult\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/skill_decision_handler.py:59:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/skill_decision_handler.py:98:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/decision/skill_decision_handler.py:83:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/skill_decision_handler.py:99:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/skill_decision_handler.py:139:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/decision/skill_decision_handler.py:124:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/skill_decision_handler.py:132:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/skill_decision_handler.py:140:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/skill_decision_handler.py:159:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/skill_decision_handler.py:164:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/skill_decision_handler.py:145:37: W0613: Unused argument 'config_info' (unused-argument)\nnanobot/agent/decision/skill_decision_handler.py:218:14: W0613: Unused argument 'task_description' (unused-argument)\nnanobot/agent/decision/skill_decision_handler.py:23:0: R0903: Too few public methods (1/2) (too-few-public-methods)\nnanobot/agent/decision/skill_decision_handler.py:12:0: W0611: Unused Optional imported from typing (unused-import)\n************* Module nanobot.agent.decision.cancellation_handler\nnanobot/agent/decision/cancellation_handler.py:11:0: C0413: Import \"from ..task import Task\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/cancellation_handler.py:12:0: C0413: Import \"from .models import CancellationRequest, DecisionRequest, DecisionResult\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/cancellation_handler.py:47:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/cancellation_handler.py:65:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/decision/cancellation_handler.py:66:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/cancellation_handler.py:117:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/cancellation_handler.py:141:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/cancellation_handler.py:163:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/cancellation_handler.py:17:0: R0903: Too few public methods (1/2) (too-few-public-methods)\n************* Module nanobot.agent.decision.new_message_handler\nnanobot/agent/decision/new_message_handler.py:14:0: C0413: Import \"from .models import DecisionRequest, DecisionResult, NewMessageRequest\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/new_message_handler.py:90:16: W0621: Redefining name 'uuid' from outer scope (line 6) (redefined-outer-name)\nnanobot/agent/decision/new_message_handler.py:82:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/new_message_handler.py:118:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/decision/new_message_handler.py:90:16: W0404: Reimport 'uuid' (imported line 6) (reimported)\nnanobot/agent/decision/new_message_handler.py:90:16: C0415: Import outside toplevel (uuid) (import-outside-toplevel)\nnanobot/agent/decision/new_message_handler.py:119:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/new_message_handler.py:127:42: W0613: Unused argument 'context' (unused-argument)\nnanobot/agent/decision/new_message_handler.py:6:0: W0611: Unused import uuid (unused-import)\n************* Module nanobot.agent.decision.subagent_result_handler\nnanobot/agent/decision/subagent_result_handler.py:11:0: C0413: Import \"from ..task import Task\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/subagent_result_handler.py:12:0: C0413: Import \"from .models import DecisionRequest, DecisionResult, SubagentResultRequest\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/subagent_result_handler.py:47:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/subagent_result_handler.py:65:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/decision/subagent_result_handler.py:66:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/subagent_result_handler.py:88:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/subagent_result_handler.py:92:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/decision/subagent_result_handler.py:99:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/subagent_result_handler.py:115:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/subagent_result_handler.py:145:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/subagent_result_handler.py:175:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/subagent_result_handler.py:163:45: W0613: Unused argument 'task' (unused-argument)\nnanobot/agent/decision/subagent_result_handler.py:17:0: R0903: Too few public methods (1/2) (too-few-public-methods)\n************* Module nanobot.agent.decision.decision_maker\nnanobot/agent/decision/decision_maker.py:11:0: C0413: Import \"from .cancellation_handler import CancellationHandler\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/decision_maker.py:12:0: C0413: Import \"from .correction_handler import CorrectionHandler\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/decision_maker.py:13:0: C0413: Import \"from .models import DecisionRequest, DecisionResult\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/decision_maker.py:14:0: C0413: Import \"from .new_message_handler import NewMessageHandler\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/decision_maker.py:15:0: C0413: Import \"from .subagent_result_handler import SubagentResultHandler\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/decision_maker.py:57:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/decision_maker.py:61:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/decision_maker.py:72:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/decision/decision_maker.py:70:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/decision_maker.py:73:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/decision_maker.py:90:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\n************* Module nanobot.agent.decision.correction_handler\nnanobot/agent/decision/correction_handler.py:11:0: C0413: Import \"from ..task import Task\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/correction_handler.py:12:0: C0413: Import \"from .models import CorrectionRequest, DecisionRequest, DecisionResult\" should be placed at the top of the module (wrong-import-position)\nnanobot/agent/decision/correction_handler.py:47:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/correction_handler.py:65:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/decision/correction_handler.py:66:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/correction_handler.py:110:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/correction_handler.py:113:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/decision/correction_handler.py:142:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/decision/correction_handler.py:17:0: R0903: Too few public methods (1/2) (too-few-public-methods)\n************* Module nanobot.agent.monitoring.state_tracker\nnanobot/agent/monitoring/state_tracker.py:24:0: R0902: Too many instance attributes (10/7) (too-many-instance-attributes)\nnanobot/agent/monitoring/state_tracker.py:38:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/monitoring/state_tracker.py:38:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\n************* Module nanobot.agent.monitoring.opentelemetry\nnanobot/agent/monitoring/opentelemetry.py:73:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/opentelemetry.py:63:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/opentelemetry.py:110:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/opentelemetry.py:129:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/opentelemetry.py:147:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/opentelemetry.py:280:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/opentelemetry.py:290:4: C0116: Missing function or method docstring (missing-function-docstring)\nnanobot/agent/monitoring/opentelemetry.py:293:4: C0116: Missing function or method docstring (missing-function-docstring)\nnanobot/agent/monitoring/opentelemetry.py:296:4: C0116: Missing function or method docstring (missing-function-docstring)\nnanobot/agent/monitoring/opentelemetry.py:299:4: C0116: Missing function or method docstring (missing-function-docstring)\nnanobot/agent/monitoring/opentelemetry.py:302:4: C0116: Missing function or method docstring (missing-function-docstring)\nnanobot/agent/monitoring/opentelemetry.py:5:0: W0611: Unused import time (unused-import)\nnanobot/agent/monitoring/opentelemetry.py:7:0: W0611: Unused ContextVar imported from contextvars (unused-import)\nnanobot/agent/monitoring/opentelemetry.py:8:0: W0611: Unused List imported from typing (unused-import)\nnanobot/agent/monitoring/opentelemetry.py:8:0: W0611: Unused Optional imported from typing (unused-import)\nnanobot/agent/monitoring/opentelemetry.py:16:0: W0611: Unused SpanAttributes imported from opentelemetry.semconv.trace (unused-import)\n************* Module nanobot.agent.monitoring.logger\nnanobot/agent/monitoring/logger.py:101:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/monitoring/logger.py:101:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/monitoring/logger.py:154:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/monitoring/logger.py:154:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/monitoring/logger.py:10:0: W0611: Unused Any imported from typing (unused-import)\nnanobot/agent/monitoring/logger.py:10:0: W0611: Unused Dict imported from typing (unused-import)\n************* Module nanobot.agent.monitoring.debugger\nnanobot/agent/monitoring/debugger.py:120:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/monitoring/debugger.py:120:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/monitoring/debugger.py:148:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/monitoring/debugger.py:148:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/monitoring/debugger.py:262:8: C0206: Consider iterating with .items() (consider-using-dict-items)\nnanobot/agent/monitoring/debugger.py:13:0: R0904: Too many public methods (22/20) (too-many-public-methods)\n************* Module nanobot.agent.monitoring.metrics_collector\nnanobot/agent/monitoring/metrics_collector.py:14:0: R0902: Too many instance attributes (10/7) (too-many-instance-attributes)\nnanobot/agent/monitoring/metrics_collector.py:28:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/monitoring/metrics_collector.py:28:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/monitoring/metrics_collector.py:157:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/agent/monitoring/metrics_collector.py:157:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/agent/monitoring/metrics_collector.py:180:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/monitoring/metrics_collector.py:180:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/monitoring/metrics_collector.py:7:0: W0611: Unused field imported from dataclasses (unused-import)\nnanobot/agent/monitoring/metrics_collector.py:8:0: W0611: Unused List imported from typing (unused-import)\nnanobot/agent/monitoring/metrics_collector.py:8:0: W0611: Unused Optional imported from typing (unused-import)\n************* Module nanobot.agent.monitoring.health_checker\nnanobot/agent/monitoring/health_checker.py:91:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/health_checker.py:157:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/health_checker.py:205:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/health_checker.py:234:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/monitoring/health_checker.py:265:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/health_checker.py:255:12: C0415: Import outside toplevel (psutil) (import-outside-toplevel)\nnanobot/agent/monitoring/health_checker.py:283:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/monitoring/health_checker.py:273:12: C0415: Import outside toplevel (psutil) (import-outside-toplevel)\nnanobot/agent/monitoring/health_checker.py:5:0: W0611: Unused import subprocess (unused-import)\nnanobot/agent/monitoring/health_checker.py:13:0: W0611: Unused AgentState imported from state_tracker (unused-import)\n************* Module nanobot.agent.subagent.agno_subagent\nnanobot/agent/subagent/agno_subagent.py:234:0: C0301: Line too long (120/100) (line-too-long)\nnanobot/agent/subagent/agno_subagent.py:409:0: C0301: Line too long (134/100) (line-too-long)\nnanobot/agent/subagent/agno_subagent.py:420:0: C0301: Line too long (104/100) (line-too-long)\nnanobot/agent/subagent/agno_subagent.py:64:4: R0903: Too few public methods (0/2) (too-few-public-methods)\nnanobot/agent/subagent/agno_subagent.py:70:0: R0902: Too many instance attributes (12/7) (too-many-instance-attributes)\nnanobot/agent/subagent/agno_subagent.py:103:8: C0415: Import outside toplevel (nanobot.agent.subagent.hooks.SubagentHooks) (import-outside-toplevel)\nnanobot/agent/subagent/agno_subagent.py:103:8: E0611: No name 'hooks' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/subagent/agno_subagent.py:104:8: C0415: Import outside toplevel (nanobot.agent.subagent.interrupt_handler.InterruptHandler) (import-outside-toplevel)\nnanobot/agent/subagent/agno_subagent.py:104:8: E0611: No name 'interrupt_handler' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/subagent/agno_subagent.py:105:8: C0415: Import outside toplevel (nanobot.agent.subagent.risk_evaluator.RiskEvaluator) (import-outside-toplevel)\nnanobot/agent/subagent/agno_subagent.py:105:8: E0611: No name 'risk_evaluator' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/subagent/agno_subagent.py:113:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/subagent/agno_subagent.py:113:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/subagent/agno_subagent.py:119:8: W0613: Unused argument 'session_key' (unused-argument)\nnanobot/agent/subagent/agno_subagent.py:175:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/subagent/agno_subagent.py:175:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/subagent/agno_subagent.py:255:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/subagent/agno_subagent.py:328:48: W0613: Unused argument 'final_result' (unused-argument)\nnanobot/agent/subagent/agno_subagent.py:390:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/subagent/agno_subagent.py:390:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/subagent/agno_subagent.py:425:8: C0415: Import outside toplevel (nanobot.agent.prompt_builder.get_prompt_builder) (import-outside-toplevel)\nnanobot/agent/subagent/agno_subagent.py:12:0: W0611: Unused Task imported from nanobot.agent.task (unused-import)\n************* Module nanobot.agent.subagent.base_subagent\nnanobot/agent/subagent/base_subagent.py:109:0: C0301: Line too long (108/100) (line-too-long)\nnanobot/agent/subagent/base_subagent.py:257:0: C0301: Line too long (134/100) (line-too-long)\nnanobot/agent/subagent/base_subagent.py:24:0: R0902: Too many instance attributes (10/7) (too-many-instance-attributes)\nnanobot/agent/subagent/base_subagent.py:33:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/subagent/base_subagent.py:33:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/subagent/base_subagent.py:42:8: C0415: Import outside toplevel (nanobot.config.schema.ExecToolConfig) (import-outside-toplevel)\nnanobot/agent/subagent/base_subagent.py:55:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/subagent/base_subagent.py:55:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/subagent/base_subagent.py:96:18: E1120: No value for argument 'description' in method call (no-value-for-parameter)\nnanobot/agent/subagent/base_subagent.py:111:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/agent/subagent/base_subagent.py:111:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\nnanobot/agent/subagent/base_subagent.py:111:4: R0914: Too many local variables (20/15) (too-many-locals)\nnanobot/agent/subagent/base_subagent.py:225:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/subagent/base_subagent.py:238:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/agent/subagent/base_subagent.py:238:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/agent/subagent/base_subagent.py:274:8: C0415: Import outside toplevel (nanobot.agent.prompt_builder.get_prompt_builder) (import-outside-toplevel)\n************* Module nanobot.agent.subagent.hooks\nnanobot/agent/subagent/hooks.py:9:0: E0611: No name 'agno_subagent' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/subagent/hooks.py:193:23: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/subagent/hooks.py:202:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/subagent/hooks.py:368:12: C0206: Consider iterating with .items() (consider-using-dict-items)\nnanobot/agent/subagent/hooks.py:368:16: R1704: Redefining argument with the local name 'hook_type' (redefined-argument-from-local)\nnanobot/agent/subagent/hooks.py:424:61: W0613: Unused argument 'tools' (unused-argument)\nnanobot/agent/subagent/hooks.py:30:0: R0904: Too many public methods (27/20) (too-many-public-methods)\n************* Module nanobot.agent.subagent.risk_evaluator\nnanobot/agent/subagent/risk_evaluator.py:254:0: C0301: Line too long (111/100) (line-too-long)\nnanobot/agent/subagent/risk_evaluator.py:9:0: E0611: No name 'agno_subagent' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/subagent/risk_evaluator.py:120:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/subagent/risk_evaluator.py:128:14: W0613: Unused argument 'subagent_id' (unused-argument)\nnanobot/agent/subagent/risk_evaluator.py:182:14: W0613: Unused argument 'subagent_id' (unused-argument)\nnanobot/agent/subagent/risk_evaluator.py:226:32: W0613: Unused argument 'assessment' (unused-argument)\nnanobot/agent/subagent/risk_evaluator.py:233:32: W0613: Unused argument 'assessment' (unused-argument)\n************* Module nanobot.agent.subagent.interrupt_handler\nnanobot/agent/subagent/interrupt_handler.py:10:0: E0611: No name 'agno_subagent' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/subagent/interrupt_handler.py:109:53: W0613: Unused argument 'interrupt' (unused-argument)\nnanobot/agent/subagent/interrupt_handler.py:137:52: W0613: Unused argument 'interrupt' (unused-argument)\nnanobot/agent/subagent/interrupt_handler.py:142:53: W0613: Unused argument 'interrupt' (unused-argument)\nnanobot/agent/subagent/interrupt_handler.py:147:53: W0613: Unused argument 'interrupt' (unused-argument)\nnanobot/agent/subagent/interrupt_handler.py:245:37: W0212: Access to a protected member _subagent_map of a client class (protected-access)\nnanobot/agent/subagent/interrupt_handler.py:305:8: C0415: Import outside toplevel (re) (import-outside-toplevel)\nnanobot/agent/subagent/interrupt_handler.py:325:8: C0415: Import outside toplevel (re) (import-outside-toplevel)\n************* Module nanobot.agent.subagent.manager\nnanobot/agent/subagent/manager.py:322:0: C0325: Unnecessary parens after 'not' keyword (superfluous-parens)\nnanobot/agent/subagent/manager.py:9:0: E0611: No name 'agno_subagent' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/subagent/manager.py:10:0: E0611: No name 'models' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/subagent/manager.py:17:0: R0902: Too many instance attributes (9/7) (too-many-instance-attributes)\nnanobot/agent/subagent/manager.py:56:8: W0621: Redefining name 'SubagentTask' from outer scope (line 10) (redefined-outer-name)\nnanobot/agent/subagent/manager.py:90:8: W0621: Redefining name 'Task' from outer scope (line 11) (redefined-outer-name)\nnanobot/agent/subagent/manager.py:56:8: W0404: Reimport 'SubagentTask' (imported line 10) (reimported)\nnanobot/agent/subagent/manager.py:56:8: C0415: Import outside toplevel (nanobot.agent.subagent.models.SubagentTask) (import-outside-toplevel)\nnanobot/agent/subagent/manager.py:56:8: E0611: No name 'models' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/agent/subagent/manager.py:62:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:88:8: C0415: Import outside toplevel (uuid) (import-outside-toplevel)\nnanobot/agent/subagent/manager.py:90:8: W0404: Reimport 'Task' (imported line 11) (reimported)\nnanobot/agent/subagent/manager.py:90:8: C0415: Import outside toplevel (nanobot.agent.task_manager.Task) (import-outside-toplevel)\nnanobot/agent/subagent/manager.py:101:8: W0212: Access to a protected member _save_tasks of a client class (protected-access)\nnanobot/agent/subagent/manager.py:88:8: W0611: Unused import uuid (unused-import)\nnanobot/agent/subagent/manager.py:143:8: W0621: Redefining name 'Task' from outer scope (line 11) (redefined-outer-name)\nnanobot/agent/subagent/manager.py:115:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:143:8: W0404: Reimport 'Task' (imported line 11) (reimported)\nnanobot/agent/subagent/manager.py:143:8: C0415: Import outside toplevel (nanobot.agent.task_manager.Task) (import-outside-toplevel)\nnanobot/agent/subagent/manager.py:153:8: W0212: Access to a protected member _save_tasks of a client class (protected-access)\nnanobot/agent/subagent/manager.py:164:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:205:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/subagent/manager.py:199:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:206:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:242:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:246:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:255:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/subagent/manager.py:252:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:256:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:272:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:276:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:284:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/subagent/manager.py:281:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:285:12: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:333:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:305:8: W0613: Unused argument 'estimated_time_remaining' (unused-argument)\nnanobot/agent/subagent/manager.py:419:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:450:16: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:492:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:525:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:539:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/agent/subagent/manager.py:607:20: W0621: Redefining name 'Task' from outer scope (line 11) (redefined-outer-name)\nnanobot/agent/subagent/manager.py:607:20: W0404: Reimport 'Task' (imported line 11) (reimported)\nnanobot/agent/subagent/manager.py:607:20: C0415: Import outside toplevel (nanobot.agent.task_manager.Task) (import-outside-toplevel)\nnanobot/agent/subagent/manager.py:618:20: W0212: Access to a protected member _save_tasks of a client class (protected-access)\nnanobot/agent/subagent/manager.py:635:20: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:639:4: E0102: method already defined line 507 (function-redefined)\nnanobot/agent/subagent/manager.py:665:8: W1203: Use lazy % formatting in logging functions (logging-fstring-interpolation)\nnanobot/agent/subagent/manager.py:17:0: R0904: Too many public methods (24/20) (too-many-public-methods)\nnanobot/agent/subagent/manager.py:7:0: W0611: Unused Callable imported from typing (unused-import)\nnanobot/agent/subagent/manager.py:11:0: W0611: Unused Task imported from nanobot.agent.task (unused-import)\nnanobot/agent/subagent/manager.py:11:0: W0611: Unused TaskStatus imported from nanobot.agent.task (unused-import)\n************* Module nanobot.agent.flow.models\nnanobot/agent/flow/models.py:55:4: C0115: Missing class docstring (missing-class-docstring)\nnanobot/agent/flow/models.py:55:4: R0903: Too few public methods (0/2) (too-few-public-methods)\nnanobot/agent/flow/models.py:101:4: C0115: Missing class docstring (missing-class-docstring)\nnanobot/agent/flow/models.py:101:4: R0903: Too few public methods (0/2) (too-few-public-methods)\nnanobot/agent/flow/models.py:179:4: C0115: Missing class docstring (missing-class-docstring)\nnanobot/agent/flow/models.py:179:4: R0903: Too few public methods (0/2) (too-few-public-methods)\nnanobot/agent/flow/models.py:189:15: E1101: Instance of 'FieldInfo' has no 'get' member (no-member)\nnanobot/agent/flow/models.py:200:15: E1101: Instance of 'FieldInfo' has no 'get' member (no-member)\nnanobot/agent/flow/models.py:11:0: W0611: Unused Callable imported from typing (unused-import)\nnanobot/agent/flow/models.py:11:0: W0611: Unused Generic imported from typing (unused-import)\nnanobot/agent/flow/models.py:11:0: W0611: Unused Union imported from typing (unused-import)\n************* Module nanobot.agent.flow.wizard\nnanobot/agent/flow/wizard.py:19:4: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/flow/wizard.py:25:4: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/flow/wizard.py:158:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/flow/wizard.py:223:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/flow/wizard.py:217:16: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/flow/wizard.py:191:4: R0911: Too many return statements (7/6) (too-many-return-statements)\nnanobot/agent/flow/wizard.py:9:0: W0611: Unused List imported from typing (unused-import)\nnanobot/agent/flow/wizard.py:13:0: W0611: Unused FlowResult imported from models (unused-import)\nnanobot/agent/flow/wizard.py:13:0: W0611: Unused FlowState imported from models (unused-import)\n************* Module nanobot.agent.flow.progress\nnanobot/agent/flow/progress.py:50:8: C0104: Disallowed name \"bar\" (disallowed-name)\nnanobot/agent/flow/progress.py:124:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/agent/flow/progress.py:141:0: R0902: Too many instance attributes (8/7) (too-many-instance-attributes)\nnanobot/agent/flow/progress.py:187:43: W0613: Unused argument 'output' (unused-argument)\nnanobot/agent/flow/progress.py:238:11: R1716: Simplify chained comparison between the operands (chained-comparison)\nnanobot/agent/flow/progress.py:272:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/flow/progress.py:285:16: E0602: Undefined variable 'Wizard' (undefined-variable)\nnanobot/agent/flow/progress.py:287:17: E0602: Undefined variable 'FlowContext' (undefined-variable)\nnanobot/agent/flow/progress.py:304:27: E0602: Undefined variable 'FlowResult' (undefined-variable)\nnanobot/agent/flow/progress.py:353:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/flow/progress.py:318:26: E0602: Undefined variable 'WizardStepError' (undefined-variable)\nnanobot/agent/flow/progress.py:334:23: E0602: Undefined variable 'FlowResult' (undefined-variable)\nnanobot/agent/flow/progress.py:344:19: E0602: Undefined variable 'FlowResult' (undefined-variable)\nnanobot/agent/flow/progress.py:357:19: E0602: Undefined variable 'FlowResult' (undefined-variable)\nnanobot/agent/flow/progress.py:382:18: W0212: Access to a protected member _step_handlers of a client class (protected-access)\nnanobot/agent/flow/progress.py:418:19: W0212: Access to a protected member _evaluate_condition of a client class (protected-access)\nnanobot/agent/flow/progress.py:397:40: W0613: Unused argument 'result' (unused-argument)\nnanobot/agent/flow/progress.py:9:0: W0611: Unused import math (unused-import)\nnanobot/agent/flow/progress.py:11:0: W0611: Unused Dict imported from typing (unused-import)\n************* Module nanobot.agent.flow.manager\nnanobot/agent/flow/manager.py:22:4: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/flow/manager.py:28:4: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/flow/manager.py:34:4: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/agent/flow/manager.py:270:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/agent/flow/manager.py:12:0: W0611: Unused Union imported from typing (unused-import)\nnanobot/agent/flow/manager.py:16:0: W0611: Unused FlowProgress imported from models (unused-import)\nnanobot/agent/flow/manager.py:16:0: W0611: Unused FlowResult imported from models (unused-import)\n************* Module nanobot.cli.commands\nnanobot/cli/commands.py:21:0: C0116: Missing function or method docstring (missing-function-docstring)\nnanobot/cli/commands.py:34:4: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/cli/commands.py:29:4: W0613: Unused argument 'version' (unused-argument)\nnanobot/cli/commands.py:45:4: C0415: Import outside toplevel (nanobot.config.loader.get_config_path, nanobot.config.loader.save_config) (import-outside-toplevel)\nnanobot/cli/commands.py:46:4: C0415: Import outside toplevel (nanobot.config.schema.Config) (import-outside-toplevel)\nnanobot/cli/commands.py:47:4: C0415: Import outside toplevel (nanobot.utils.helpers.get_workspace_path) (import-outside-toplevel)\nnanobot/cli/commands.py:156:0: R0914: Too many local variables (29/15) (too-many-locals)\nnanobot/cli/commands.py:207:4: W0621: Redefining name 'agent' from outer scope (line 292) (redefined-outer-name)\nnanobot/cli/commands.py:161:4: C0415: Import outside toplevel (nanobot.agent.loop.AgentLoop) (import-outside-toplevel)\nnanobot/cli/commands.py:162:4: C0415: Import outside toplevel (nanobot.bus.queue.MessageBus) (import-outside-toplevel)\nnanobot/cli/commands.py:163:4: C0415: Import outside toplevel (nanobot.channels.manager.ChannelManager) (import-outside-toplevel)\nnanobot/cli/commands.py:164:4: C0415: Import outside toplevel (nanobot.config.loader.get_data_dir, nanobot.config.loader.load_config) (import-outside-toplevel)\nnanobot/cli/commands.py:165:4: C0415: Import outside toplevel (nanobot.cron.service.CronService) (import-outside-toplevel)\nnanobot/cli/commands.py:166:4: C0415: Import outside toplevel (nanobot.cron.types.CronJob) (import-outside-toplevel)\nnanobot/cli/commands.py:167:4: C0415: Import outside toplevel (nanobot.heartbeat.service.HeartbeatService) (import-outside-toplevel)\nnanobot/cli/commands.py:168:4: C0415: Import outside toplevel (nanobot.providers.litellm_provider.LiteLLMProvider) (import-outside-toplevel)\nnanobot/cli/commands.py:171:8: C0415: Import outside toplevel (logging) (import-outside-toplevel)\nnanobot/cli/commands.py:226:12: C0415: Import outside toplevel (nanobot.bus.events.OutboundMessage) (import-outside-toplevel)\nnanobot/cli/commands.py:156:0: R0915: Too many statements (57/50) (too-many-statements)\nnanobot/cli/commands.py:292:0: R0914: Too many local variables (16/15) (too-many-locals)\nnanobot/cli/commands.py:299:4: C0415: Import outside toplevel (nanobot.agent.loop.AgentLoop) (import-outside-toplevel)\nnanobot/cli/commands.py:300:4: C0415: Import outside toplevel (nanobot.bus.queue.MessageBus) (import-outside-toplevel)\nnanobot/cli/commands.py:301:4: C0415: Import outside toplevel (nanobot.config.loader.load_config) (import-outside-toplevel)\nnanobot/cli/commands.py:302:4: C0415: Import outside toplevel (nanobot.providers.litellm_provider.LiteLLMProvider) (import-outside-toplevel)\nnanobot/cli/commands.py:367:4: C0415: Import outside toplevel (nanobot.config.loader.load_config) (import-outside-toplevel)\nnanobot/cli/commands.py:392:4: C0415: Import outside toplevel (shutil) (import-outside-toplevel)\nnanobot/cli/commands.py:393:4: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/cli/commands.py:459:4: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)\nnanobot/cli/commands.py:484:4: W0622: Redefining built-in 'all' (redefined-builtin)\nnanobot/cli/commands.py:525:8: W0621: Redefining name 'status' from outer scope (line 845) (redefined-outer-name)\nnanobot/cli/commands.py:487:4: C0415: Import outside toplevel (nanobot.config.loader.get_data_dir) (import-outside-toplevel)\nnanobot/cli/commands.py:488:4: C0415: Import outside toplevel (nanobot.cron.service.CronService) (import-outside-toplevel)\nnanobot/cli/commands.py:506:4: C0415: Import outside toplevel (time) (import-outside-toplevel)\nnanobot/cli/commands.py:533:0: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/cli/commands.py:533:0: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/cli/commands.py:533:0: R0914: Too many local variables (17/15) (too-many-locals)\nnanobot/cli/commands.py:550:4: C0415: Import outside toplevel (nanobot.config.loader.get_data_dir) (import-outside-toplevel)\nnanobot/cli/commands.py:551:4: C0415: Import outside toplevel (nanobot.cron.service.CronService) (import-outside-toplevel)\nnanobot/cli/commands.py:552:4: C0415: Import outside toplevel (nanobot.cron.types.CronSchedule) (import-outside-toplevel)\nnanobot/cli/commands.py:560:8: C0415: Import outside toplevel (datetime) (import-outside-toplevel)\nnanobot/cli/commands.py:571:10: E1123: Unexpected keyword argument 'message' in method call (unexpected-keyword-arg)\nnanobot/cli/commands.py:571:10: E1123: Unexpected keyword argument 'deliver' in method call (unexpected-keyword-arg)\nnanobot/cli/commands.py:571:10: E1123: Unexpected keyword argument 'to' in method call (unexpected-keyword-arg)\nnanobot/cli/commands.py:571:10: E1123: Unexpected keyword argument 'channel' in method call (unexpected-keyword-arg)\nnanobot/cli/commands.py:588:4: C0415: Import outside toplevel (nanobot.config.loader.get_data_dir) (import-outside-toplevel)\nnanobot/cli/commands.py:589:4: C0415: Import outside toplevel (nanobot.cron.service.CronService) (import-outside-toplevel)\nnanobot/cli/commands.py:614:8: W0621: Redefining name 'status' from outer scope (line 845) (redefined-outer-name)\nnanobot/cli/commands.py:606:4: C0415: Import outside toplevel (nanobot.config.loader.get_data_dir) (import-outside-toplevel)\nnanobot/cli/commands.py:607:4: C0415: Import outside toplevel (nanobot.cron.service.CronService) (import-outside-toplevel)\nnanobot/cli/commands.py:626:4: C0415: Import outside toplevel (nanobot.config.loader.get_data_dir) (import-outside-toplevel)\nnanobot/cli/commands.py:627:4: C0415: Import outside toplevel (nanobot.cron.service.CronService) (import-outside-toplevel)\nnanobot/cli/commands.py:654:4: C0415: Import outside toplevel (nanobot.agent.workflow.models.TaskState, nanobot.agent.workflow.models.WorkflowStep) (import-outside-toplevel)\nnanobot/cli/commands.py:655:4: C0415: Import outside toplevel (nanobot.agent.workflow.workflow_manager.WorkflowManager) (import-outside-toplevel)\nnanobot/cli/commands.py:689:4: C0415: Import outside toplevel (nanobot.agent.workflow.workflow_manager.WorkflowManager) (import-outside-toplevel)\nnanobot/cli/commands.py:705:4: C0415: Import outside toplevel (time) (import-outside-toplevel)\nnanobot/cli/commands.py:727:4: C0415: Import outside toplevel (nanobot.agent.workflow.workflow_manager.WorkflowManager) (import-outside-toplevel)\nnanobot/cli/commands.py:759:4: C0415: Import outside toplevel (nanobot.agent.workflow.workflow_manager.WorkflowManager) (import-outside-toplevel)\nnanobot/cli/commands.py:780:4: C0415: Import outside toplevel (nanobot.agent.workflow.workflow_manager.WorkflowManager) (import-outside-toplevel)\nnanobot/cli/commands.py:796:4: C0415: Import outside toplevel (nanobot.agent.workflow.workflow_manager.WorkflowManager) (import-outside-toplevel)\nnanobot/cli/commands.py:812:4: C0415: Import outside toplevel (nanobot.agent.workflow.workflow_manager.WorkflowManager) (import-outside-toplevel)\nnanobot/cli/commands.py:828:4: C0415: Import outside toplevel (nanobot.agent.workflow.workflow_manager.WorkflowManager) (import-outside-toplevel)\nnanobot/cli/commands.py:847:4: C0415: Import outside toplevel (nanobot.config.loader.get_config_path, nanobot.config.loader.load_config) (import-outside-toplevel)\n************* Module nanobot.heartbeat.service\nnanobot/heartbeat/service.py:66:4: C0116: Missing function or method docstring (missing-function-docstring)\nnanobot/heartbeat/service.py:74:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/heartbeat/service.py:104:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/heartbeat/service.py:130:19: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.commands.registry\nnanobot/commands/registry.py:17:8: C0415: Import outside toplevel (commit.CommitCommand) (import-outside-toplevel)\nnanobot/commands/registry.py:18:8: C0415: Import outside toplevel (debug.DebugCommand) (import-outside-toplevel)\nnanobot/commands/registry.py:19:8: C0415: Import outside toplevel (fix.FixCommand) (import-outside-toplevel)\nnanobot/commands/registry.py:20:8: C0415: Import outside toplevel (optimize.OptimizeCommand) (import-outside-toplevel)\nnanobot/commands/registry.py:21:8: C0415: Import outside toplevel (review.ReviewCommand) (import-outside-toplevel)\nnanobot/commands/registry.py:22:8: C0415: Import outside toplevel (test.TestCommand) (import-outside-toplevel)\n************* Module nanobot.commands.commit\nnanobot/commands/commit.py:30:17: W1510: 'subprocess.run' used without explicitly defining the value for 'check'. (subprocess-run-check)\nnanobot/commands/commit.py:41:8: W1510: 'subprocess.run' used without explicitly defining the value for 'check'. (subprocess-run-check)\n************* Module nanobot.commands\nnanobot/commands/__init__.py:6:0: C0103: Constant name \"_registry\" doesn't conform to UPPER_CASE naming style (invalid-name)\nnanobot/commands/__init__.py:11:4: W0603: Using the global statement (global-statement)\n************* Module nanobot.commands.base\nnanobot/commands/base.py:14:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/commands/base.py:20:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/commands/base.py:30:8: W0107: Unnecessary pass statement (unnecessary-pass)\n************* Module nanobot.cron.service\nnanobot/cron/service.py:43:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/cron/service.py:38:12: C0415: Import outside toplevel (croniter.croniter) (import-outside-toplevel)\nnanobot/cron/service.py:119:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/cron/service.py:275:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/cron/service.py:299:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/cron/service.py:313:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/cron/service.py:308:44: W0613: Unused argument 'job' (unused-argument)\nnanobot/cron/service.py:331:4: R0913: Too many arguments (7/5) (too-many-arguments)\nnanobot/cron/service.py:331:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)\nnanobot/cron/service.py:368:4: R0913: Too many arguments (9/5) (too-many-arguments)\nnanobot/cron/service.py:368:4: R0917: Too many positional arguments (9/5) (too-many-positional-arguments)\nnanobot/cron/service.py:386:4: R0913: Too many arguments (8/5) (too-many-arguments)\nnanobot/cron/service.py:386:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)\nnanobot/cron/service.py:397:17: E1123: Unexpected keyword argument 'alertConditions' in constructor call (unexpected-keyword-arg)\nnanobot/cron/service.py:405:4: R0913: Too many arguments (10/5) (too-many-arguments)\nnanobot/cron/service.py:405:4: R0917: Too many positional arguments (10/5) (too-many-positional-arguments)\nnanobot/cron/service.py:500:8: C0415: Import outside toplevel (nanobot.cron.config_loader.CronConfigLoader) (import-outside-toplevel)\nnanobot/cron/service.py:537:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/cron/service.py:492:8: W0201: Attribute '_agent_trigger' defined outside __init__ (attribute-defined-outside-init)\nnanobot/cron/service.py:496:8: W0201: Attribute '_status_monitor' defined outside __init__ (attribute-defined-outside-init)\n************* Module nanobot.cron.config_loader\nnanobot/cron/config_loader.py:80:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/cron/config_loader.py:137:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/cron/config_loader.py:198:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/cron/config_loader.py:215:8: C0415: Import outside toplevel (uuid) (import-outside-toplevel)\n************* Module nanobot.cron.status_monitor\nnanobot/cron/status_monitor.py:13:0: E0611: No name 'SubagentManager' in module 'nanobot.agent.subagent' (no-name-in-module)\nnanobot/cron/status_monitor.py:85:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/cron/status_monitor.py:106:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/cron/status_monitor.py:93:14: W0613: Unused argument 'agent' (unused-argument)\nnanobot/cron/status_monitor.py:144:41: W0613: Unused argument 'status' (unused-argument)\nnanobot/cron/status_monitor.py:337:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/cron/status_monitor.py:384:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/cron/status_monitor.py:361:12: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/cron/status_monitor.py:390:14: W0613: Unused argument 'name' (unused-argument)\nnanobot/cron/status_monitor.py:390:25: W0613: Unused argument 'config' (unused-argument)\nnanobot/cron/status_monitor.py:390:49: W0613: Unused argument 'status' (unused-argument)\nnanobot/cron/status_monitor.py:398:14: W0613: Unused argument 'name' (unused-argument)\nnanobot/cron/status_monitor.py:398:25: W0613: Unused argument 'config' (unused-argument)\nnanobot/cron/status_monitor.py:398:49: W0613: Unused argument 'status' (unused-argument)\n************* Module nanobot.cron.types\nnanobot/cron/types.py:23:0: R0902: Too many instance attributes (10/7) (too-many-instance-attributes)\nnanobot/cron/types.py:56:0: R0902: Too many instance attributes (11/7) (too-many-instance-attributes)\n************* Module nanobot.cron.agent_trigger\nnanobot/cron/agent_trigger.py:53:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/cron/agent_trigger.py:77:8: R1705: Unnecessary \"elif\" after \"return\", remove the leading \"el\" from \"elif\" (no-else-return)\nnanobot/cron/agent_trigger.py:108:8: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/cron/agent_trigger.py:112:38: W0212: Access to a protected member _running_tasks of a client class (protected-access)\nnanobot/cron/agent_trigger.py:91:45: W0613: Unused argument 'params' (unused-argument)\nnanobot/cron/agent_trigger.py:120:45: W0613: Unused argument 'params' (unused-argument)\nnanobot/cron/agent_trigger.py:159:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/cron/agent_trigger.py:169:12: R1705: Unnecessary \"else\" after \"return\", remove the \"else\" and de-indent the code inside it (no-else-return)\nnanobot/cron/agent_trigger.py:178:35: W0613: Unused argument 'params' (unused-argument)\n************* Module nanobot.channels.tui_channel\nnanobot/channels/tui_channel.py:47:12: C0103: Attribute name \"Console\" doesn't conform to snake_case naming style (invalid-name)\nnanobot/channels/tui_channel.py:48:12: C0103: Attribute name \"Panel\" doesn't conform to snake_case naming style (invalid-name)\nnanobot/channels/tui_channel.py:13:0: R0902: Too many instance attributes (10/7) (too-many-instance-attributes)\nnanobot/channels/tui_channel.py:44:12: C0415: Import outside toplevel (rich.console.Console) (import-outside-toplevel)\nnanobot/channels/tui_channel.py:45:12: C0415: Import outside toplevel (rich.panel.Panel) (import-outside-toplevel)\nnanobot/channels/tui_channel.py:139:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/tui_channel.py:158:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/tui_channel.py:149:12: C0415: Import outside toplevel (select) (import-outside-toplevel)\nnanobot/channels/tui_channel.py:171:63: W0613: Unused argument 'msg_type' (unused-argument)\nnanobot/channels/tui_channel.py:185:64: W0613: Unused argument 'msg_type' (unused-argument)\nnanobot/channels/tui_channel.py:209:8: C0415: Import outside toplevel (os) (import-outside-toplevel)\nnanobot/channels/tui_channel.py:5:0: W0611: Unused AsyncGenerator imported from typing (unused-import)\nnanobot/channels/tui_channel.py:5:0: W0611: Unused Dict imported from typing (unused-import)\n************* Module nanobot.channels.whatsapp\nnanobot/channels/whatsapp.py:108:0: C0301: Line too long (115/100) (line-too-long)\nnanobot/channels/whatsapp.py:32:8: C0415: Import outside toplevel (websockets) (import-outside-toplevel)\nnanobot/channels/whatsapp.py:56:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/whatsapp.py:51:31: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/whatsapp.py:83:15: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.channels.telegram\nnanobot/channels/telegram.py:124:8: C0415: Import outside toplevel (telegram.ext.CommandHandler) (import-outside-toplevel)\nnanobot/channels/telegram.py:175:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/telegram.py:182:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/telegram.py:186:30: W0613: Unused argument 'context' (unused-argument)\nnanobot/channels/telegram.py:197:4: R0914: Too many local variables (21/15) (too-many-locals)\nnanobot/channels/telegram.py:281:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/telegram.py:252:16: C0415: Import outside toplevel (pathlib.Path) (import-outside-toplevel)\nnanobot/channels/telegram.py:263:19: R1714: Consider merging these comparisons with 'in' by using 'media_type in ('voice', 'audio')'. Use a set instead if elements are hashable. (consider-using-in)\nnanobot/channels/telegram.py:264:20: C0415: Import outside toplevel (nanobot.providers.transcription.GroqTranscriptionProvider) (import-outside-toplevel)\nnanobot/channels/telegram.py:197:4: R0912: Too many branches (14/12) (too-many-branches)\nnanobot/channels/telegram.py:197:4: R0915: Too many statements (57/50) (too-many-statements)\nnanobot/channels/telegram.py:198:30: W0613: Unused argument 'context' (unused-argument)\n************* Module nanobot.channels.route_strategy\nnanobot/channels/route_strategy.py:30:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/channels/route_strategy.py:43:8: W0107: Unnecessary pass statement (unnecessary-pass)\n************* Module nanobot.channels.feishu\nnanobot/channels/feishu.py:111:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/feishu.py:130:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/feishu.py:129:16: E1101: Instance of 'Client' has no 'stop' member (no-member)\nnanobot/channels/feishu.py:156:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/feishu.py:215:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/feishu.py:281:15: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.channels.webchat_channel\nnanobot/channels/webchat_channel.py:13:0: R0902: Too many instance attributes (10/7) (too-many-instance-attributes)\nnanobot/channels/webchat_channel.py:105:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/webchat_channel.py:129:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/webchat_channel.py:116:12: C0415: Import outside toplevel (websockets.connect) (import-outside-toplevel)\nnanobot/channels/webchat_channel.py:155:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/webchat_channel.py:193:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/webchat_channel.py:5:0: W0611: Unused AsyncGenerator imported from typing (unused-import)\n************* Module nanobot.channels.manager\nnanobot/channels/manager.py:37:16: C0415: Import outside toplevel (nanobot.channels.telegram.TelegramChannel) (import-outside-toplevel)\nnanobot/channels/manager.py:51:16: C0415: Import outside toplevel (nanobot.channels.whatsapp.WhatsAppChannel) (import-outside-toplevel)\nnanobot/channels/manager.py:63:16: C0415: Import outside toplevel (nanobot.channels.feishu.FeishuChannel) (import-outside-toplevel)\nnanobot/channels/manager.py:107:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/channels/manager.py:122:27: W0718: Catching too general exception Exception (broad-exception-caught)\n************* Module nanobot.channels.base\nnanobot/channels/base.py:42:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/channels/base.py:47:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/channels/base.py:57:8: W0107: Unnecessary pass statement (unnecessary-pass)\nnanobot/channels/base.py:84:4: R0913: Too many arguments (6/5) (too-many-arguments)\nnanobot/channels/base.py:84:4: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)\n************* Module nanobot.session.manager\nnanobot/session/manager.py:140:15: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/session/manager.py:116:17: W1514: Using open without explicitly specifying an encoding (unspecified-encoding)\nnanobot/session/manager.py:148:13: W1514: Using open without explicitly specifying an encoding (unspecified-encoding)\nnanobot/session/manager.py:209:19: W0718: Catching too general exception Exception (broad-exception-caught)\nnanobot/session/manager.py:196:21: W1514: Using open without explicitly specifying an encoding (unspecified-encoding)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agents.agno_main_agent:[198:259]\n==nanobot.agents.agno_subagent:[252:313]\n        except Exception as e:\n            logger.error(f\"创建文件系统工具包失败: {e}\")\n            return None\n\n    def _create_web_toolkit(self) -> Optional[Toolkit]:\n        \"\"\"创建 Web 工具包\"\"\"\n        try:\n            from nanobot.agent.tools.web import WebFetchTool, WebSearchTool\n\n            tools = []\n\n            # web_search - use real WebSearchTool\n            search_tool = WebSearchTool()\n\n            def web_search(query: str, count: int = 5) -> str:\n                \"\"\"搜索网络\"\"\"\n                try:\n                    import asyncio\n\n                    # Run the async search tool\n                    result = asyncio.run(search_tool.execute(query=query, count=count))\n                    return result\n                except Exception as e:\n                    logger.error(f\"Web search failed: {e}\")\n                    return f\"搜索失败: {e}\"\n\n            tools.append(\n                Function(\n                    name=\"web_search\",\n                    description=\"搜索网络，使用 Brave Search API。需要 BRAVE_API_KEY 环境变量。\",\n                    func=web_search,\n                )\n            )\n\n            # web_fetch - use real WebFetchTool\n            fetch_tool = WebFetchTool()\n\n            def web_fetch(url: str, extract_mode: str = \"markdown\") -> str:\n                \"\"\"获取网页内容\"\"\"\n                try:\n                    import asyncio\n\n                    # Run the async fetch tool\n                    result = asyncio.run(\n                        fetch_tool.execute(url=url, extract_mode=extract_mode)\n                    )\n                    return result\n                except Exception as e:\n                    logger.error(f\"Web fetch failed: {e}\")\n                    return f\"获取网页失败: {e}\"\n\n            tools.append(\n                Function(\n                    name=\"web_fetch\",\n                    description=\"获取网页内容，转换为 markdown 或纯文本。\",\n                    func=web_fetch,\n                )\n            )\n\n            return Toolkit(\n                name=\"web\", (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agents.agno_main_agent:[260:302]\n==nanobot.agents.agno_subagent:[314:356]\n                tools=tools,\n            )\n        except Exception as e:\n            logger.error(f\"创建 Web 工具包失败: {e}\")\n            return None\n\n    def _create_shell_toolkit(self) -> Optional[Toolkit]:\n        \"\"\"创建 Shell 工具包\"\"\"\n        try:\n            tools = []\n\n            # execute_command\n            def execute_command(command: str) -> str:\n                \"\"\"执行 Shell 命令\"\"\"\n                import subprocess\n\n                try:\n                    result = subprocess.run(\n                        command,\n                        shell=True,\n                        cwd=self.workspace,\n                        capture_output=True,\n                        text=True,\n                        timeout=30,\n                    )\n                    if result.returncode == 0:\n                        return result.stdout or \"命令执行成功\"\n                    else:\n                        return f\"命令执行失败: {result.stderr}\"\n                except subprocess.TimeoutExpired:\n                    return \"命令执行超时\"\n                except Exception as e:\n                    return f\"执行命令失败: {e}\"\n\n            tools.append(\n                Function(\n                    name=\"execute_command\",\n                    description=\"执行 Shell 命令\",\n                    func=execute_command,\n                )\n            )\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agents.agno_main_agent:[160:197]\n==nanobot.agents.agno_subagent:[197:235]\n                with open(file_path, \"r\", encoding=\"utf-8\") as f:\n                    return f.read()\n\n            tools.append(\n                Function(name=\"read_file\", description=\"读取文件内容\", func=read_file)\n            )\n\n            # write_file\n            def write_file(path: str, content: str) -> str:\n                \"\"\"写入文件内容\"\"\"\n                file_path = self.workspace / path\n                file_path.parent.mkdir(parents=True, exist_ok=True)\n                with open(file_path, \"w\", encoding=\"utf-8\") as f:\n                    f.write(content)\n                return f\"成功写入文件: {path}\"\n\n            tools.append(\n                Function(name=\"write_file\", description=\"写入文件内容\", func=write_file)\n            )\n\n            # list_directory\n            def list_directory(path: str = \".\") -> str:\n                \"\"\"列出目录内容\"\"\"\n                dir_path = self.workspace / path\n                if not dir_path.exists():\n                    return f\"目录不存在: {path}\"\n                items = [item.name for item in dir_path.iterdir()]\n                return \"\\n\".join(items)\n\n            tools.append(\n                Function(\n                    name=\"list_directory\",\n                    description=\"列出目录内容\",\n                    func=list_directory,\n                )\n            )\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agents.agno_main_agent:[21:50]\n==nanobot.agents.agno_subagent:[21:50]\ntry:\n    from agno import Agent, Function, Knowledge, Toolkit\n\n    AGNO_AVAILABLE = True\nexcept ImportError:\n    AGNO_AVAILABLE = False\n    Agent = None\n    Knowledge = None\n    Toolkit = None\n    Function = None\n\ntry:\n    from nanobot.agent.prompt_system import PromptSystemV2, get_prompt_system_v2\n\n    PROMPT_SYSTEM_V2_AVAILABLE = True\nexcept ImportError:\n    PROMPT_SYSTEM_V2_AVAILABLE = False\n    PromptSystemV2 = None\n    get_prompt_system_v2 = None\n\ntry:\n    from nanobot.config.schema import NanobotConfig\n\n    CONFIG_AVAILABLE = True\nexcept ImportError:\n    CONFIG_AVAILABLE = False\n    NanobotConfig = None\n\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agents.agno_main_agent:[131:160]\n==nanobot.agents.agno_subagent:[166:195]\n        toolkits = []\n\n        # 文件系统工具包\n        file_toolkit = self._create_filesystem_toolkit()\n        if file_toolkit:\n            toolkits.append(file_toolkit)\n\n        # Web 工具包\n        web_toolkit = self._create_web_toolkit()\n        if web_toolkit:\n            toolkits.append(web_toolkit)\n\n        # Shell 工具包\n        shell_toolkit = self._create_shell_toolkit()\n        if shell_toolkit:\n            toolkits.append(shell_toolkit)\n\n        logger.info(f\"创建了 {len(toolkits)} 个工具包\")\n        return toolkits\n\n    def _create_filesystem_toolkit(self) -> Optional[Toolkit]:\n        \"\"\"创建文件系统工具包\"\"\"\n        try:\n            tools = []\n\n            # read_file\n            def read_file(path: str) -> str:\n                \"\"\"读取文件内容\"\"\"\n                file_path = self.workspace / path (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.loop:[333:347]\n==nanobot.agent.subagent.base_subagent:[167:182]\n            )\n\n            if response.has_tool_calls:\n                tool_call_dicts = [\n                    {\n                        \"id\": tc.id,\n                        \"type\": \"function\",\n                        \"function\": {\n                            \"name\": tc.name,\n                            \"arguments\": json.dumps(tc.arguments),\n                        },\n                    }\n                    for tc in response.tool_calls\n                ] (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.channels.base:[68:103]\n==nanobot.channels.webchat_channel:[205:233]\n        allow_list = getattr(self.config, \"allow_from\", [])\n\n        # If no allow list, allow everyone\n        if not allow_list:\n            return True\n\n        sender_str = str(sender_id)\n        if sender_str in allow_list:\n            return True\n        if \"|\" in sender_str:\n            for part in sender_str.split(\"|\"):\n                if part and part in allow_list:\n                    return True\n        return False\n\n    async def _handle_message(\n        self,\n        sender_id: str,\n        chat_id: str,\n        content: str,\n        media: list[str] | None = None,\n        metadata: dict[str, Any] | None = None,\n    ) -> None:\n        \"\"\"\n        Handle an incoming message from the chat platform.\n\n        This method checks permissions and forwards to the bus.\n\n        Args:\n            sender_id: The sender's identifier.\n            chat_id: The chat/channel identifier.\n            content: Message text content.\n            media: Optional list of media URLs.\n            metadata: Optional channel-specific metadata.\n        \"\"\" (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agents.agno_main_agent:[108:121]\n==nanobot.agents.agno_subagent:[113:126]\n        if not PROMPT_SYSTEM_V2_AVAILABLE:\n            logger.warning(\"PromptSystemV2 不可用，将使用默认提示词\")\n            return None\n\n        try:\n            return get_prompt_system_v2()\n        except Exception as e:\n            logger.warning(f\"初始化 PromptSystemV2 失败: {e}\")\n            return None\n\n    def _get_system_prompt(self) -> str:\n        \"\"\"获取系统提示词\"\"\"\n        if self.prompt_system is None: (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agents.agno_main_agent:[89:104]\n==nanobot.agents.agno_subagent:[91:106]\n        self.config = config.model_copy(update=kwargs)\n\n        # 设置工作目录\n        self.workspace = self.config.workspace or Path.cwd()\n\n        # 初始化组件\n        self.prompt_system = self._init_prompt_system()\n        self.toolkits = self._create_toolkits()\n        self.knowledge = (\n            self._create_knowledge() if self.config.enable_knowledge else None\n        )\n\n        # 创建 agno Agent\n        self.agent = self._create_agent()\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.context_compressor:[25:37]\n==nanobot.agent.context_manager:[26:38]\nlogger = logging.getLogger(__name__)\n\n\n@dataclass\nclass ContextStats:\n    \"\"\"上下文统计信息\"\"\"\n\n    original_length: int\n    compressed_length: int\n    compression_ratio: float\n    original_tokens: int = 0\n    compressed_tokens: int = 0 (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.subagent.agno_subagent:[317:330]\n==nanobot.agent.subagent.base_subagent:[198:206]\n                        messages.append(\n                            {\n                                \"role\": \"tool\",\n                                \"tool_call_id\": tool_call.id,\n                                \"name\": tool_call.name,\n                                \"content\": result,\n                            }\n                        ) (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.enhanced_main_agent:[39:50]\n==nanobot.agent.main_agent:[38:49]\nlogger = logging.getLogger(__name__)\n\n\nclass MainAgentState(BaseModel):\n    \"\"\"MainAgent 状态模型\"\"\"\n\n    session_id: str\n    current_task: Optional[str] = None\n    subagent_tasks: Dict[str, SubagentTask] = {}\n    subagent_results: Dict[str, SubagentResult] = {}\n    subagent_states: Dict[str, SubagentState] = {} (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.subagent.agno_subagent:[267:274]\n==nanobot.agent.subagent.base_subagent:[123:130]\n        tools = ToolRegistry()\n        tools.register(ReadFileTool())\n        tools.register(WriteFileTool())\n        tools.register(ListDirTool())\n        tools.register(\n            ExecTool(\n                working_dir=str(self.workspace), (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agents.agno_main_agent:[303:317]\n==nanobot.agents.agno_subagent:[359:373]\n        except Exception as e:\n            logger.error(f\"创建 Shell 工具包失败: {e}\")\n            return None\n\n    def _create_knowledge(self) -> Optional[Knowledge]:\n        \"\"\"创建知识库\"\"\"\n        # TODO: 实现知识库集成\n        return None\n\n    def _create_agent(self) -> Agent:\n        \"\"\"创建 agno Agent\"\"\"\n        system_prompt = self._get_system_prompt()\n\n        agent = Agent( (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.main_agent:[29:38]\n==nanobot.agents.agno_subagent:[32:41]\ntry:\n    from nanobot.agent.prompt_system import PromptSystemV2, get_prompt_system_v2\n\n    PROMPT_SYSTEM_V2_AVAILABLE = True\nexcept ImportError:\n    PROMPT_SYSTEM_V2_AVAILABLE = False\n    PromptSystemV2 = None\n    get_prompt_system_v2 = None\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.cron_system:[19:27]\n==nanobot.agent.message_analyzer:[13:21]\nlogger = logging.getLogger(__name__)\nlogger.setLevel(logging.DEBUG)\nformatter = logging.Formatter(\"%(asctime)s - %(name)s - %(levelname)s - %(message)s\")\nconsole_handler = logging.StreamHandler()\nconsole_handler.setFormatter(formatter)\nlogger.addHandler(console_handler)\n\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.task:[112:118]\n==nanobot.agent.task_manager:[87:93]\n            \"created_at\": self.created_at.isoformat(),\n            \"updated_at\": self.updated_at.isoformat(),\n            \"completed_at\": (\n                self.completed_at.isoformat() if self.completed_at else None\n            ),\n            \"result\": self.result, (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.tools.docker_tools:[56:63]\n==nanobot.agent.tools.git_tools:[49:56]\n            result = subprocess.run(\n                cmd,\n                capture_output=True,\n                text=True,\n                check=True,\n            )\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.tools.docker_tools:[147:154]\n==nanobot.agent.tools.git_tools:[154:161]\n            result = subprocess.run(\n                cmd,\n                capture_output=True,\n                text=True,\n                check=True,\n            )\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.tools.docker_tools:[204:211]\n==nanobot.agent.tools.git_tools:[201:208]\n            result = subprocess.run(\n                cmd,\n                capture_output=True,\n                text=True,\n                check=True,\n            )\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.tools.docker_tools:[243:250]\n==nanobot.agent.tools.git_tools:[264:271]\n            result = subprocess.run(\n                cmd,\n                capture_output=True,\n                text=True,\n                check=True,\n            )\n (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.planner.cancellation_detector:[267:276]\n==nanobot.agent.planner.correction_detector:[223:247]\n        ]\n\n        for pattern in target_patterns:\n            match = re.search(pattern, user_input)\n            if match:\n                return match.group(1).strip()\n\n        return None\n\n    async def _detect_correction_from_context(\n        self, user_input: str, context: Dict[str, Any]\n    ) -> Optional[Correction]:\n        \"\"\"\n        从上下文检测修正\n\n        Args:\n            user_input: 用户输入文本\n            context: 上下文信息\n\n        Returns:\n            修正信息或 None\n        \"\"\"\n        # 如果上下文中有最近的任务，但用户输入没有明确的修正关键词\n        # 可能是隐含的修正 (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.subagent.agno_subagent:[403:412]\n==nanobot.agent.subagent.base_subagent:[251:261]\nTask: {task}\n\nResult:\n{result}\n\nSummarize this naturally for the user. Keep it brief (1-2 sentences). Do not mention technical details like \"subagent\" or task IDs.\"\"\"\n\n        msg = InboundMessage(\n            channel=\"system\", (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agents.agno_main_agent:[385:390]\n==nanobot.agents.agno_subagent:[444:449]\n            \"model\": self.config.model,\n            \"workspace\": str(self.workspace),\n            \"toolkits_count\": len(self.toolkits),\n            \"knowledge_enabled\": self.knowledge is not None,\n            \"prompt_system_enabled\": self.prompt_system is not None, (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.task:[17:22]\n==nanobot.agents.subagent_manager:[17:24]\n    PENDING = \"pending\"  # 待执行\n    RUNNING = \"running\"  # 执行中\n    COMPLETED = \"completed\"  # 已完成\n    FAILED = \"failed\"  # 失败\n    CANCELLED = \"cancelled\"  # 已取消 (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.context_compressor:[65:70]\n==nanobot.agent.context_manager:[74:82]\n        try:\n            return tiktoken.get_encoding(encoding)\n        except Exception as e:\n            logger.warning(f\"无法加载编码 {encoding}: {e}\")\n            return None\n\n    def count_tokens(self, text: str) -> int:\n        \"\"\"计算文本的 Token 数量\"\"\" (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.context_compressor:[153:158]\n==nanobot.agent.context_manager:[224:229]\n            stats.original_length,\n            stats.original_tokens,\n            stats.compressed_length,\n            stats.compressed_tokens,\n            stats.compression_ratio, (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.enhanced_main_agent:[127:135]\n==nanobot.agent.main_agent:[150:158]\n            return hook_result.modified_message or \"消息处理被阻止\"\n        if hook_result.modified_message:\n            message = hook_result.modified_message\n\n        try:\n            self.state.is_processing = True\n\n            # 构建上下文（为了测试兼容性） (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.planner.correction_detector:[134:140]\n==nanobot.agent.planner.task_detector:[135:143]\n            score = 0.0\n            for regex in pattern.patterns:\n                if re.search(regex, user_input, re.IGNORECASE):\n                    score += pattern.weight\n\n            if score > 0: (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.intent.code_based_recognizer:[132:141]\n==nanobot.agent.intent.rule_based_recognizer:[219:229]\n        if context is None:\n            context = {}\n\n        logger.debug(f\"开始识别文本: {text}\")\n\n        # 按优先级降序排序\n        sorted_rules = sorted(self.rules, key=lambda x: x.priority, reverse=True)\n\n        for rule in sorted_rules: (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.intent.code_based_recognizer:[154:174]\n==nanobot.agent.intent.rule_based_recognizer:[305:325]\n        return None\n\n    def recognize_all(\n        self, text: str, context: Optional[Dict[str, Any]] = None\n    ) -> List[CodeRecognitionResult]:\n        \"\"\"\n        识别文本的所有匹配意图 (按优先级排序)\n\n        Args:\n            text: 待识别的文本\n            context: 上下文信息\n\n        Returns:\n            所有匹配到的识别结果列表\n        \"\"\"\n        if context is None:\n            context = {}\n\n        results = []\n        for rule in self.rules: (duplicate-code)\nnanobot/session/manager.py:1:0: R0801: Similar lines in 2 files\n==nanobot.agent.subagent.agno_subagent:[235:243]\n==nanobot.agent.subagent.base_subagent:[206:213]\n                else:\n                    final_result = response.content\n                    break\n\n            if final_result is None:\n                final_result = \"Task completed but no final response was generated.\"\n\n            # Mark task as completed (duplicate-code)\nnanobot/session/manager.py:1:0: R0401: Cyclic import (nanobot.agent.subagent.agno_subagent -> nanobot.agent.subagent.interrupt_handler) (cyclic-import)\nnanobot/session/manager.py:1:0: R0401: Cyclic import (nanobot.agent.subagent.agno_subagent -> nanobot.agent.subagent.hooks) (cyclic-import)\nnanobot/session/manager.py:1:0: R0401: Cyclic import (nanobot.agent.subagent.agno_subagent -> nanobot.agent.subagent.risk_evaluator) (cyclic-import)\n\n------------------------------------------------------------------\nYour code has been rated at 8.53/10 (previous run: 8.31/10, +0.22)\n\n",
          "stderr": ""
        },
        {
          "task": "功能测试",
          "stdout": "============================= test session starts ==============================\nplatform darwin -- Python 3.13.5, pytest-9.0.2, pluggy-1.6.0 -- /Users/jiangyayun/develop/code/work_code/nanobot/.venv/bin/python3.13\ncachedir: .pytest_cache\nrootdir: /Users/jiangyayun/develop/code/work_code/nanobot\nconfigfile: pyproject.toml\nplugins: anyio-4.12.1, asyncio-1.3.0, cov-7.0.0\nasyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function\ncollecting ... collected 788 items / 710 deselected / 78 selected\n\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_initialization PASSED [  1%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_handle_request_valid_result PASSED [  2%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_handle_request_invalid_data PASSED [  3%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_handle_success_result_no_next_step PASSED [  5%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_handle_success_result_with_next_step PASSED [  6%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_handle_error_result_retry_available PASSED [  7%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_handle_error_result_no_retry PASSED [  8%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_handle_cancelled_result PASSED [ 10%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_handle_unknown_status PASSED [ 11%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_handle_no_task PASSED [ 12%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_subagent_result_request_validation PASSED [ 14%]\ntests/decision/test_subagent_result_handler.py::TestSubagentResultHandler::test_subagent_result_request_with_error PASSED [ 15%]\ntests/integration/test_main_agent_integration.py::test_subagent_coordination PASSED [ 16%]\ntests/performance/test_subagent_concurrency_performance.py::test_subagent_concurrency PASSED [ 17%]\ntests/performance/test_subagent_concurrency_performance.py::test_subagent_response_time_scalability PASSED [ 19%]\ntests/regression/test_regression_subagent_lifecycle.py::test_subagent_lifecycle_basic PASSED [ 20%]\ntests/regression/test_regression_subagent_lifecycle.py::test_subagent_exception_recovery PASSED [ 21%]\ntests/regression/test_regression_subagent_lifecycle.py::test_subagent_concurrent_lifecycle PASSED [ 23%]\ntests/test_concurrent_scheduler.py::TestTaskScheduler::test_scheduler_initialization PASSED [ 24%]\ntests/test_concurrent_scheduler.py::TestTaskScheduler::test_start_stop PASSED [ 25%]\ntests/test_concurrent_scheduler.py::TestTaskScheduler::test_schedule_and_execute PASSED [ 26%]\ntests/test_concurrent_scheduler.py::TestTaskScheduler::test_priority_ordering PASSED [ 28%]\ntests/test_concurrent_scheduler.py::TestTaskScheduler::test_task_retry PASSED [ 29%]\ntests/test_concurrent_scheduler.py::TestTaskScheduler::test_timeout_handling PASSED [ 30%]\ntests/test_concurrent_scheduler.py::TestTaskScheduler::test_concurrent_execution PASSED [ 32%]\ntests/test_concurrent_scheduler.py::TestTaskScheduler::test_stats_collection PASSED [ 33%]\ntests/test_concurrent_scheduler.py::TestResourcePool::test_pool_initialization PASSED [ 34%]\ntests/test_concurrent_scheduler.py::TestResourcePool::test_acquire_release PASSED [ 35%]\ntests/test_concurrent_scheduler.py::TestResourcePool::test_pool_exhaustion PASSED [ 37%]\ntests/test_concurrent_scheduler.py::TestResourcePool::test_pool_stats PASSED [ 38%]\ntests/test_error_recovery.py::TestCircuitBreaker::test_initial_state PASSED [ 39%]\ntests/test_error_recovery.py::TestCircuitBreaker::test_success_call PASSED [ 41%]\ntests/test_error_recovery.py::TestCircuitBreaker::test_circuit_opens_on_failures PASSED [ 42%]\ntests/test_error_recovery.py::TestCircuitBreaker::test_rejects_calls_when_open PASSED [ 43%]\ntests/test_error_recovery.py::TestCircuitBreaker::test_circuit_closes_after_timeout PASSED [ 44%]\ntests/test_error_recovery.py::TestCircuitBreaker::test_reset PASSED      [ 46%]\ntests/test_error_recovery.py::TestCircuitBreaker::test_get_stats PASSED  [ 47%]\ntests/test_error_recovery.py::TestRetryPolicy::test_success_on_first_try PASSED [ 48%]\ntests/test_error_recovery.py::TestRetryPolicy::test_retries_on_failure PASSED [ 50%]\ntests/test_error_recovery.py::TestRetryPolicy::test_max_retries_exceeded PASSED [ 51%]\ntests/test_error_recovery.py::TestRetryPolicy::test_retry_on_specific_exception PASSED [ 52%]\ntests/test_error_recovery.py::TestTimeoutHandler::test_success_before_timeout PASSED [ 53%]\ntests/test_error_recovery.py::TestTimeoutHandler::test_timeout_triggered PASSED [ 55%]\ntests/test_error_recovery.py::TestTimeoutHandler::test_timeout_callback PASSED [ 56%]\ntests/test_error_recovery.py::TestErrorRecoveryManager::test_get_circuit_breaker PASSED [ 57%]\ntests/test_error_recovery.py::TestErrorRecoveryManager::test_get_retry_policy PASSED [ 58%]\ntests/test_error_recovery.py::TestErrorRecoveryManager::test_get_timeout_handler PASSED [ 60%]\ntests/test_error_recovery.py::TestErrorRecoveryManager::test_execute_with_protection PASSED [ 61%]\ntests/test_prompt_system.py::test_subagent_prompt_hook PASSED            [ 62%]\ntests/test_subagent_manager.py::TestSubagentManager::test_manager_initialization PASSED [ 64%]\ntests/test_subagent_manager.py::TestSubagentManager::test_start_stop PASSED [ 65%]\ntests/test_subagent_manager.py::TestSubagentManager::test_submit_task PASSED [ 66%]\ntests/test_subagent_manager.py::TestSubagentManager::test_task_execution PASSED [ 67%]\ntests/test_subagent_manager.py::TestSubagentManager::test_concurrent_limit PASSED [ 69%]\ntests/test_subagent_manager.py::TestSubagentManager::test_task_failure PASSED [ 70%]\ntests/test_subagent_manager.py::TestSubagentManager::test_task_timeout PASSED [ 71%]\ntests/test_subagent_manager.py::TestSubagentManager::test_task_cancellation PASSED [ 73%]\ntests/test_subagent_manager.py::TestSubagentManager::test_get_stats PASSED [ 74%]\ntests/test_subagent_manager.py::TestSubagentManager::test_multiple_tasks PASSED [ 75%]\ntests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_memory_monitoring PASSED [ 76%]\ntests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_cpu_monitoring PASSED [ 78%]\ntests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_resource_stats PASSED [ 79%]\ntests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_can_submit_task PASSED [ 80%]\ntests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_cleanup_completed_tasks FAILED [ 82%]\ntests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_manual_cleanup_all PASSED [ 83%]\ntests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_resource_limits_with_task_submission PASSED [ 84%]\ntests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_long_running_cleanup_loop PASSED [ 85%]\ntests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_concurrent_with_resource_monitoring PASSED [ 87%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_task_tracking PASSED [ 88%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_progress_reporting PASSED [ 89%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_correction_requests PASSED [ 91%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_task_retry PASSED [ 92%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_task_timeline PASSED [ 93%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_sync_with_task_manager PASSED [ 94%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_cleanup_task PASSED [ 96%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_get_completed_tasks PASSED [ 97%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_error_handling_invalid_progress PASSED [ 98%]\ntests/test_subagent_manager_enhanced.py::TestSubagentManagerEnhanced::test_error_handling_nonexistent_task PASSED [100%]\n\n=================================== FAILURES ===================================\n______ TestSubagentManagerResourceManagement.test_cleanup_completed_tasks ______\n\nself = <test_subagent_manager_advanced.TestSubagentManagerResourceManagement object at 0x127962330>\n\n    @pytest.mark.asyncio\n    async def test_cleanup_completed_tasks(self):\n        \"\"\"Test automatic cleanup of completed tasks.\"\"\"\n        manager = SubagentManager(max_concurrent=3)\n        await manager.start()\n    \n        async def quick_task():\n            return \"done\"\n    \n        # Submit many tasks\n        for i in range(50):\n            task_id = await manager.submit_task(f\"task-{i}\", f\"Task {i}\", quick_task)\n            await manager.wait_for_task(task_id)\n    \n        # Wait a bit for cleanup\n        await asyncio.sleep(manager.cleanup_interval + 0.5)\n    \n        # Check cleanup happened\n        stats = await manager.get_stats()\n        # Should have fewer than 50 tasks due to cleanup\n>       assert stats[\"completed\"] < 50\nE       assert 50 < 50\n\ntests/test_subagent_manager_advanced.py:88: AssertionError\n----------------------------- Captured stderr call -----------------------------\n2026-02-14 06:56:31.983 | INFO     | nanobot.agents.subagent_manager:start:97 - Starting subagent manager with 3 workers\n2026-02-14 06:56:31.983 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-0 - Task 0\n2026-02-14 06:56:31.983 | INFO     | nanobot.agents.subagent_manager:_worker:260 - Worker started: worker-0\n2026-02-14 06:56:31.983 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-0\n2026-02-14 06:56:31.983 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-0\n2026-02-14 06:56:31.983 | INFO     | nanobot.agents.subagent_manager:_worker:260 - Worker started: worker-1\n2026-02-14 06:56:31.983 | INFO     | nanobot.agents.subagent_manager:_worker:260 - Worker started: worker-2\n2026-02-14 06:56:31.983 | INFO     | nanobot.agents.subagent_manager:_cleanup_loop:413 - Started resource cleanup loop\n2026-02-14 06:56:32.085 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-1 - Task 1\n2026-02-14 06:56:32.085 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-1\n2026-02-14 06:56:32.085 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-1\n2026-02-14 06:56:32.187 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-2 - Task 2\n2026-02-14 06:56:32.187 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-2\n2026-02-14 06:56:32.187 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-2\n2026-02-14 06:56:32.289 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-3 - Task 3\n2026-02-14 06:56:32.289 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-3\n2026-02-14 06:56:32.289 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-3\n2026-02-14 06:56:32.391 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-4 - Task 4\n2026-02-14 06:56:32.391 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-4\n2026-02-14 06:56:32.391 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-4\n2026-02-14 06:56:32.493 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-5 - Task 5\n2026-02-14 06:56:32.493 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-5\n2026-02-14 06:56:32.493 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-5\n2026-02-14 06:56:32.595 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-6 - Task 6\n2026-02-14 06:56:32.595 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-6\n2026-02-14 06:56:32.595 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-6\n2026-02-14 06:56:32.697 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-7 - Task 7\n2026-02-14 06:56:32.697 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-7\n2026-02-14 06:56:32.697 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-7\n2026-02-14 06:56:32.799 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-8 - Task 8\n2026-02-14 06:56:32.799 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-8\n2026-02-14 06:56:32.799 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-8\n2026-02-14 06:56:32.900 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-9 - Task 9\n2026-02-14 06:56:32.900 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-9\n2026-02-14 06:56:32.900 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-9\n2026-02-14 06:56:33.002 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-10 - Task 10\n2026-02-14 06:56:33.002 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-10\n2026-02-14 06:56:33.002 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-10\n2026-02-14 06:56:33.104 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-11 - Task 11\n2026-02-14 06:56:33.104 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-11\n2026-02-14 06:56:33.104 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-11\n2026-02-14 06:56:33.206 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-12 - Task 12\n2026-02-14 06:56:33.206 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-12\n2026-02-14 06:56:33.206 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-12\n2026-02-14 06:56:33.308 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-13 - Task 13\n2026-02-14 06:56:33.308 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-13\n2026-02-14 06:56:33.308 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-13\n2026-02-14 06:56:33.411 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-14 - Task 14\n2026-02-14 06:56:33.411 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-14\n2026-02-14 06:56:33.411 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-14\n2026-02-14 06:56:33.513 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-15 - Task 15\n2026-02-14 06:56:33.513 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-15\n2026-02-14 06:56:33.513 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-15\n2026-02-14 06:56:33.615 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-16 - Task 16\n2026-02-14 06:56:33.615 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-16\n2026-02-14 06:56:33.615 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-16\n2026-02-14 06:56:33.717 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-17 - Task 17\n2026-02-14 06:56:33.717 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-17\n2026-02-14 06:56:33.717 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-17\n2026-02-14 06:56:33.819 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-18 - Task 18\n2026-02-14 06:56:33.819 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-18\n2026-02-14 06:56:33.819 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-18\n2026-02-14 06:56:33.921 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-19 - Task 19\n2026-02-14 06:56:33.921 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-19\n2026-02-14 06:56:33.921 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-19\n2026-02-14 06:56:34.023 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-20 - Task 20\n2026-02-14 06:56:34.023 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-20\n2026-02-14 06:56:34.023 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-20\n2026-02-14 06:56:34.125 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-21 - Task 21\n2026-02-14 06:56:34.125 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-21\n2026-02-14 06:56:34.125 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-21\n2026-02-14 06:56:34.227 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-22 - Task 22\n2026-02-14 06:56:34.227 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-22\n2026-02-14 06:56:34.227 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-22\n2026-02-14 06:56:34.329 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-23 - Task 23\n2026-02-14 06:56:34.329 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-23\n2026-02-14 06:56:34.329 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-23\n2026-02-14 06:56:34.431 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-24 - Task 24\n2026-02-14 06:56:34.431 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-24\n2026-02-14 06:56:34.432 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-24\n2026-02-14 06:56:34.534 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-25 - Task 25\n2026-02-14 06:56:34.534 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-25\n2026-02-14 06:56:34.534 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-25\n2026-02-14 06:56:34.636 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-26 - Task 26\n2026-02-14 06:56:34.636 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-26\n2026-02-14 06:56:34.636 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-26\n2026-02-14 06:56:34.738 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-27 - Task 27\n2026-02-14 06:56:34.738 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-27\n2026-02-14 06:56:34.738 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-27\n2026-02-14 06:56:34.840 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-28 - Task 28\n2026-02-14 06:56:34.840 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-28\n2026-02-14 06:56:34.840 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-28\n2026-02-14 06:56:34.942 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-29 - Task 29\n2026-02-14 06:56:34.942 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-29\n2026-02-14 06:56:34.942 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-29\n2026-02-14 06:56:35.043 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-30 - Task 30\n2026-02-14 06:56:35.043 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-30\n2026-02-14 06:56:35.043 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-30\n2026-02-14 06:56:35.145 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-31 - Task 31\n2026-02-14 06:56:35.145 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-31\n2026-02-14 06:56:35.145 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-31\n2026-02-14 06:56:35.247 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-32 - Task 32\n2026-02-14 06:56:35.247 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-32\n2026-02-14 06:56:35.247 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-32\n2026-02-14 06:56:35.349 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-33 - Task 33\n2026-02-14 06:56:35.349 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-33\n2026-02-14 06:56:35.349 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-33\n2026-02-14 06:56:35.451 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-34 - Task 34\n2026-02-14 06:56:35.451 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-34\n2026-02-14 06:56:35.451 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-34\n2026-02-14 06:56:35.553 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-35 - Task 35\n2026-02-14 06:56:35.553 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-35\n2026-02-14 06:56:35.553 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-35\n2026-02-14 06:56:35.655 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-36 - Task 36\n2026-02-14 06:56:35.655 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-36\n2026-02-14 06:56:35.655 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-36\n2026-02-14 06:56:35.757 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-37 - Task 37\n2026-02-14 06:56:35.758 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-37\n2026-02-14 06:56:35.758 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-37\n2026-02-14 06:56:35.860 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-38 - Task 38\n2026-02-14 06:56:35.860 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-38\n2026-02-14 06:56:35.860 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-38\n2026-02-14 06:56:35.962 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-39 - Task 39\n2026-02-14 06:56:35.962 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-39\n2026-02-14 06:56:35.962 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-39\n2026-02-14 06:56:36.064 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-40 - Task 40\n2026-02-14 06:56:36.064 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-40\n2026-02-14 06:56:36.064 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-40\n2026-02-14 06:56:36.166 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-41 - Task 41\n2026-02-14 06:56:36.166 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-41\n2026-02-14 06:56:36.166 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-41\n2026-02-14 06:56:36.268 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-42 - Task 42\n2026-02-14 06:56:36.268 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-42\n2026-02-14 06:56:36.268 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-42\n2026-02-14 06:56:36.370 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-43 - Task 43\n2026-02-14 06:56:36.370 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-43\n2026-02-14 06:56:36.370 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-43\n2026-02-14 06:56:36.472 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-44 - Task 44\n2026-02-14 06:56:36.472 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-44\n2026-02-14 06:56:36.472 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-44\n2026-02-14 06:56:36.574 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-45 - Task 45\n2026-02-14 06:56:36.574 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-45\n2026-02-14 06:56:36.575 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-45\n2026-02-14 06:56:36.677 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-46 - Task 46\n2026-02-14 06:56:36.677 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-46\n2026-02-14 06:56:36.677 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-46\n2026-02-14 06:56:36.779 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-47 - Task 47\n2026-02-14 06:56:36.779 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-1 executing task: task-47\n2026-02-14 06:56:36.779 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-1 completed task: task-47\n2026-02-14 06:56:36.881 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-48 - Task 48\n2026-02-14 06:56:36.881 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-2 executing task: task-48\n2026-02-14 06:56:36.881 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-2 completed task: task-48\n2026-02-14 06:56:36.983 | INFO     | nanobot.agents.subagent_manager:submit_task:165 - Task submitted: task-49 - Task 49\n2026-02-14 06:56:36.983 | INFO     | nanobot.agents.subagent_manager:_worker:272 - worker-0 executing task: task-49\n2026-02-14 06:56:36.983 | INFO     | nanobot.agents.subagent_manager:_worker:292 - worker-0 completed task: task-49\n--------------------------- Captured stderr teardown ---------------------------\n2026-02-14 06:57:37.648 | INFO     | nanobot.agents.subagent_manager:_cleanup_loop:425 - Stopped resource cleanup loop\n=============================== warnings summary ===============================\nnanobot/agent/memory/models.py:13\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/memory/models.py:13: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class Memory(BaseModel):\n\n.venv/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:319\n  /Users/jiangyayun/develop/code/work_code/nanobot/.venv/lib/python3.13/site-packages/pydantic/_internal/_generate_schema.py:319: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.12/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    warnings.warn(\n\nnanobot/agent/planner/cancellation_detector.py:15\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/cancellation_detector.py:15: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class CancellationDetector(BaseModel):\n\nnanobot/agent/planner/complexity_analyzer.py:15\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/complexity_analyzer.py:15: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class ComplexityAnalyzer(BaseModel):\n\nnanobot/agent/planner/correction_detector.py:15\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/correction_detector.py:15: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class CorrectionDetector(BaseModel):\n\nnanobot/agent/planner/task_detector.py:15\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/task_detector.py:15: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class TaskDetector(BaseModel):\n\nnanobot/agent/planner/task_planner.py:22\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/planner/task_planner.py:22: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class TaskPlanner(BaseModel):\n\nnanobot/agent/subagent/agno_subagent.py:42\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/agent/subagent/agno_subagent.py:42: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class AgnoSubagent(BaseModel):\n\nnanobot/config/schema.py:205\n  /Users/jiangyayun/develop/code/work_code/nanobot/nanobot/config/schema.py:205: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/\n    class Config(BaseSettings):\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_subagent_manager_advanced.py::TestSubagentManagerResourceManagement::test_cleanup_completed_tasks\n===== 1 failed, 77 passed, 710 deselected, 9 warnings in 83.44s (0:01:23) ======\n",
          "stderr": ""
        }
      ],
      "completedDate": "2026-02-14T06:57:46.809032"
    },
    "6": {
      "name": "收尾工作",
      "status": "pending",
      "checkpoints": {
        "6.1": {
          "name": "问题修复",
          "status": "pending",
          "tasks": [
            {
              "name": "修复测试发现的问题",
              "status": "pending"
            },
            {
              "name": "修复代码审查问题",
              "status": "pending"
            },
            {
              "name": "优化性能瓶颈",
              "status": "pending"
            }
          ]
        },
        "6.2": {
          "name": "版本发布准备",
          "status": "pending",
          "tasks": [
            {
              "name": "更新版本号",
              "status": "pending"
            },
            {
              "name": "编写发布说明",
              "status": "pending"
            },
            {
              "name": "生成变更日志",
              "status": "pending"
            },
            {
              "name": "创建发布标签",
              "status": "pending"
            }
          ]
        }
      },
      "progress": 0,
      "errors": []
    }
  },
  "current_stage": 5,
  "subagents": {
    "planning": {
      "session_key": "agent:main:subagent:263cc874-2815-429b-bf9b-fcf42dffe4e9",
      "run_id": "15158a27-562e-49cd-8ee8-3c14756f7cbd",
      "task": "分析现有功能，制定 v0.3.0 和 v0.4.0 升级计划",
      "status": "completed",
      "start_time": "2026-02-12T23:30:15+08:00",
      "end_time": "2026-02-12T23:40:00+08:00",
      "duration": "3m36s"
    },
    "review": {
      "session_key": "agent:main:subagent:9e8a6a0e-0e82-4088-8ee7-c66db421d118",
      "run_id": "24082e9e-bb9e-41b6-a6d8-0d4ddcaea5e9",
      "task": "多维度审核升级计划的完整性和可行性",
      "status": "completed",
      "start_time": "2026-02-13T00:08:00+08:00",
      "end_time": "2026-02-13T00:14:00+08:00",
      "duration": "5m39s"
    },
    "implementation": {
      "session_key": "agent:main:subagent:afb8f9de-c9c6-42ac-887b-da8b29c5d5b4",
      "run_id": "3c518885-480a-4407-baf7-abe1687b2439",
      "task": "实施 Nanobot v0.3.0 升级（持续工作与记忆系统升级）",
      "status": "completed",
      "start_time": "2026-02-13T01:10:00+08:00",
      "end_time": "2026-02-13T01:16:22+08:00",
      "duration": "6m22s"
    },
    "stage1": {
      "session_key": "agent:main:subagent:756adb4f-1ea6-432e-8146-7f1fbc52002a",
      "run_id": "stage1-implementation",
      "task": "执行 Nanobot v0.4.0 升级阶段 1（多渠道集成）",
      "status": "completed",
      "start_time": "2026-02-13T09:22:00+08:00",
      "end_time": "2026-02-13T09:30:00+08:00",
      "duration": "8m"
    },
    "stage2": {
      "session_key": "agent:main:subagent:c01e5669-a1d6-4be2-af6e-126beb581438",
      "run_id": "stage2-implementation",
      "task": "执行 Nanobot v0.4.0 升级阶段 2（架构优化）",
      "status": "completed",
      "start_time": "2026-02-13T11:45:00+08:00",
      "end_time": "2026-02-13T12:00:00+08:00",
      "duration": "15m"
    },
    "stage3": {
      "session_key": "agent:main:subagent:687af830-d31b-47bb-b3bb-d713f061ac7d",
      "run_id": "stage3-implementation",
      "task": "执行 Nanobot v0.4.0 升级阶段 3（用户体验改进）",
      "status": "completed",
      "start_time": "2026-02-14T03:26:00+08:00",
      "end_time": "2026-02-14T03:30:00+08:00",
      "duration": "4m"
    },
    "stage4": {
      "session_key": "agent:main:subagent:60267497-d859-42fc-a11c-2de555889bc4",
      "run_id": "6dcf9ff3-48ea-47c6-8706-48f1dca45b8b",
      "task": "执行 Nanobot v0.4.0 升级阶段 4（系统稳定性）",
      "status": "completed",
      "start_time": "2026-02-14T03:57:00+08:00",
      "end_time": "2026-02-14T04:17:00+08:00",
      "duration": "20m"
    }
  },
  "cron_job": {
    "job_id": "786730b4-6bc5-4653-8d6b-d48487d0fa55",
    "enabled": true,
    "check_interval": "30min",
    "actions": [
      "resume_if_stopped",
      "report_progress",
      "send_alerts"
    ],
    "next_run_at": 1770912476537
  },
  "milestones": [
    {
      "version": "v0.3.0",
      "status": "completed",
      "completion": 100,
      "estimated_days": 7,
      "key_features": [
        "Heartbeat + Cron Job 持续工作机制",
        "三层记忆系统（L1/L2/L3）",
        "渐进式披露文件管理",
        "技能系统可扩展性"
      ]
    },
    {
      "version": "v0.4.0",
      "status": "in_progress",
      "completion": 100,
      "estimated_days": 10,
      "key_features": [
        "多渠道集成（WebChat/TUI/飞书）",
        "架构优化",
        "子代理管理增强",
        "错误恢复机制",
        "用户体验改进",
        "系统稳定性（监控/日志/健康检查/告警）",
        "性能优化（内存/缓存/数据库查询）",
        "系统可运维性（热重载/优雅关闭/诊断）"
      ]
    }
  ]
}